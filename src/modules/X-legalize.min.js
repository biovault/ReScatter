/*! legalize 03-08-2018
    Copyright (C) 2014 PayPal
    Licensed under the Apache License, Version 2.0. */

!function(a){"use strict";var b=a();"undefined"!=typeof window?window.Legalize=b:this.Legalize=b,"function"==typeof define&&define.amd&&define("Legalize",[],b)}(function(a){"use strict";function b(a){return"function"==typeof a}Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});var c={freeze:b(Object.freeze)?Object.freeze:function(a){return a},keys:b(Object.keys)?Object.keys:function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){var f,g,h=[];for(f in e)a.call(e,f)&&h.push(f);if(b)for(g=0;g<d;g+=1)a.call(e,c[g])&&h.push(c[g]);return h}}(),create:b(Object.create)?Object.create:function(a){function b(){}return b.prototype=a,new b}},d=function(b){function c(a){return function(b){return!a(b)}}function e(a){return Array.isArray(a)?"array":null===a?"null":typeof a}function f(){return window.Legalize===d&&(window.Legalize=J),d}function g(b,c){if(e(b)===c)return b;switch(c){case"string":return String(b);case"number":return Number(b);case"boolean":return"true"===b||"false"!==b&&Boolean(Number(b));default:return a}}function h(a){return"function"===e(a)}function i(a){return"object"===e(a)}function j(a){return"number"===e(a)}function k(a){return"string"===e(a)}function l(a){return"array"===e(a)}function m(b){return null===b||b===a}function n(a){var b=Number(a);return b===b}function o(a){return parseInt(a)===Number(a)}function p(c){return l(c)||k(c)?c.length:i(c)?b.keys(c).length:a}function q(a){return m(a)||0===p(a)}function r(a,b){return a instanceof b}function s(a,c){var d;if(l(a))for(d=0;d<a.length;d+=1)a[d]=c(a[d],d);else{var e=b.keys(a);for(d=0;d<e.length;d+=1){var f=e[d];a[f]=c(a[f],f)}}}function t(a,b){s(a,function(a,c){return b(a,c),a})}function u(){for(var a={},b=0;b<arguments.length;b+=1){t(arguments[b],function(b,c){if(l(a[c])){var d=function(b){a[c].push(b)};l(b)?b.forEach(d):d(b)}else i(a[c])&&i(b)?a[c]=u(a[c],b):a[c]=b})}return a}function v(a,b){return i(b)&&t(b,function(c,d){a[d]=b[d]}),a}function w(a,c){if(!l(a)&&!i(a))return a===c||a!==a&&c!==c;if(p(a)!==p(c))return!1;for(var d=u({x:b.keys(a)},{x:b.keys(c)}).x,e=0;e<d.length;e+=1){var f=d[e];if(!w(a[f],c[f]))return!1}return!0}function x(a){if(a._isSchema)return a;if(a._isSchemaBuilder&&h(a.compile))return a.compile();if(r(a,RegExp))return K.string().match(a).compile();if(l(a)){return K.alternatives.apply(K,a).compile()}return i(a)?K.object().keys(a).compile():K.any().valid(a).compile()}function y(a,c){return function(){var d=Array.prototype.slice.call(arguments),e=b.create(this),f=this;return v(e,c),e.compile=function(b){var c=u(f.compile(!0),h(a)?a(d):a);if(!b){var e=function(a){return x(a)};s(c.includes,e),s(c.excludes,e),s(c.keys,e),s(c.alternatives,e)}return c._isSchema=!0,c},e}}function z(a){return y(function(b){var c={};return c[a]=b[0],c})}function A(a){return y(function(b){var c={};return c[a]=b,c})}function B(a){return y(function(b){return{checks:function(c){return a(c,b[0])}}})}function C(a){return B(function(b){return a.test(b)})}function D(a,b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(a,c)}}function E(a){return u(a,{minLength:B(function(a,b){return p(a)>=b}),maxLength:B(function(a,b){return p(a)<=b}),length:B(function(a,b){return p(a)===b})})}function F(){return{allowed:[],valid:[],invalid:[],checks:[],checksAfter:[],alias:{},keys:{},includes:[],excludes:[],alternatives:[],sanitizeBefore:[],sanitize:[],pattern:null,_isSchema:!0}}function G(b,c,d,f){function j(b,c,f){function h(a,c,d){return{type:a,expected:c,actual:d,sourcePath:f,sourceValue:b}}function m(a,b,c){o.push(i(a)?a:h(a,b,c))}function n(a){return{value:a}}function p(a,b,c,e){var f=h(b,c,e);return O(y)&&u===M&&d.warnOnInvalidOptionals?(m(f),n(a)):{error:f,value:a}}function r(a){l(a)?t(a,function(a){r(a)}):k(a)?r(h(a)):i(a)&&m(v(h(),a))}var s=e(b),u=c.presence||d.presence,y=c.defaultValue,z=c.type,A=0,B=0;if("undefined"===s)return u===M?n(y):u===L?p(a,"required_missing"):n();if(u===N)return p(a,"forbidden_encountered");var C=c.alternatives;if(!q(C)){for(A=0;A<C.length;A+=1){var D=C[A],E=j(b,D,f);if(!E.error)return E}return p(y,"no_alternative_matched")}t(c.sanitizeBefore,function(a){b=a(b)});var F=c.alias;if(O(F[b])&&(b=F[b]),O(z)&&s!==z){if(d.strict)return p(y,"mismatching_types",z,s);m("mismatching_types",z,s),b=g(b,z)}var G=c.allowed;for(A=0;A<G.length;A+=1)if(w(G[A],b))return n(b);var H=c.invalid;for(A=0;A<H.length;A+=1)if(w(H[A],b))return p(y,"invalid_value");var I=c.valid;if(!q(I)){for(A=0;A<I.length;A+=1)if(w(I[A],b))return n(b);return p(y,"not_a_valid_value")}var J=[];if(t(c.checks,function(a){var c;try{c=a(b)}catch(a){return console.log("Error while executing user-defined function"),console.log(a),!1}!0!==c&&(i(c)||(c=h("check_failed")),J.push(c))}),!q(J))return p(y,"checks_failed");if("object"===z){var K={},P=[];t(c.keys,function(a,c){var e=j(b[c],a,f+"/"+c);if(e.error){(a.presence||d.presence)===M&&d.warnOnInvalidOptionals?m(e.error):P.push(e.error)}K[c]=e.value,delete b[c]});var Q=null,R=null;if(c.pattern&&(l(c.pattern)&&c.pattern.length>=2?(Q=c.pattern[0],R=x(c.pattern[1])):Q=c.pattern,t(b,function(b,e){if(!c.keys[e]){var g=h("unknown_key",a,e),i=!d.stripUnknown;if(Q&&Q.test(e)?i=!0:d.allowUnknown?d.warnUnknown&&m(g):P.push(g),i)if(R){var k=j(b,R,f+"/"+e);if(k.error){var l=b.presence||d.presence;l===M&&d.warnOnInvalidOptionals?m(k.error):P.push(k.error)}K[e]=k.value}else K[e]=b}})),!q(P))return p(K,P);b=K}else if("array"===z){var S=[],T=[],U=c.includes,V=c.excludes;if(q(U)?q(V)?S=b:t(b,function(a){var b,c=!0;for(B=0;B<V.length;B+=1)if(b=j(a,V[B],f+"/"+A),!b.error){c=!1;break}c?S.push(b.value):T.push(h("matched_excluded_type"))}):t(b,function(a){var b,c=!1;for(B=0;B<U.length;B+=1)if(b=j(a,U[B],f+"/"+A),!b.error){c=!0;break}c?S.push(b.value):T.push(b.error)}),!q(T))return p(S,T);b=S}return t(c.checksAfter,function(a){var c;try{c=a(b)}catch(a){return console.log("Error while executing user-defined function"),console.log(a),!1}!0!==c&&r(c)}),t(c.sanitize,function(a){b=a(b)}),n(b)}function m(a,b){return l(a.type)?t(a.type,function(a){m(a,b)}):b.push(a),b}if(f=h(f)?f:h(d)?d:null,d=i(d)?d:{},q(d))d=I;else{var n=G(d,H);if(n.error)throw new Error(n.error);d=n.value}c=x(c);var o=[],p=j(b,c,""),r=p.error?m(p.error,[]):null,s=p.value;if(o=q(o)?null:o,!h(f))return{error:r,value:s,warnings:o};setTimeout(function(){f(r,s,o)},0)}var H,I,J=window.Legalize,K={},L="required",M="optional",N="forbidden",O=c(m),P={_isSchemaBuilder:!0,compile:F,notEmpty:B(c(q)),allow:A("allowed"),valid:A("valid"),invalid:A("invalid"),alias:z("alias"),check:A("checksAfter"),satisfy:A("checks"),sanitize:A("sanitize"),sanitizeBefore:A("sanitizeBefore"),required:y({presence:L}),optional:y({presence:M}),forbidden:y({presence:N}),default:z("defaultValue")},Q=y({}),R=y({type:"boolean"}),S=y({type:"function"}),T=y({type:"number"},{min:B(function(a,b){return a>=b}),max:B(function(a,b){return a<=b}),greater:B(function(a,b){return a>b}),lesser:B(function(a,b){return a<b}),integer:B(o)}),U=y({type:"string"},E({match:B(function(a,b){return new RegExp(b).test(a)}),insensitive:y({insensitive:!0}),lowercase:B(function(a){return a=String(a),a.toLowerCase()===a}),uppercase:B(function(a){return a=String(a),a.toUpperCase()===a}),alphanum:C(/^[0-9a-zA-Z]*$/),url:C(/^https?:\/\/(\w+:?\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/),element:B(function(a){return!!window.document.getElementById(a)}),digits:B(/^[0-9]*$/),numeric:B(n)})),V=y({type:"array"},E({unique:B(function(a){for(var b={},c=0;c<a.length;c+=1){var d=a[c];if(j(d)||k(d)){if(b[d])return!1;b[d]=!0}}return!0}),includes:A("includes"),excludes:A("excludes")})),W=y({type:"object"},E({keys:z("keys"),type:B(r),pattern:z("pattern")})),X=A("alternatives");return K=b.freeze({any:D(P,Q),bool:D(P,R),boolean:D(P,R),number:D(P,T),string:D(P,U),object:D(P,W),array:D(P,V),func:D(P,S),alternatives:D(P,X),compile:x,validate:G,typeOf:e,noConflict:f}),H=x({allowUnknown:K.bool().default(!1),stripUnknown:K.bool().default(!0),warnUnknown:K.bool().default(!0),strict:K.bool().default(!0),warnOnInvalidOptionals:K.bool().default(!0),presence:K.any().valid(M).valid(L).valid(N).default(M)}),I={allowUnknown:!1,stripUnknown:!0,warnUnknown:!0,strict:!0,warnOnInvalidOptionals:!0,presence:M},K}(c);return d});
//# sourceMappingURL=legalize.min.js.map