!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ReScatter=t():e.ReScatter=t()}(window,function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=177)}([function(e,t,n){var i={createContext:n(65),setVertexAttribArrays:n(19),GLBuffer:n(66),GLFramebuffer:n(67),GLShader:n(68),GLTexture:n(20),VertexArrayObject:n(69),shader:n(70)};void 0!==e&&e.exports&&(e.exports=i),"undefined"!=typeof window&&(window.PIXI=window.PIXI||{},window.PIXI.glCore=i)},function(e,t,n){"use strict";const i=n(40);class r extends Function{impl(e,t,n){n||u(t)||(n=t,t=[]),!n&&this.isDerivable&&(n=this._defaultImpls),n||(n={}),"function"!=typeof e||e.isGenfun||(e=e.prototype),function(e,t,n){e._methodNames.forEach(function(i){if(!n[i]&&!e._defaultImpls[i]&&"function"!=typeof t[i])throw new Error(`Missing implementation for ${l(e,i,e.name)}. Make sure the method is present in your ${e.name||"protocol"} definition. Required methods: ${e._methodNames.filter(t=>!e._defaultImpls[t]).map(t=>l(e,t)).join(", ")}.`)}),Object.keys(n).forEach(function(t){if(-1===e._methodNames.indexOf(t))throw new Error(`${t}() was included in the impl, but is not part of ${e.name||"the protocol"}. Allowed methods: ${e._methodNames.map(t=>l(e,t)).join(", ")}.`)})}(this,e,n),function(e,t){var n=e._types;if(t.length>n.length)throw new Error(`${e.name||"Protocol"} expects to be defined across ${n.length} type${n.length>1?"s":""}, but ${t.length} ${t.length>1?"were":"was"} specified.`)}(this,t),this._constraints.forEach(n=>{if(!n.verify(e,t))throw new Error(`Implementations of ${this.name||"this protocol"} must first implement ${n.parent.name||"its constraint protocols defined in opts.where."}`)}),this._methodNames.forEach(i=>{!function(e,t,n,i,r){const a=e._gfTypes[t].map(function(e){return i[e]});for(let e=a.length-1;e>=0&&void 0===a[e];e--)a.pop();const s=e._metaobject&&e._metaobject!==o;if(Object.prototype.hasOwnProperty.call(n,t)){if("function"==typeof n[t]&&!n[t].isGenfun){const i=s?e._metaobject.createGenfun(e,n,t,n[t]):h(e,n,t,n[t]);n[t]=i}}else{const i=s?e._metaobject.createGenfun(e,n,t,null):h(e,n,t,null);n[t]=i}const l=r[t]||e._defaultImpls[t];l&&(s?e._metaobject.addMethod(e,n,t,a,l):d(e,n,t,a,l))}(this,i,e,t,n)})}hasImpl(e,t){t=t||[];const n=this._methodNames;var i;"function"!=typeof e||e.isGenfun||(e=e.prototype),t=t.map(e=>"function"!=typeof e||e.isGenfun?e:e.prototype);for(var r=0;r<n.length;r++)if(!(i=e[n[r]])||(i.hasMethod?!i.hasMethod.apply(i,t):"function"==typeof i))return!1;return!0}matches(e,t){return!t&&u(e)&&(t=e,e="this"),e||(e="this"),t||(t=[]),new p(this,e,t)}}r.prototype.isDuck=!0,r.prototype.isProtocol=!0;const o=e.exports=s(["duck"],{createGenfun:["duck",h],addMethod:["duck",d]},{name:"Protoduck"}),a=e.exports.noImplFound=i.noApplicableMethod;function s(e,t,n){u(e)||(n=t,t=e,e=[]);const i=function(e,t){return i.matches(e,t)};if(Object.setPrototypeOf(i,r.prototype),i.isDerivable=!0,Object.defineProperty(i,"name",{value:n&&n.name||"Protocol"}),n&&n.where){let e=n.where;u(n.where)||(e=[n.where]),i._constraints=e.map(e=>e.isProtocol?e.matches():e)}else i._constraints=[];return i.isProtocol=!0,i._metaobject=n&&n.metaobject,i._types=e,i._defaultImpls={},i._gfTypes={},i._methodNames=Object.keys(t),i._methodNames.forEach(e=>{!function(e,t,n){let i=n[t];"function"==typeof i&&(e._defaultImpls[t]=i,i=[i]);"function"==typeof i[i.length-1]?e._defaultImpls[t]=i.pop():e.isDerivable=!1;e._gfTypes[t]=i.map(n=>{const i=e._types.indexOf(n);if(-1===i)throw new Error(`type '${n}' for function '${t}' does not match any protocol types (${e._types.join(", ")}).`);return i})}(i,e,t)}),i._constraints.forEach(e=>e.attach(i)),i}function l(e,t,n){return`${n&&e.name?`${e.name}#`:""}${t}(${e._gfTypes[t].map(t=>e._types[t]).join(", ")})`}function c(e){return/\[object ([a-zA-Z0-9]+)\]/.exec({}.toString.call(e))[1]}function u(e){return"[object Array]"===Object.prototype.toString.call(e)}function h(e,t,n,r){var o=i({default:r,name:`${e.name?`${e.name}#`:""}${n}`});return function(e,t,n,i){a.add([t],function(t,n,r){let o=Object.getPrototypeOf(n);for(;o&&o[i]===t;)o=Object.getPrototypeOf(o);o&&o[i]&&o[i];var a=`No ${c(n)} impl for ${e.name?`${e.name}#`:""}${i}(${[].map.call(r,c).join(", ")}). You must implement ${e.name?l(e,i,!0):`the protocol ${l(e,i)} belongs to`} in order to call ${c(n)}#${i}(${[].map.call(r,c).join(", ")}).`;const s=new Error(a);throw s.protocol=e,s.function=t,s.thisArg=n,s.args=r,s.code="ENOIMPL",s})}(e,o,0,n),o.duck=e,o}function d(e,t,n,i,r){return t[n].add(i,r)}e.exports.define=s,o.impl(o);class p{constructor(e,t,n){this.parent=e,this.target=t,this.types=n}attach(e){if(this.child=e,"this"===this.target)this.thisIdx="this";else{const e=this.child._types.indexOf(this.target);this.thisIdx=-1===e?null:e}this.indices=this.types.map(e=>{if("this"===e)return"this";{const t=this.child._types.indexOf(e);return-1===t?null:t}})}verify(e,t){const n="this"===this.thisIdx||null==this.thisIdx?e:t[this.thisIdx],i=this.indices.map(n=>"this"===n?e:"this"===n?t[this.thisIdx]:null===n?Object:t[n]||Object.prototype);return this.parent.hasImpl(n,i)}}p.prototype.isConstraint=!0},function(e,t,n){var i=n(47),r=n(48),o="undefined"!=typeof Float64Array;function a(e,t){return e[0]-t[0]}function s(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(a);var i=new Array(n.length);for(e=0;e<i.length;++e)i[e]=n[e][1];return i}function l(e,t){var n=["View",t,"d",e].join("");t<0&&(n="View_Nil"+e);var r="generic"===e;if(-1===t){var o="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}";return new Function(o)()}if(0===t){o="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}";return new Function("TrivialArray",o)(c[e][0])}o=["'use strict'"];var a=i(t),l=a.map(function(e){return"i"+e}),u="this.offset+"+a.map(function(e){return"this.stride["+e+"]*i"+e}).join("+"),h=a.map(function(e){return"b"+e}).join(","),d=a.map(function(e){return"c"+e}).join(",");o.push("function "+n+"(a,"+h+","+d+",d){this.data=a","this.shape=["+h+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),o.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+a.map(function(e){return"this.shape["+e+"]"}).join("*"),"}})"),1===t?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),t<4?(o.push("function "+n+"_order(){"),2===t?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):o.push("ORDER})")),o.push("proto.set=function "+n+"_set("+l.join(",")+",v){"),r?o.push("return this.data.set("+u+",v)}"):o.push("return this.data["+u+"]=v}"),o.push("proto.get=function "+n+"_get("+l.join(",")+"){"),r?o.push("return this.data.get("+u+")}"):o.push("return this.data["+u+"]}"),o.push("proto.index=function "+n+"_index(",l.join(),"){return "+u+"}"),o.push("proto.hi=function "+n+"_hi("+l.join(",")+"){return new "+n+"(this.data,"+a.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")}).join(",")+","+a.map(function(e){return"this.stride["+e+"]"}).join(",")+",this.offset)}");var p=a.map(function(e){return"a"+e+"=this.shape["+e+"]"}),f=a.map(function(e){return"c"+e+"=this.stride["+e+"]"});o.push("proto.lo=function "+n+"_lo("+l.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+f.join(","));for(var g=0;g<t;++g)o.push("if(typeof i"+g+"==='number'&&i"+g+">=0){d=i"+g+"|0;b+=c"+g+"*d;a"+g+"-=d}");o.push("return new "+n+"(this.data,"+a.map(function(e){return"a"+e}).join(",")+","+a.map(function(e){return"c"+e}).join(",")+",b)}"),o.push("proto.step=function "+n+"_step("+l.join(",")+"){var "+a.map(function(e){return"a"+e+"=this.shape["+e+"]"}).join(",")+","+a.map(function(e){return"b"+e+"=this.stride["+e+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(g=0;g<t;++g)o.push("if(typeof i"+g+"==='number'){d=i"+g+"|0;if(d<0){c+=b"+g+"*(a"+g+"-1);a"+g+"=ceil(-a"+g+"/d)}else{a"+g+"=ceil(a"+g+"/d)}b"+g+"*=d}");o.push("return new "+n+"(this.data,"+a.map(function(e){return"a"+e}).join(",")+","+a.map(function(e){return"b"+e}).join(",")+",c)}");var A=new Array(t),m=new Array(t);for(g=0;g<t;++g)A[g]="a[i"+g+"]",m[g]="b[i"+g+"]";o.push("proto.transpose=function "+n+"_transpose("+l+"){"+l.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+A.join(",")+","+m.join(",")+",this.offset)}"),o.push("proto.pick=function "+n+"_pick("+l+"){var a=[],b=[],c=this.offset");for(g=0;g<t;++g)o.push("if(typeof i"+g+"==='number'&&i"+g+">=0){c=(c+this.stride["+g+"]*i"+g+")|0}else{a.push(this.shape["+g+"]);b.push(this.stride["+g+"])}");return o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+a.map(function(e){return"shape["+e+"]"}).join(",")+","+a.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",o.join("\n"))(c[e],s)}var c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};e.exports=function(e,t,n,i){if(void 0===e)return(0,c.array[0])([]);"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var a=t.length;if(void 0===n){n=new Array(a);for(var s=a-1,u=1;s>=0;--s)n[s]=u,u*=t[s]}if(void 0===i)for(i=0,s=0;s<a;++s)n[s]<0&&(i-=(t[s]-1)*n[s]);for(var h=function(e){if(r(e))return"buffer";if(o)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(e)?"array":"generic"}(e),d=c[h];d.length<=a+1;)d.push(l(h,d.length-1));return(0,d[a+1])(e,t,n,i)}},function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(e[i]=n[i])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),r);else for(var o=0;o<i;o++)e[r+o]=t[n+o]},flattenChunks:function(e){var t,n,i,r,o,a;for(i=0,t=0,n=e.length;t<n;t++)i+=e[t].length;for(a=new Uint8Array(i),r=0,t=0,n=e.length;t<n;t++)o=e[t],a.set(o,r),r+=o.length;return a}},a={arraySet:function(e,t,n,i,r){for(var o=0;o<i;o++)e[r+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,o)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,a))},t.setTyped(i)},function(e,t,n){"use strict";var i=n(50),r={body:"",args:[],thisVars:[],localVars:[]};function o(e){if(!e)return r;for(var t=0;t<e.args.length;++t){var n=e.args[t];e.args[t]=0===t?{name:n,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:{name:n,lvalue:!1,rvalue:!0,count:1}}return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function a(e){for(var t=[],n=0;n<e.args.length;++n)t.push("a"+n);return new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""))(function(e){return i({args:e.args,pre:o(e.pre),body:o(e.body),post:o(e.proc),funcName:e.funcName})}(e))}var s={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var e in s){var n=s[e];t[e]=a({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:e}),t[e+"eq"]=a({args:["array","array"],body:{args:["a","b"],body:"a"+n+"=b"},rvalue:!0,funcName:e+"eq"}),t[e+"s"]=a({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:e+"s"}),t[e+"seq"]=a({args:["array","scalar"],body:{args:["a","s"],body:"a"+n+"=s"},rvalue:!0,funcName:e+"seq"})}}();var l={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var e in l){var n=l[e];t[e]=a({args:["array","array"],body:{args:["a","b"],body:"a="+n+"b"},funcName:e}),t[e+"eq"]=a({args:["array"],body:{args:["a"],body:"a="+n+"a"},rvalue:!0,count:2,funcName:e+"eq"})}}();var c={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var e in c){var n=c[e];t[e]=a({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:e}),t[e+"s"]=a({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:e+"s"}),t[e+"eq"]=a({args:["array","array"],body:{args:["a","b"],body:"a=a"+n+"b"},rvalue:!0,count:2,funcName:e+"eq"}),t[e+"seq"]=a({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+n+"s"},rvalue:!0,count:2,funcName:e+"seq"})}}();var u=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var e=0;e<u.length;++e){var n=u[e];t[n]=a({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:n}),t[n+"eq"]=a({args:["array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"})}}();var h=["max","min","atan2","pow"];!function(){for(var e=0;e<h.length;++e){var n=h[e];t[n]=a({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n}),t[n+"s"]=a({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n+"s"}),t[n+"eq"]=a({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"}),t[n+"seq"]=a({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"seq"})}}();var d=["atan2","pow"];!function(){for(var e=0;e<d.length;++e){var n=d[e];t[n+"op"]=a({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"op"}),t[n+"ops"]=a({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"ops"}),t[n+"opeq"]=a({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opeq"}),t[n+"opseq"]=a({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opseq"})}}(),t.any=i({args:["array"],pre:r,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),t.all=i({args:["array"],pre:r,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),t.sum=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),t.prod=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),t.norm2squared=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),t.norm2=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),t.norminf=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),t.norm1=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),t.sup=i({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.inf=i({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.argmin=i({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.argmax=i({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.random=a({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),t.assign=a({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),t.assigns=a({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),t.equals=i({args:["array","array"],pre:r,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},,,function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var i=n(42),r=/[ \f\t\v]*\r?\n/,o=/^NRRD\d{4}$/,a=/^([^:]*)(:[ =])(.*)$/,s=/^LIST(?: (\d+))?$/;function l(e){return e.replace("\\","\\\\").replace("\n","\\n")}function c(e){return e.split("\\\\").map(function(e){return e.replace("\\n","\n")}).join("\\")}function u(e,t,n,r){var o,a=function(e){return e in p?p[e]:e}(e);switch(e){case"data":case"buffer":case"keys":case"version":break;case"content":case"number":case"sampleUnits":case"space":o=a+": "+t;break;case"blockSize":case"lineSkip":case"byteSkip":case"dimension":case"spaceDimension":i("number"==typeof t||t instanceof Number,"Field "+e+" should at least contain a number!"),o=a+": "+t;break;case"min":case"max":case"oldMin":case"oldMax":i("number"==typeof t||t instanceof Number,"Field "+e+" should contain a number!"),o=a+": "+t;break;case"spaceOrigin":i(t.length===r,"Field "+e+" should be a list with length equal to the space dimension!"),t.forEach(function(t){i("number"==typeof t||t instanceof Number,"Field "+e+" should be a list of numbers!")}),o=a+": ("+t.join(",")+")";break;case"labels":case"units":case"spaceUnits":i(void 0!==t.length&&t.length==n,"Field "+e+" should be a list with length equal to the dimension!"),t.forEach(function(t){i("string"==typeof t||t instanceof String,"Field "+e+" should be a list of numbers!")}),o=a+": "+t.map(b).join(" ");break;case"sizes":i(void 0!==t.length&&t.length==n,"Field "+e+" should be a list with length equal to the dimension!"),t.forEach(function(t){i("number"==typeof t||t instanceof Number,"Field "+e+" should be a list of numbers!")}),o=a+": "+t.join(" ");break;case"spacings":case"thicknesses":case"axisMins":case"axisMaxs":i(void 0!==t.length&&t.length==n,"Field "+e+" should be a list with length equal to the dimension!"),t.forEach(function(t){i("number"==typeof t||t instanceof Number,"Field "+e+" should be a list of numbers!")}),o=a+": "+t.join(" ");break;case"spaceDirections":i(void 0!==t.length&&t.length===n,"Field "+e+" should be a list with length equal to the dimension!"),t.forEach(function(t){i(null===t||void 0!==t.length&&t.length===r,"The elements of field "+e+" should be lists with length equal to the space dimension!"),null!==t&&t.forEach(function(t){i("number"==typeof t||t instanceof Number,"The elements of field "+e+" should be lists of numbers!")})}),o=a+": "+t.map(function(e){return null===e?"none":"("+e.join(",")+")"}).join(" ");break;case"measurementFrame":i(void 0!==t.length&&t.length===r,"Field "+e+" should be a list with length equal to the space dimension!"),t.forEach(function(t){i(null===t||void 0!==t.length&&t.length===r,"The elements of field "+e+" should be lists with length equal to the space dimension!"),null!==t&&t.forEach(function(t){i("number"==typeof t||t instanceof Number,"The elements of field "+e+" should be lists of numbers!")})}),o=a+": "+t.map(function(e){return null===e?"none":"("+e.join(",")+")"}).join(" ");break;case"type":case"encoding":case"endian":i("string"==typeof t||t instanceof String,"Field "+e+" should contain a string!"),o=a+": "+t;break;case"dataFile":t.length||t.files&&"subdim"in t||(o=a+": "+function(e){if("string"==typeof e||e instanceof String)return e;if("format"in e&&"min"in e&&"max"in e&&"step"in e)return"subdim"in e?e.format+" "+e.min+" "+e.max+" "+e.step+" "+e.subdim:e.format+" "+e.min+" "+e.max+" "+e.step;throw new Error("Unrecognized data file format!")}(t));break;case"centers":case"kinds":i(void 0!==t.length&&t.length==n,"Field "+e+" should be a list with length equal to the dimension!"),o=a+": "+t.map(T).join(" ");break;default:console.warn("Unrecognized NRRD field: "+e+", skipping.")}return o}function h(e,t){switch(e){case"content":case"number":case"sampleUnits":break;case"dimension":case"blockSize":case"lineSkip":case"byteSkip":case"spaceDimension":t=g(t);break;case"min":case"max":case"oldMin":case"oldMax":t=A(t);break;case"spaceOrigin":t=m(t);break;case"labels":case"units":case"spaceUnits":t=w(t,v);break;case"sizes":t=w(t,g);break;case"spacings":case"thicknesses":case"axisMins":case"axisMaxs":t=w(t,A);break;case"spaceDirections":case"measurementFrame":t=w(t,m);break;case"type":t=S(t);break;case"encoding":t=E(t);break;case"endian":t=_(t);break;case"dataFile":t=function(e){var t=R.exec(e);return t?5==t.length&&t[4]?{format:e.substring(0,t.index),min:g(t[1]),max:g(t[2]),step:g(t[3]),subdim:g(t[4])}:{format:e.substring(0,t.index),min:g(t[1]),max:g(t[2]),step:g(t[3])}:e}(t);break;case"centers":t=w(t,x);break;case"kinds":t=w(t,I);break;case"space":t=function(e){switch(e.toLowerCase()){case"right-anterior-superior":case"ras":return"right-anterior-superior";case"left-anterior-superior":case"las":return"left-anterior-superior";case"left-posterior-superior":case"lps":return"left-posterior-superior";case"right-anterior-superior-time":case"rast":return"right-anterior-superior-time";case"left-anterior-superior-time":case"last":return"left-anterior-superior-time";case"left-posterior-superior-time":case"lpst":return"left-posterior-superior-time";case"scanner-xyz":return"scanner-xyz";case"scanner-xyz-time":return"scanner-xyz-time";case"3d-right-handed":return"3D-right-handed";case"3d-left-handed":return"3D-left-handed";case"3d-right-handed-time":return"3D-right-handed-time";case"3d-left-handed-time":return"3D-left-handed-time";default:return console.warn("Unrecognized space: "+e),e}}(t);break;default:console.warn("Unrecognized NRRD field: "+e)}return t}e.exports.serialize=function(e){var t,n,i,r,o,a,s,c,h,d,p=1,f={},g=[];for(r in e)f[r]=e[r];if(void 0===f.sizes)throw new Error("Sizes missing from NRRD file!");if(void 0===f.dimension&&(f.dimension=f.sizes.length),f.data instanceof Int8Array?o="int8":f.data instanceof Uint8Array?o="uint8":f.data instanceof Int16Array?o="int16":f.data instanceof Uint16Array?o="uint16":f.data instanceof Int32Array?o="int32":f.data instanceof Uint32Array?o="uint32":f.data instanceof Float32Array?o="float":f.data instanceof Float64Array&&(o="double"),void 0===f.type&&void 0!==o)f.type=o;else{if(void 0===f.type)throw new Error("Type of data is not given and cannot be inferred!");("string"==typeof f.type||f.type instanceof String)&&(f.type=S(f.type))}void 0===f.encoding?f.encoding="raw":("string"==typeof f.encoding||f.encoding instanceof String)&&(f.encoding=E(f.encoding)),f.data&&"block"!=f.type&&"int8"!=f.type&&"uint8"!=f.type&&"ascii"!=f.encoding?f.endian=P:"block"==f.type||"int8"==f.type||"uint8"==f.type||"ascii"==f.encoding?f.endian=void 0:("string"==typeof f.endian||f.endian instanceof String)&&(f.endian=_(f.endian));var A=void 0;if(void 0!==f.spaceDimension)A=f.spaceDimension;else if(void 0!==f.space)switch(f.space){case"right-anterior-superior":case"RAS":A=3;break;case"left-anterior-superior":case"LAS":A=3;break;case"left-posterior-superior":case"LPS":A=3;break;case"right-anterior-superior-time":case"RAST":A=4;break;case"left-anterior-superior-time":case"LAST":A=4;break;case"left-posterior-superior-time":case"LPST":A=4;break;case"scanner-xyz":A=3;break;case"scanner-xyz-time":A=4;break;case"3D-right-handed":case"3D-left-handed":A=3;break;case"3D-right-handed-time":case"3D-left-handed-time":A=4;break;default:console.warn("Unrecognized space: "+f.space)}for(M(f),t=0;t<f.sizes.length;t++){if(f.sizes[t]<=0)throw new Error("Sizes should be a list of positive (>0) integers!");p*=f.sizes[t]}if(f.data){if(f.data.length<p)throw new Error("Missing data to serialize!")}else if(f.buffer){if("raw"==f.encoding&&(a="block"==f.type&&void 0!==f.blockSize?f.blockSize:k(f.type),f.buffer.byteLength<p*a))throw new Error("Missing data to serialize!")}else if(!f.dataFile)throw new Error("Will not serialize an empty NRRD file!");if(f.data)switch(f.encoding){case"raw":s=f.type==o&&f.endian==P?f.data.buffer.slice(f.data.byteOffset,f.data.byteOffset+f.data.byteLength):f.endian==P?(s=L(f.data,f.type)).buffer.slice(s.byteOffset,s.byteOffset+s.byteLength):function(e,t,n){var i,r,o,a=k(t),s=new ArrayBuffer(e.length*a);switch(n){case"big":r=!1;break;case"little":r=!0;break;default:return void console.warn("Unsupported endianness in NRRD file: "+n)}switch(o=new DataView(s),t){case"int8":for(i=0;i<e.length;i++)o.setInt8(i,e[i],r);return s;case"uint8":for(i=0;i<e.length;i++)o.setUint8(i,e[i],r);return s;case"int16":for(i=0;i<e.length;i++)o.setInt16(2*i,e[i],r);return s;case"uint16":for(i=0;i<e.length;i++)o.setUint16(2*i,e[i],r);return s;case"int32":for(i=0;i<e.length;i++)o.setInt32(4*i,e[i],r);return s;case"uint32":for(i=0;i<e.length;i++)o.setUint32(4*i,e[i],r);return s;case"float":for(i=0;i<e.length;i++)o.setFloat32(4*i,e[i],r);return s;case"double":for(i=0;i<e.length;i++)o.setFloat64(8*i,e[i],r);return s;default:return void console.warn("Cannot serialize NRRD type: "+t+".")}}(f.data,f.type,f.endian);break;case"ascii":s=f.type==o?B(f.data):B(L(f.data,f.type));break;default:throw new Error("Unsupported NRRD encoding: "+f.encoding)}else f.buffer&&(s=f.buffer);g.push("NRRD0005"),g.push("# Generated by nrrd-js");var m=["dimension","spaceDimension","space"];for(t=0;t<m.length;t++)void 0!==f[r=m[t]]&&void 0!==(h=u(r,f[r],f.dimension,A))&&g.push(h);for(r in f)void 0!==f[r]&&(m.indexOf(r)>=0||void 0!==(h=u(r,f[r],f.dimension,A))&&g.push(h));if(f.keys)for(r in f.keys){if(r.indexOf(":=")>=0)throw new Error("The combination ':=' is not allowed in an NRRD key!");g.push(r+":="+l(f[r]))}if(f.dataFile&&f.dataFile.length?(g.push("data file: LIST"),Array.prototype.push.apply(g,f.dataFile)):f.dataFile&&f.dataFile.files&&"subdim"in f.dataFile&&(g.push("data file: LIST "+f.dataFile.subdim),Array.prototype.push.apply(g,f.dataFile.files)),!s||"dataFile"in f)for(g.push(""),d=g.join("\n"),n=new ArrayBuffer(d.length),i=new Uint8Array(n),t=0;t<d.length;t++)i[t]=d.charCodeAt(t);else{for(g.push(""),g.push(""),d=g.join("\n"),n=new ArrayBuffer(d.length+s.byteLength),i=new Uint8Array(n),t=0;t<d.length;t++)i[t]=d.charCodeAt(t);c=new Uint8Array(s),i.set(c,d.length)}return n},e.exports.parse=function(e){var t,n,i,l,u,d,p={data:void 0,buffer:void 0,keys:{},version:void 0},m=new Uint8Array(e);for(m.buffer!==e&&(e=m.buffer),t=2;t<m.length;)if(10==m[t]){if(10==m[t-1]||13==m[t-1]&&10==m[t-2]){i=t+1;break}t++}else 13==m[t]?t++:t+=2;if(void 0===i?n=String.fromCharCode.apply(null,m):(n=String.fromCharCode.apply(null,m.subarray(0,i)),p.buffer=e.slice(i)),l=(l=n.split(r)).filter(function(e){return e.length>0&&"#"!=e[0]}),!o.test(l[0]))throw new Error("File is not an NRRD file!");for(p.version=parseInt(l[0].substring(4,8),10),p.version>5&&console.warn("Reading an unsupported version of the NRRD format; things may go haywire."),t=1;t<l.length;t++)if(u=a.exec(l[t]))if(": "==u[2])u[1]=f(u[1]),"dataFile"==u[1]&&(d=s.exec(u[3]))?(2==d.length&&d[1]?p[u[1]]={files:l.slice(t+1),subdim:g(d[1])}:p[u[1]]=l.slice(t+1),l.length=t):p[u[1]]=h(u[1],u[3]);else{if(":="!=u[2])throw new Error("Logic error in NRRD parser.");p.keys[u[1]]=c(u[3])}else console.warn("Unrecognized line in NRRD header: "+l[t]);if(M(p),"dataFile"in p)console.warn("No support for external data yet!");else switch(p.encoding){case"raw":p.data=function(e,t,n,i){var r,o,a,s=1;for(r=0;r<n.length;r++){if(n[r]<=0)throw new Error("Sizes should be a list of positive (>0) integers!");s*=n[r]}if("block"==t)return e.slice(0,s*i.blockSize);if("int8"==t||"uint8"==t||i.endian==P)switch(t){case"int8":return l(1),new Int8Array(e.slice(0,s));case"uint8":return l(1),new Uint8Array(e.slice(0,s));case"int16":return l(2),new Int16Array(e.slice(0,2*s));case"uint16":return l(2),new Uint16Array(e.slice(0,2*s));case"int32":return l(4),new Int32Array(e.slice(0,4*s));case"uint32":return l(4),new Uint32Array(e.slice(0,4*s));case"float":return l(4),new Float32Array(e.slice(0,4*s));case"double":return l(8),new Float64Array(e.slice(0,8*s));default:return void console.warn("Unsupported NRRD type: "+t+", returning raw buffer.")}else{switch(i.endian){case"big":!1;break;case"little":!0;break;default:return void console.warn("Unsupported endianness in NRRD file: "+i.endian)}switch(a=new DataView(e),t){case"int8":for(o=new Int8Array(s),r=0;r<s;r++)o[r]=a.getInt8(r);return o;case"uint8":for(o=new Uint8Array(s),r=0;r<s;r++)o[r]=a.getUint8(r);return o;case"int16":for(o=new Int16Array(s),r=0;r<s;r++)o[r]=a.getInt16(2*r);return o;case"uint16":for(o=new Uint16Array(s),r=0;r<s;r++)o[r]=a.getUint16(2*r);return o;case"int32":for(o=new Int32Array(s),r=0;r<s;r++)o[r]=a.getInt32(4*r);return o;case"uint32":for(o=new Uint32Array(s),r=0;r<s;r++)o[r]=a.getUint32(4*r);return o;case"float":for(o=new Float32Array(s),r=0;r<s;r++)o[r]=a.getFloat32(4*r);return o;case"double":for(o=new Float64Array(s),r=0;r<s;r++)o[r]=a.getFloat64(8*r);return o;default:return void console.warn("Unsupported NRRD type: "+t+", returning raw buffer.")}}function l(t){if(e.byteLength<s*t)throw new Error("NRRD file does not contain enough data!")}}(p.buffer,p.type,p.sizes,{endian:p.endian,blockSize:p.blockSize});break;case"ascii":p.data=function(e,t,n){var i,r,o,a,s=1;for(i=0;i<n.length;i++){if(n[i]<=0)throw new Error("Sizes should be a list of positive (>0) integers!");s*=n[i]}if(r=new Uint8Array(e),o=String.fromCharCode.apply(null,r),(a=o.split(O)).length<s)throw new Error("Not enough data in NRRD file!");a.length>s&&(""===a[0]&&(a=a.slice(1)),a=a.slice(0,s));switch(t){case"int8":return new Int8Array(a.map(g));case"uint8":return new Uint8Array(a.map(g));case"int16":return new Int16Array(a.map(g));case"uint16":return new Uint16Array(a.map(g));case"int32":return new Int32Array(a.map(g));case"uint32":return new Uint32Array(a.map(g));case"float":return new Float32Array(a.map(A));case"double":return new Float64Array(a.map(A));default:return void console.warn("Unsupported NRRD type: "+t+".")}}(p.buffer,p.type,p.sizes);break;default:console.warn("Unsupported NRRD encoding: "+p.encoding)}return p};var d={"block size":"blockSize",blocksize:"blockSize","old min":"oldMin",oldmin:"oldMin","old max":"oldMax",oldmax:"oldMax","data file":"dataFile",datafile:"dataFile","line skip":"lineSkip",lineskip:"lineSkip","byte skip":"byteSkip",byteskip:"byteSkip","sample units":"sampleUnits",sampleunits:"sampleUnits","axis mins":"axisMins","axis maxs":"axisMaxs",centers:"centers",centerings:"centers","space dimension":"spaceDimension","space units":"spaceUnits","space origin":"spaceOrigin","space directions":"spaceDirections","measurement frame":"measurementFrame"},p=function(){var e,t={};for(e in d)t[d[e]]=e;return t}();function f(e){return(e=e.toLowerCase())in d?d[e]:e}function g(e){var t=parseInt(e,10);if(Number.isNaN(t))throw new Error("Malformed NRRD integer: "+e);return t}function A(e){if((e=e.toLowerCase()).indexOf("nan")>=0)return NaN;if(e.indexOf("-inf")>=0)return-1/0;if(e.indexOf("inf")>=0)return 1/0;var t=parseFloat(e);if(Number.isNaN(t))throw new Error("Malformed NRRD float: "+e);return t}function m(e){if("none"==e)return null;if(e.length<2||"("!==e[0]||")"!==e[e.length-1])throw new Error("Malformed NRRD vector: "+e);return e.slice(1,-1).split(",").map(A)}function v(e){if(length<2||'"'!=e[0]||'"'!=e[e.length-1])throw new Error("Invalid NRRD quoted string: "+e);return e.slice(1,-1).replace('\\"','"')}function b(e){return'"'+e.replace('"','\\"')+'"'}var y=/[ \t]+/;function w(e,t){return e.split(y).map(t)}function S(e){switch(e.toLowerCase()){case"signed char":case"int8":case"int8_t":return"int8";case"uchar":case"unsigned char":case"uint8":case"uint8_t":return"uint8";case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":return"int16";case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":return"uint16";case"int":case"signed int":case"int32":case"int32_t":return"int32";case"uint":case"unsigned int":case"uint32":case"uint32_t":return"uint32";case"longlong":case"long long":case"long long int":case"signed long long":case"signed long long int":case"int64":case"int64_t":return"int64";case"ulonglong":case"unsigned long long":case"unsigned long long int":case"uint64":case"uint64_t":return"uint64";case"float":return"float";case"double":return"double";case"block":return"block";default:return console.warn("Unrecognized NRRD type: "+e),e}}function E(e){switch(e.toLowerCase()){case"raw":return"raw";case"txt":case"text":case"ascii":return"ascii";case"hex":return"hex";case"gz":case"gzip":return"gzip";case"bz2":case"bzip2":return"bzip2";default:return console.warn("Unrecognized NRRD encoding: "+e),e}}function _(e){switch(e.toLowerCase()){case"little":return"little";case"big":return"big";default:return console.warn("Unrecognized NRRD endianness: "+e),e}}var R=/ (-?\d+) (-?\d+) (-?\d+)(?: (\d+))?$/;function x(e){switch(e.toLowerCase()){case"cell":return"cell";case"node":return"node";case"???":case"none":return null;default:return console.warn("Unrecognized NRRD center: "+e),e}}var C={domain:"domain",space:"space",time:"time",list:"list",point:"point",vector:"vector","covariant-vector":"covariant-vector",normal:"normal",stub:"stub",scalar:"scalar",complex:"complex","2-vector":"2-vector","3-color":"3-color","rgb-color":"RGB-color","hsv-color":"HSV-color","xyz-color":"XYZ-color","4-color":"4-color","rgba-color":"RGBA-color","3-vector":"3-vector","3-gradient":"3-gradient","3-normal":"3-normal","4-vector":"4-vector",quaternion:"quaternion","2d-symmetric-matrix":"2D-symmetric-matrix","2d-masked-symmetric-matrix":"2D-masked-symmetric-matrix","2d-matrix":"2D-matrix","2d-masked-matrix":"2D-masked-matrix","3d-symmetric-matrix":"3D-symmetric-matrix","3d-masked-symmetric-matrix":"3D-masked-symmetric-matrix","3d-matrix":"3D-matrix","3d-masked-matrix":"3D-masked-matrix","???":null,none:null};function I(e){var t=e.toLowerCase();return t in C?C[t]:(console.warn("Unrecognized NRRD kind: "+e),e)}function T(e){return null===e?"???":e}var P=function(){var e=new ArrayBuffer(4),t=new Uint32Array(e),n=new Uint8Array(e);return t[0]=16909060,1==n[0]&&2==n[1]&&3==n[2]&&4==n[3]?"big":4==n[0]&&3==n[1]&&2==n[2]&&1==n[3]?"little":void console.warn("Unrecognized system endianness!")}();var O=/[ \t\n\r\v\f]+/;function k(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":return 4;case"int64":case"uint64":return 8;case"float":return 4;case"double":return 8;default:throw new Error("Do not know the size of NRRD type: "+e)}}function M(e){if(void 0===e.dimension)throw new Error("Dimension missing from NRRD file!");if(void 0===e.type)throw new Error("Type missing from NRRD file!");if(void 0===e.encoding)throw new Error("Encoding missing from NRRD file!");if(void 0===e.sizes)throw new Error("Sizes missing from NRRD file!");if("block"!=e.type&&"int8"!=e.type&&"uint8"!=e.type&&"ascii"!=e.encoding&&void 0===e.endian)throw new Error("Endianness missing from NRRD file!");if("block"==e.type&&void 0===e.blockSize)throw new Error("Missing block size in NRRD file!");if(0===e.dimension)throw new Error("Zero-dimensional NRRD file?");if(e.dimension!=e.sizes.length)throw new Error("Length of 'sizes' is different from 'dimension' in an NRRD file!");if(e.spacings&&e.dimension!=e.spacings.length)throw new Error("Length of 'spacings' is different from 'dimension' in an NRRD file!");if(e.thicknesses&&e.dimension!=e.thicknesses.length)throw new Error("Length of 'thicknesses' is different from 'dimension' in an NRRD file!");if(e.axisMins&&e.dimension!=e.axisMins.length)throw new Error("Length of 'axis mins' is different from 'dimension' in an NRRD file!");if(e.axisMaxs&&e.dimension!=e.axisMaxs.length)throw new Error("Length of 'axis maxs' is different from 'dimension' in an NRRD file!");if(e.centers&&e.dimension!=e.centers.length)throw new Error("Length of 'centers' is different from 'dimension' in an NRRD file!");if(e.labels&&e.dimension!=e.labels.length)throw new Error("Length of 'labels' is different from 'dimension' in an NRRD file!");if(e.units&&e.dimension!=e.units.length)throw new Error("Length of 'units' is different from 'dimension' in an NRRD file!");if(e.kinds&&e.dimension!=e.kinds.length)throw new Error("Length of 'kinds' is different from 'dimension' in an NRRD file!");if(!(void 0!==e.data&&0!==e.data.length||void 0!==e.buffer&&0!==e.buffer.byteLength||void 0!==e.dataFile))throw new Error("NRRD file has neither inline or external data!")}function L(e,t){switch(t){case"int8":return new Int8Array(e);case"uint8":return new Uint8Array(e);case"int16":return new Int16Array(e);case"uint16":return new Uint16Array(e);case"int32":return new Int32Array(e);case"uint32":return new Uint32Array(e);case"float":return new Float32Array(e);case"double":return new Float64Array(e);default:throw new Error("Cannot cast to NRRD type: "+t)}}function B(e){var t,n,i,r,o=new Array(e.length);for(t=0;t<e.length;t++)o[t]=""+e[t];for(n=o.join(" "),i=new ArrayBuffer(n.length),r=new Uint8Array(i),t=0;t<r.length;t++)r[t]=n.charCodeAt(t);return i}},function(e,t,n){"use strict";(function(e,i){var r=n(58),o=n(59);e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:o([32,0]),UINT16:o([32,0]),UINT32:o([32,0]),INT8:o([32,0]),INT16:o([32,0]),INT32:o([32,0]),FLOAT:o([32,0]),DOUBLE:o([32,0]),DATA:o([32,0]),UINT8C:o([32,0]),BUFFER:o([32,0])});var a="undefined"!=typeof Uint8ClampedArray,s=e.__TYPEDARRAY_POOL;s.UINT8C||(s.UINT8C=o([32,0])),s.BUFFER||(s.BUFFER=o([32,0]));var l=s.DATA,c=s.BUFFER;function u(e){if(e){var t=e.length||e.byteLength,n=r.log2(t);l[n].push(e)}}function h(e){e=r.nextPow2(e);var t=r.log2(e),n=l[t];return n.length>0?n.pop():new ArrayBuffer(e)}function d(e){return new Uint8Array(h(e),0,e)}function p(e){return new Uint16Array(h(2*e),0,e)}function f(e){return new Uint32Array(h(4*e),0,e)}function g(e){return new Int8Array(h(e),0,e)}function A(e){return new Int16Array(h(2*e),0,e)}function m(e){return new Int32Array(h(4*e),0,e)}function v(e){return new Float32Array(h(4*e),0,e)}function b(e){return new Float64Array(h(8*e),0,e)}function y(e){return a?new Uint8ClampedArray(h(e),0,e):d(e)}function w(e){return new DataView(h(e),0,e)}function S(e){e=r.nextPow2(e);var t=r.log2(e),n=c[t];return n.length>0?n.pop():new i(e)}t.free=function(e){if(i.isBuffer(e))c[r.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,n=0|r.log2(t);l[n].push(e)}},t.freeUint8=t.freeUint16=t.freeUint32=t.freeInt8=t.freeInt16=t.freeInt32=t.freeFloat32=t.freeFloat=t.freeFloat64=t.freeDouble=t.freeUint8Clamped=t.freeDataView=function(e){u(e.buffer)},t.freeArrayBuffer=u,t.freeBuffer=function(e){c[r.log2(e.length)].push(e)},t.malloc=function(e,t){if(void 0===t||"arraybuffer"===t)return h(e);switch(t){case"uint8":return d(e);case"uint16":return p(e);case"uint32":return f(e);case"int8":return g(e);case"int16":return A(e);case"int32":return m(e);case"float":case"float32":return v(e);case"double":case"float64":return b(e);case"uint8_clamped":return y(e);case"buffer":return S(e);case"data":case"dataview":return w(e);default:return null}return null},t.mallocArrayBuffer=h,t.mallocUint8=d,t.mallocUint16=p,t.mallocUint32=f,t.mallocInt8=g,t.mallocInt16=A,t.mallocInt32=m,t.mallocFloat32=t.mallocFloat=v,t.mallocFloat64=t.mallocDouble=b,t.mallocUint8Clamped=y,t.mallocDataView=w,t.mallocBuffer=S,t.clearCache=function(){for(var e=0;e<32;++e)s.UINT8[e].length=0,s.UINT16[e].length=0,s.UINT32[e].length=0,s.INT8[e].length=0,s.INT16[e].length=0,s.INT32[e].length=0,s.FLOAT[e].length=0,s.DOUBLE[e].length=0,s.UINT8C[e].length=0,l[e].length=0,c[e].length=0}}).call(this,n(7),n(54).Buffer)},function(e,t){var n=null,i={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"};e.exports=function(e,t){if(!n){var r=Object.keys(i);n={};for(var o=0;o<r.length;++o){var a=r[o];n[e[a]]=i[a]}}return n[t]}},function(e,t,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,n){"use strict";var i={};(0,n(3).assign)(i,n(161),n(164),n(34)),e.exports=i},,,function(e,t,n){var i=n(38),r=n(39);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||i)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||r(a)}},function(e,t,n){"use strict";function i(e,t){this.method=e,this.position=t}e.exports=i,i.roleKeyName=Symbol("roles")},function(e,t,n){"use strict";e.exports.isObjectProto=function(e){return e===Object.prototype};const i={},r={},o=Boolean,a=Number,s=String,l={true:new o(!0),false:new o(!1)},c={},u={};e.exports.dispatchableObject=function(e){const t=Object;if(null===e)return i;if(void 0===e)return r;switch(typeof e){case"object":return e;case"boolean":return l[e];case"number":return c[e]||(c[e]=new a(e));case"string":return u[e]||(u[e]=new s(e));default:return new t(e)}}},function(e,t){e.exports=function(e,t){if(!t||"object"!=typeof t)return e;var n=Object.keys(t),i=n.length;for(;i--;)e[n[i]]=t[n[i]];return e}},function(e,t){e.exports=function(e,t,n){var i;if(n){var r=n.tempAttribState,o=n.attribState;for(i=0;i<r.length;i++)r[i]=!1;for(i=0;i<t.length;i++)r[t[i].attribute.location]=!0;for(i=0;i<o.length;i++)o[i]!==r[i]&&(o[i]=r[i],n.attribState[i]?e.enableVertexAttribArray(i):e.disableVertexAttribArray(i))}else for(i=0;i<t.length;i++){var a=t[i];e.enableVertexAttribArray(a.attribute.location)}}},function(e,t){var n=function(e,t,n,i,r){this.gl=e,this.texture=e.createTexture(),this.mipmap=!1,this.premultiplyAlpha=!1,this.width=t||-1,this.height=n||-1,this.format=i||e.RGBA,this.type=r||e.UNSIGNED_BYTE};n.prototype.upload=function(e){this.bind();var t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);var n=e.videoWidth||e.width,i=e.videoHeight||e.height;i!==this.height||n!==this.width?t.texImage2D(t.TEXTURE_2D,0,this.format,this.format,this.type,e):t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.format,this.type,e),this.width=n,this.height=i};var i=!1;n.prototype.uploadData=function(e,t,n){this.bind();var r=this.gl;if(e instanceof Float32Array){if(!i){if(!r.getExtension("OES_texture_float"))throw new Error("floating point textures not available");i=!0}this.type=r.FLOAT}else this.type=this.type||r.UNSIGNED_BYTE;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t!==this.width||n!==this.height?r.texImage2D(r.TEXTURE_2D,0,this.format,t,n,0,this.format,this.type,e||null):r.texSubImage2D(r.TEXTURE_2D,0,0,0,t,n,this.format,this.type,e||null),this.width=t,this.height=n},n.prototype.bind=function(e){var t=this.gl;void 0!==e&&t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this.texture)},n.prototype.unbind=function(){var e=this.gl;e.bindTexture(e.TEXTURE_2D,null)},n.prototype.minFilter=function(e){var t=this.gl;this.bind(),this.mipmap?t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e?t.LINEAR_MIPMAP_LINEAR:t.NEAREST_MIPMAP_NEAREST):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e?t.LINEAR:t.NEAREST)},n.prototype.magFilter=function(e){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e?t.LINEAR:t.NEAREST)},n.prototype.enableMipmap=function(){var e=this.gl;this.bind(),this.mipmap=!0,e.generateMipmap(e.TEXTURE_2D)},n.prototype.enableLinearScaling=function(){this.minFilter(!0),this.magFilter(!0)},n.prototype.enableNearestScaling=function(){this.minFilter(!1),this.magFilter(!1)},n.prototype.enableWrapClamp=function(){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)},n.prototype.enableWrapRepeat=function(){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)},n.prototype.enableWrapMirrorRepeat=function(){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.MIRRORED_REPEAT)},n.prototype.destroy=function(){this.gl.deleteTexture(this.texture)},n.fromSource=function(e,t,i){var r=new n(e);return r.premultiplyAlpha=i||!1,r.upload(t),r},n.fromData=function(e,t,i,r){var o=new n(e);return o.uploadData(t,i,r),o},e.exports=n},function(e,t){var n=function(e,t,n){var i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(console.log(e.getShaderInfoLog(i)),null)};e.exports=function(e,t,i,r){var o=n(e,e.VERTEX_SHADER,t),a=n(e,e.FRAGMENT_SHADER,i),s=e.createProgram();if(e.attachShader(s,o),e.attachShader(s,a),r)for(var l in r)e.bindAttribLocation(s,r[l],l);return e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",e.getProgramParameter(s,e.VALIDATE_STATUS)),console.error("gl.getError()",e.getError()),""!==e.getProgramInfoLog(s)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(s)),e.deleteProgram(s),s=null),e.deleteShader(o),e.deleteShader(a),s}},function(e,t,n){var i=n(10),r=n(23),o=function(e,t,n,i){gl.vertexAttribPointer(this.location,this.size,e||gl.FLOAT,t||!1,n||0,i||0)};e.exports=function(e,t){for(var n={},a=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),s=0;s<a;s++){var l=e.getActiveAttrib(t,s),c=i(e,l.type);n[l.name]={type:c,size:r(c),location:e.getAttribLocation(t,l.name),pointer:o}}return n}},function(e,t){var n={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};e.exports=function(e){return n[e]}},function(e,t,n){var i=n(10),r=n(25);e.exports=function(e,t){for(var n={},o=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),a=0;a<o;a++){var s=e.getActiveUniform(t,a),l=s.name.replace(/\[.*?\]/,""),c=i(e,s.type);n[l]={type:c,size:s.size,location:e.getUniformLocation(t,l),value:r(c,s.size)}}return n}},function(e,t){var n=function(e){for(var t=new Array(e),n=0;n<t.length;n++)t[n]=!1;return t};e.exports=function(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"bool":return!1;case"bvec2":return n(2*t);case"bvec3":return n(3*t);case"bvec4":return n(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}}},function(e,t){e.exports=function(e,t){return"precision"!==e.substring(0,9)?"precision "+t+" float;\n"+e:e}},function(e,t){var n=function(e){var t=o.replace("%%",e);return new Function(t)},i=function(e,t){var n,i=a.replace(/%%/g,e);return(n=1===t.size?s[t.type]:l[t.type])&&(i+="\nthis.gl."+n+";"),new Function("value",i)},r=function(e,t){for(var n=t,i=0;i<e.length-1;i++){var r=n[e[i]]||{data:{}};n[e[i]]=r,n=r}return n},o=["return this.data.%%.value;"].join("\n"),a=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),s={float:"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])",int:"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},l={float:"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)",int:"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"};e.exports=function(e,t){var o={data:{}};o.gl=e;for(var a=Object.keys(t),s=0;s<a.length;s++){var l=a[s],c=l.split("."),u=c[c.length-1],h=r(c,o),d=t[l];h.data[u]=d,h.gl=e,Object.defineProperty(h,u,{get:n(u),set:i(u,d)})}return o}},function(e,t){e.exports="precision highp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nvarying vec2 vTextureCoord;\nvoid main(void)\n{\n    gl_Position = vec4(aVertexPosition, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}\n"},function(e,t,n){var i,r,o;!function(n,a){"use strict";r=[t],void 0===(o="function"==typeof(i=a)?i.apply(t,r):i)||(e.exports=o);var s={};n.PubSub=s,a(s)}("object"==typeof window&&window||this,function(e){"use strict";var t={},n=-1;function i(e){var t;for(t in e)if(e.hasOwnProperty(t))return!0;return!1}function r(e,t,n){try{e(t,n)}catch(e){setTimeout(function(e){return function(){throw e}}(e),0)}}function o(e,t,n){e(t,n)}function a(e,n,i,a){var s,l=t[n],c=a?o:r;if(t.hasOwnProperty(n))for(s in l)l.hasOwnProperty(s)&&c(l[s],e,i)}function s(e,n,r,o){var s=function(e,t,n){return function(){var i=String(e),r=i.lastIndexOf(".");for(a(e,e,t,n);-1!==r;)r=(i=i.substr(0,r)).lastIndexOf("."),a(e,i,t,n)}}(e,n,o);return!!function(e){for(var n=String(e),r=Boolean(t.hasOwnProperty(n)&&i(t[n])),o=n.lastIndexOf(".");!r&&-1!==o;)o=(n=n.substr(0,o)).lastIndexOf("."),r=Boolean(t.hasOwnProperty(n)&&i(t[n]));return r}(e)&&(!0===r?s():setTimeout(s,0),!0)}e.publish=function(t,n){return s(t,n,!1,e.immediateExceptions)},e.publishSync=function(t,n){return s(t,n,!0,e.immediateExceptions)},e.subscribe=function(e,i){if("function"!=typeof i)return!1;t.hasOwnProperty(e)||(t[e]={});var r="uid_"+String(++n);return t[e][r]=i,r},e.clearAllSubscriptions=function(){t={}},e.clearSubscriptions=function(e){var n;for(n in t)t.hasOwnProperty(n)&&0===n.indexOf(e)&&delete t[n]},e.unsubscribe=function(n){var i,r,o,a="string"==typeof n&&(t.hasOwnProperty(n)||function(e){var n;for(n in t)if(t.hasOwnProperty(n)&&0===n.indexOf(e))return!0;return!1}(n)),s=!a&&"string"==typeof n,l="function"==typeof n,c=!1;if(!a){for(i in t)if(t.hasOwnProperty(i)){if(r=t[i],s&&r[n]){delete r[n],c=n;break}if(l)for(o in r)r.hasOwnProperty(o)&&r[o]===n&&(delete r[o],c=!0)}return c}e.clearSubscriptions(n)}})},function(e,t,n){"use strict";e.exports=function(e,t,n,i){for(var r=65535&e|0,o=e>>>16&65535|0,a=0;0!==n;){n-=a=n>2e3?2e3:n;do{o=o+(r=r+t[i++]|0)|0}while(--a);r%=65521,o%=65521}return r|o<<16|0}},function(e,t,n){"use strict";var i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();e.exports=function(e,t,n,r){var o=i,a=r+n;e^=-1;for(var s=r;s<a;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}},function(e,t,n){"use strict";var i=n(3),r=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var a=new i.Buf8(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&o||!e.subarray&&r))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n="",a=0;a<t;a++)n+=String.fromCharCode(e[a]);return n}a[254]=a[254]=1,t.string2buf=function(e){var t,n,r,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new i.Buf8(l),a=0,o=0;a<l;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},t.buf2binstring=function(e){return l(e,e.length)},t.binstring2buf=function(e){for(var t=new i.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t},t.buf2string=function(e,t){var n,i,r,o,s=t||e.length,c=new Array(2*s);for(i=0,n=0;n<s;)if((r=e[n++])<128)c[i++]=r;else if((o=a[r])>4)c[i++]=65533,n+=o-1;else{for(r&=2===o?31:3===o?15:7;o>1&&n<s;)r=r<<6|63&e[n++],o--;o>1?c[i++]=65533:r<65536?c[i++]=r:(r-=65536,c[i++]=55296|r>>10&1023,c[i++]=56320|1023&r)}return l(c,i)},t.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0?t:0===n?t:n+a[e[n]]>t?n:t}},function(e,t,n){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t){var n=Array.prototype.slice;function i(e){var t=this;return"function"==typeof e&&(e=e.call(this)),n();function n(t){var n;try{n=e.next(t)}catch(e){return Promise.reject(e)}return a(n)}function i(t){var n;try{n=e.throw(t)}catch(e){return Promise.reject(e)}return a(n)}function a(e){if(e.done)return Promise.resolve(e.value);var a=r.call(t,e.value);return a&&o(a)?a.then(n,i):i(new TypeError('You may only yield a function, promise, generator, array, or object, but the following object was passed: "'+String(e.value)+'"'))}}function r(e){return e?o(e)?e:function(e){var t=e.constructor;return t&&"GeneratorFunction"==t.name}(e)||function(e){return"function"==typeof e.next&&"function"==typeof e.throw}(e)?i.call(this,e):"function"==typeof e?function(e){var t=this;return new Promise(function(i,r){e.call(t,function(e,t){if(e)return r(e);arguments.length>2&&(t=n.call(arguments,1)),i(t)})})}.call(this,e):Array.isArray(e)?function(e){return Promise.all(e.map(r,this))}.call(this,e):function(e){return Object==e.constructor}(e)?function(e){for(var t=new e.constructor,n=Object.keys(e),i=[],a=0;a<n.length;a++){var s=n[a],l=r.call(this,e[s]);l&&o(l)?c(l,s):t[s]=e[s]}return Promise.all(i).then(function(){return t});function c(e,n){t[n]=void 0,i.push(e.then(function(e){t[n]=e}))}}.call(this,e):e:e}function o(e){return"function"==typeof e.then}e.exports=i,i.wrap=function(e){return function(){return i.call(this,e.apply(this,arguments))}}},,,function(e,t,n){(function(t){var n,i=t.crypto||t.msCrypto;if(i&&i.getRandomValues){var r=new Uint8Array(16);n=function(){return i.getRandomValues(r),r}}if(!n){var o=new Array(16);n=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}e.exports=n}).call(this,n(7))},function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,r=n;return r[e[i++]]+r[e[i++]]+r[e[i++]]+r[e[i++]]+"-"+r[e[i++]]+r[e[i++]]+"-"+r[e[i++]]+r[e[i++]]+"-"+r[e[i++]]+r[e[i++]]+"-"+r[e[i++]]+r[e[i++]]+r[e[i++]]+r[e[i++]]+r[e[i++]]+r[e[i++]]}},function(e,t,n){"use strict";const i=n(41),r=n(16),o=n(17),a=Symbol("cache"),s=Symbol("defaultMethod"),l=Symbol("methods"),c=Symbol("noNext");e.exports=function(e){function t(){return!t[l].length&&t[s]?t[s].func.apply(this,arguments):t.applyGenfun(this,arguments)}return Object.setPrototypeOf(t,u.prototype),t[l]=[],t[a]={key:[],methods:[],state:h.UNINITIALIZED},e&&"function"==typeof e?t.add(e):e&&e.default&&t.add(e.default),e&&e.name&&Object.defineProperty(t,"name",{value:e.name}),e&&e.noNextMethod&&(t[c]=!0),t};class u extends Function{}u.prototype.isGenfun=!0;const h={UNINITIALIZED:0,MONOMORPHIC:1,POLYMORPHIC:2,MEGAMORPHIC:3},d=32;function p(e,t){var n=o.dispatchableObject(t);if(Object.hasOwnProperty.call(n,r.roleKeyName))for(var i=0;i<n[r.roleKeyName].length;i++){if(n[r.roleKeyName][i].method.genfun===e)return null}return Object.getPrototypeOf(n)}function f(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}u.prototype.add=function(e,t){t||"function"!=typeof e||(t=e,e=[]),e=[].slice.call(e);for(var n=0;n<e.length;n++)e.hasOwnProperty(n)||(e[n]=Object.prototype);this[a]={key:[],methods:[],state:h.UNINITIALIZED};let r=new i(this,e,t);return e.length?this[l].push(r):this[s]=r,this},u.prototype.rm=function(){throw new Error("not yet implemented")},u.prototype.hasMethod=function(){const e=this.getApplicableMethods(arguments);return!(!e||!e.length)},e.exports.noApplicableMethod=e.exports(),e.exports.noApplicableMethod.add([],(e,t,n)=>{let i="No applicable method found when called with arguments of types: ("+[].map.call(n,e=>/\[object ([a-zA-Z0-9]+)\]/.exec({}.toString.call(e))[1]).join(", ")+")",r=new Error(i);throw r.genfun=e,r.thisArg=t,r.args=n,r}),u.prototype.applyGenfun=function(t,n){let i=this.getApplicableMethods(n);if(1===i.length||this[c])return i[0].func.apply(t,n);if(i.length>1){let e=0;const r=function r(){arguments.length&&(n=arguments,Array.prototype.push.call(n,r));const o=i[e++];return e>=i.length&&Array.prototype.pop.call(n),o.func.apply(t,n)};return Array.prototype.push.call(n,r),r()}return e.exports.noApplicableMethod(this,t,n)},u.prototype.getApplicableMethods=function(e){if(!e.length||!this[l].length)return this[s]?[this[s]]:[];let t,n=function(e,t){if(e[a].state===h.UNINITIALIZED||e[a].state===h.MEGAMORPHIC)return null;for(var n,i=[],r=0;r<t.length;r++){if(!(n=p(e,t[r])))return;i[r]=n}for(r=0;r<e[a].key.length;r++)if(f(e[a].key[r],i))return e[a].methods[r]}(this,e);return n?t=n:(t=function(e,t){let n=[];(t=[].slice.call(t)).forEach((t,a)=>{(function(e){var t=[],n=e;for(;n;)t.push(n),n=Object.getPrototypeOf(n);return t})(o.dispatchableObject(t)).forEach((t,s)=>{!function(t,a,s){(Object.hasOwnProperty.call(t,r.roleKeyName)?t[r.roleKeyName]:[]).forEach(t=>{t.method.genfun===e&&s===t.position&&(n.indexOf(t.method)<0&&(i.clearRank(t.method),n.push(t.method)),i.setRankHierarchyPosition(t.method,s,a))}),o.isObjectProto(t)&&n.forEach(e=>{e.minimalSelector<=s&&i.setRankHierarchyPosition(e,s,a)})}(t,s,a)})});let a=n.filter(e=>t.length===e._rank.length&&i.isFullySpecified(e));a.sort((e,t)=>i.score(e)-i.score(t)),e[s]&&a.push(e[s]);return a}(this,e),function(e,t,n){if(e[a].state===h.MEGAMORPHIC)return;for(var i,r=[],o=0;o<t.length;o++){if(!(i=p(e,t[o])))return null;r[o]=i}e[a].key.unshift(r),e[a].methods.unshift(n),1===e[a].key.length?e[a].state=h.MONOMORPHIC:e[a].key.length<d?e[a].state=h.POLYMORPHIC:e[a].state=h.MEGAMORPHIC}(this,e,t)),t}},function(e,t,n){"use strict";const i=n(16),r=n(17);function o(e,t,n){this.genfun=e,this.func=n,this._rank=[],this.minimalSelector=0;const o=t.length?t:[Object.prototype];for(var a,s=o.length-1;s>=0;s--)a=Object.hasOwnProperty.call(o,s)?o[s]:Object.prototype,"function"!=typeof(a=r.dispatchableObject(a))||a.isGenfun||(a=a.prototype),s>0&&!this.minimalSelector&&r.isObjectProto(a)||(this.minimalSelector++,Object.hasOwnProperty.call(a,i.roleKeyName)||(Object.defineProperty?Object.defineProperty(a,i.roleKeyName,{value:[],enumerable:!1}):a[i.roleKeyName]=[]),a[i.roleKeyName].unshift(new i(this,s)))}e.exports=o,o.setRankHierarchyPosition=((e,t,n)=>{e._rank[t]=n}),o.clearRank=(e=>{e._rank=[]}),o.isFullySpecified=(e=>{for(var t=0;t<e.minimalSelector;t++)if(!e._rank.hasOwnProperty(t))return!1;return!0}),o.score=(e=>e._rank.reduce((e,t)=>e+t,0))},function(e,t,n){var i=n(43),r=Array.prototype.slice,o=Object.prototype.hasOwnProperty,a=e.exports=u;function s(e,t){return i.isUndefined(t)?""+t:i.isNumber(t)&&!isFinite(t)?t.toString():i.isFunction(t)||i.isRegExp(t)?t.toString():t}function l(e,t){return i.isString(e)?e.length<t?e:e.slice(0,t):e}function c(e,t,n,i,r){throw new a.AssertionError({message:n,actual:e,expected:t,operator:i,stackStartFunction:r})}function u(e,t){e||c(e,!0,t,"==",a.ok)}function h(e,t){if(e===t)return!0;if(i.isBuffer(e)&&i.isBuffer(t)){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return i.isDate(e)&&i.isDate(t)?e.getTime()===t.getTime():i.isRegExp(e)&&i.isRegExp(t)?e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase:i.isObject(e)||i.isObject(t)?function(e,t){if(i.isNullOrUndefined(e)||i.isNullOrUndefined(t))return!1;if(e.prototype!==t.prototype)return!1;if(i.isPrimitive(e)||i.isPrimitive(t))return e===t;var n=d(e),o=d(t);if(n&&!o||!n&&o)return!1;if(n)return e=r.call(e),t=r.call(t),h(e,t);var a,s,l=g(e),c=g(t);if(l.length!=c.length)return!1;for(l.sort(),c.sort(),s=l.length-1;s>=0;s--)if(l[s]!=c[s])return!1;for(s=l.length-1;s>=0;s--)if(a=l[s],!h(e[a],t[a]))return!1;return!0}(e,t):e==t}function d(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function p(e,t){return!(!e||!t)&&("[object RegExp]"==Object.prototype.toString.call(t)?t.test(e):e instanceof t||!0===t.call({},e))}function f(e,t,n,r){var o;i.isString(n)&&(r=n,n=null);try{t()}catch(e){o=e}if(r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!o&&c(o,n,"Missing expected exception"+r),!e&&p(o,n)&&c(o,n,"Got unwanted exception"+r),e&&o&&n&&!p(o,n)||!e&&o)throw o}a.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return l(JSON.stringify(e.actual,s),128)+" "+e.operator+" "+l(JSON.stringify(e.expected,s),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||c;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var i=n.stack,r=t.name,o=i.indexOf("\n"+r);if(o>=0){var a=i.indexOf("\n",o+1);i=i.substring(a+1)}this.stack=i}}},i.inherits(a.AssertionError,Error),a.fail=c,a.ok=u,a.equal=function(e,t,n){e!=t&&c(e,t,n,"==",a.equal)},a.notEqual=function(e,t,n){e==t&&c(e,t,n,"!=",a.notEqual)},a.deepEqual=function(e,t,n){h(e,t)||c(e,t,n,"deepEqual",a.deepEqual)},a.notDeepEqual=function(e,t,n){h(e,t)&&c(e,t,n,"notDeepEqual",a.notDeepEqual)},a.strictEqual=function(e,t,n){e!==t&&c(e,t,n,"===",a.strictEqual)},a.notStrictEqual=function(e,t,n){e===t&&c(e,t,n,"!==",a.notStrictEqual)},a.throws=function(e,t,n){f.apply(this,[!0].concat(r.call(arguments)))},a.doesNotThrow=function(e,t){f.apply(this,[!1].concat(r.call(arguments)))},a.ifError=function(e){if(e)throw e};var g=Object.keys||function(e){var t=[];for(var n in e)o.call(e,n)&&t.push(n);return t}},function(e,t,n){(function(e,i){var r=/%[sdj%]/g;t.format=function(e){if(!m(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var i=arguments,o=i.length,a=String(e).replace(r,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return e}}),l=i[n];n<o;l=i[++n])g(l)||!y(l)?a+=" "+l:a+=" "+s(l);return a},t.deprecate=function(n,r){if(v(e.process))return function(){return t.deprecate(n,r).apply(this,arguments)};if(!0===i.noDeprecation)return n;var o=!1;return function(){if(!o){if(i.throwDeprecation)throw new Error(r);i.traceDeprecation?console.trace(r):console.error(r),o=!0}return n.apply(this,arguments)}};var o,a={};function s(e,n){var i={seen:[],stylize:c};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),f(n)?i.showHidden=n:n&&t._extend(i,n),v(i.showHidden)&&(i.showHidden=!1),v(i.depth)&&(i.depth=2),v(i.colors)&&(i.colors=!1),v(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=l),u(i,e,i.depth)}function l(e,t){var n=s.styles[t];return n?"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m":e}function c(e,t){return e}function u(e,n,i){if(e.customInspect&&n&&E(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var r=n.inspect(i,e);return m(r)||(r=u(e,r,i)),r}var o=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(m(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(A(t))return e.stylize(""+t,"number");if(f(t))return e.stylize(""+t,"boolean");if(g(t))return e.stylize("null","null")}(e,n);if(o)return o;var a=Object.keys(n),s=function(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),S(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(n);if(0===a.length){if(E(n)){var l=n.name?": "+n.name:"";return e.stylize("[Function"+l+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return e.stylize(Date.prototype.toString.call(n),"date");if(S(n))return h(n)}var c,y="",_=!1,R=["{","}"];(p(n)&&(_=!0,R=["[","]"]),E(n))&&(y=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(y=" "+RegExp.prototype.toString.call(n)),w(n)&&(y=" "+Date.prototype.toUTCString.call(n)),S(n)&&(y=" "+h(n)),0!==a.length||_&&0!=n.length?i<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),c=_?function(e,t,n,i,r){for(var o=[],a=0,s=t.length;a<s;++a)C(t,String(a))?o.push(d(e,t,n,i,String(a),!0)):o.push("");return r.forEach(function(r){r.match(/^\d+$/)||o.push(d(e,t,n,i,r,!0))}),o}(e,n,i,s,a):a.map(function(t){return d(e,n,i,s,t,_)}),e.seen.pop(),function(e,t,n){if(e.reduce(function(e,t){return 0,t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(c,y,R)):R[0]+y+R[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,i,r,o){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),C(i,r)||(a="["+r+"]"),s||(e.seen.indexOf(l.value)<0?(s=g(n)?u(e,l.value,null):u(e,l.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),v(a)){if(o&&r.match(/^\d+$/))return s;(a=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function p(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function g(e){return null===e}function A(e){return"number"==typeof e}function m(e){return"string"==typeof e}function v(e){return void 0===e}function b(e){return y(e)&&"[object RegExp]"===_(e)}function y(e){return"object"==typeof e&&null!==e}function w(e){return y(e)&&"[object Date]"===_(e)}function S(e){return y(e)&&("[object Error]"===_(e)||e instanceof Error)}function E(e){return"function"==typeof e}function _(e){return Object.prototype.toString.call(e)}function R(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(v(o)&&(o=i.env.NODE_DEBUG||""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(o)){var n=i.pid;a[e]=function(){var i=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,i)}}else a[e]=function(){};return a[e]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=f,t.isNull=g,t.isNullOrUndefined=function(e){return null==e},t.isNumber=A,t.isString=m,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=v,t.isRegExp=b,t.isObject=y,t.isDate=w,t.isError=S,t.isFunction=E,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(45);var x=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",function(){var e=new Date,t=[R(e.getHours()),R(e.getMinutes()),R(e.getSeconds())].join(":");return[e.getDate(),x[e.getMonth()],t].join(" ")}(),t.format.apply(t,arguments))},t.inherits=n(46),t._extend=function(e,t){if(!t||!y(t))return e;for(var n=Object.keys(t),i=n.length;i--;)e[n[i]]=t[n[i]];return e}}).call(this,n(7),n(44))},function(e,t){var n,i,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var l,c=[],u=!1,h=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&p())}function p(){if(!u){var e=s(d);u=!0;for(var t=c.length;t;){for(l=c,c=[];++h<t;)l&&l[h].run();h=-1,t=c.length}l=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||u||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){"use strict";e.exports=function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,n){"use strict";var i=n(2),r=n(4),o=n(9);t.clone=function(e){var t=e.dtype;"generic"!==t&&"array"!==t||(t="double");var n=o.malloc(e.size,t),a=i(n,e.shape);return r.assign(a,e),a},t.malloc=function(e,t){t||(t="double");for(var n=1,r=new Array(e.length),a=e.length-1;a>=0;--a)r[a]=n,n*=e[a];return i(o.malloc(n,t),e,r,0)},t.free=function(e){o.free(e.data)}},function(e,t,n){"use strict";var i=n(51);e.exports=function(e){var t=new function(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1};t.pre=e.pre,t.body=e.body,t.post=e.post;var n=e.args.slice(0);t.argTypes=n;for(var r=0;r<n.length;++r){var o=n[r];if("array"===o||"object"==typeof o&&o.blockIndices){if(t.argTypes[r]="array",t.arrayArgs.push(r),t.arrayBlockIndices.push(o.blockIndices?o.blockIndices:0),t.shimArgs.push("array"+r),r<t.pre.args.length&&t.pre.args[r].count>0)throw new Error("cwise: pre() block may not reference array args");if(r<t.post.args.length&&t.post.args[r].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===o)t.scalarArgs.push(r),t.shimArgs.push("scalar"+r);else if("index"===o){if(t.indexArgs.push(r),r<t.pre.args.length&&t.pre.args[r].count>0)throw new Error("cwise: pre() block may not reference array index");if(r<t.body.args.length&&t.body.args[r].lvalue)throw new Error("cwise: body() block may not write to array index");if(r<t.post.args.length&&t.post.args[r].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===o){if(t.shapeArgs.push(r),r<t.pre.args.length&&t.pre.args[r].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(r<t.body.args.length&&t.body.args[r].lvalue)throw new Error("cwise: body() block may not write to array shape");if(r<t.post.args.length&&t.post.args[r].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof o||!o.offset)throw new Error("cwise: Unknown argument type "+n[r]);t.argTypes[r]="offset",t.offsetArgs.push({array:o.array,offset:o.offset}),t.offsetArgIndex.push(r)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,i(t)}},function(e,t,n){"use strict";var i=n(52);e.exports=function(e){var t=["'use strict'","var CACHED={}"],n=[],r=e.funcName+"_cwise_thunk";t.push(["return function ",r,"(",e.shimArgs.join(","),"){"].join(""));for(var o=[],a=[],s=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")],l=[],c=[],u=0;u<e.arrayArgs.length;++u){var h=e.arrayArgs[u];n.push(["t",h,"=array",h,".dtype,","r",h,"=array",h,".order"].join("")),o.push("t"+h),o.push("r"+h),a.push("t"+h),a.push("r"+h+".join()"),s.push("array"+h+".data"),s.push("array"+h+".stride"),s.push("array"+h+".offset|0"),u>0&&(l.push("array"+e.arrayArgs[0]+".shape.length===array"+h+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[u]))),c.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+h+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[u])+"]"))}for(e.arrayArgs.length>1&&(t.push("if (!("+l.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),t.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}")),u=0;u<e.scalarArgs.length;++u)s.push("scalar"+e.scalarArgs[u]);return n.push(["type=[",a.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),t.push("var "+n.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",s.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------"),new Function("compile",t.join("\n"))(i.bind(void 0,e))}},function(e,t,n){"use strict";var i=n(53);function r(e,t,n){var i,r,o=e.length,a=t.arrayArgs.length,s=t.indexArgs.length>0,l=[],c=[],u=0,h=0;for(i=0;i<o;++i)c.push(["i",i,"=0"].join(""));for(r=0;r<a;++r)for(i=0;i<o;++i)h=u,u=e[i],0===i?c.push(["d",r,"s",i,"=t",r,"p",u].join("")):c.push(["d",r,"s",i,"=(t",r,"p",u,"-s",h,"*t",r,"p",h,")"].join(""));for(c.length>0&&l.push("var "+c.join(",")),i=o-1;i>=0;--i)u=e[i],l.push(["for(i",i,"=0;i",i,"<s",u,";++i",i,"){"].join(""));for(l.push(n),i=0;i<o;++i){for(h=u,u=e[i],r=0;r<a;++r)l.push(["p",r,"+=d",r,"s",i].join(""));s&&(i>0&&l.push(["index[",h,"]-=s",h].join("")),l.push(["++index[",u,"]"].join(""))),l.push("}")}return l.join("\n")}function o(e,t,n){for(var i=e.body,r=[],o=[],a=0;a<e.args.length;++a){var s=e.args[a];if(!(s.count<=0)){var l=new RegExp(s.name,"g"),c="",u=t.arrayArgs.indexOf(a);switch(t.argTypes[a]){case"offset":var h=t.offsetArgIndex.indexOf(a);u=t.offsetArgs[h].array,c="+q"+h;case"array":c="p"+u+c;var d="l"+a,p="a"+u;if(0===t.arrayBlockIndices[u])1===s.count?"generic"===n[u]?s.lvalue?(r.push(["var ",d,"=",p,".get(",c,")"].join("")),i=i.replace(l,d),o.push([p,".set(",c,",",d,")"].join(""))):i=i.replace(l,[p,".get(",c,")"].join("")):i=i.replace(l,[p,"[",c,"]"].join("")):"generic"===n[u]?(r.push(["var ",d,"=",p,".get(",c,")"].join("")),i=i.replace(l,d),s.lvalue&&o.push([p,".set(",c,",",d,")"].join(""))):(r.push(["var ",d,"=",p,"[",c,"]"].join("")),i=i.replace(l,d),s.lvalue&&o.push([p,"[",c,"]=",d].join("")));else{for(var f=[s.name],g=[c],A=0;A<Math.abs(t.arrayBlockIndices[u]);A++)f.push("\\s*\\[([^\\]]+)\\]"),g.push("$"+(A+1)+"*t"+u+"b"+A);if(l=new RegExp(f.join(""),"g"),c=g.join("+"),"generic"===n[u])throw new Error("cwise: Generic arrays not supported in combination with blocks!");i=i.replace(l,[p,"[",c,"]"].join(""))}break;case"scalar":i=i.replace(l,"Y"+t.scalarArgs.indexOf(a));break;case"index":i=i.replace(l,"index");break;case"shape":i=i.replace(l,"shape")}}}return[r.join("\n"),i,o.join("\n")].join("\n").trim()}e.exports=function(e,t){for(var n=t[1].length-Math.abs(e.arrayBlockIndices[0])|0,a=new Array(e.arrayArgs.length),s=new Array(e.arrayArgs.length),l=0;l<e.arrayArgs.length;++l)s[l]=t[2*l],a[l]=t[2*l+1];var c=[],u=[],h=[],d=[],p=[];for(l=0;l<e.arrayArgs.length;++l){e.arrayBlockIndices[l]<0?(h.push(0),d.push(n),c.push(n),u.push(n+e.arrayBlockIndices[l])):(h.push(e.arrayBlockIndices[l]),d.push(e.arrayBlockIndices[l]+n),c.push(0),u.push(e.arrayBlockIndices[l]));for(var f=[],g=0;g<a[l].length;g++)h[l]<=a[l][g]&&a[l][g]<d[l]&&f.push(a[l][g]-h[l]);p.push(f)}var A=["SS"],m=["'use strict'"],v=[];for(g=0;g<n;++g)v.push(["s",g,"=SS[",g,"]"].join(""));for(l=0;l<e.arrayArgs.length;++l){for(A.push("a"+l),A.push("t"+l),A.push("p"+l),g=0;g<n;++g)v.push(["t",l,"p",g,"=t",l,"[",h[l]+g,"]"].join(""));for(g=0;g<Math.abs(e.arrayBlockIndices[l]);++g)v.push(["t",l,"b",g,"=t",l,"[",c[l]+g,"]"].join(""))}for(l=0;l<e.scalarArgs.length;++l)A.push("Y"+l);if(e.shapeArgs.length>0&&v.push("shape=SS.slice(0)"),e.indexArgs.length>0){var b=new Array(n);for(l=0;l<n;++l)b[l]="0";v.push(["index=[",b.join(","),"]"].join(""))}for(l=0;l<e.offsetArgs.length;++l){var y=e.offsetArgs[l],w=[];for(g=0;g<y.offset.length;++g)0!==y.offset[g]&&(1===y.offset[g]?w.push(["t",y.array,"p",g].join("")):w.push([y.offset[g],"*t",y.array,"p",g].join("")));0===w.length?v.push("q"+l+"=0"):v.push(["q",l,"=",w.join("+")].join(""))}var S=i([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));for((v=v.concat(S)).length>0&&m.push("var "+v.join(",")),l=0;l<e.arrayArgs.length;++l)m.push("p"+l+"|=0");e.pre.body.length>3&&m.push(o(e.pre,e,s));var E=o(e.body,e,s),_=function(e){for(var t=0,n=e[0].length;t<n;){for(var i=1;i<e.length;++i)if(e[i][t]!==e[0][t])return t;++t}return t}(p);_<n?m.push(function(e,t,n,i){for(var o=t.length,a=n.arrayArgs.length,s=n.blockSize,l=n.indexArgs.length>0,c=[],u=0;u<a;++u)c.push(["var offset",u,"=p",u].join(""));for(u=e;u<o;++u)c.push(["for(var j"+u+"=SS[",t[u],"]|0;j",u,">0;){"].join("")),c.push(["if(j",u,"<",s,"){"].join("")),c.push(["s",t[u],"=j",u].join("")),c.push(["j",u,"=0"].join("")),c.push(["}else{s",t[u],"=",s].join("")),c.push(["j",u,"-=",s,"}"].join("")),l&&c.push(["index[",t[u],"]=j",u].join(""));for(u=0;u<a;++u){for(var h=["offset"+u],d=e;d<o;++d)h.push(["j",d,"*t",u,"p",t[d]].join(""));c.push(["p",u,"=(",h.join("+"),")"].join(""))}for(c.push(r(t,n,i)),u=e;u<o;++u)c.push("}");return c.join("\n")}(_,p[0],e,E)):m.push(r(p[0],e,E)),e.post.body.length>3&&m.push(o(e.post,e,s)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+m.join("\n")+"\n----------");var R=[e.funcName||"unnamed","_cwise_loop_",a[0].join("s"),"m",_,function(e){for(var t=new Array(e.length),n=!0,i=0;i<e.length;++i){var r=e[i],o=r.match(/\d+/);o=o?o[0]:"",0===r.charAt(0)?t[i]="u"+r.charAt(1)+o:t[i]=r.charAt(0)+o,i>0&&(n=n&&t[i]===t[i-1])}return n?t[0]:t.join("")}(s)].join("");return new Function(["function ",R,"(",A.join(","),"){",m.join("\n"),"} return ",R].join(""))()}},function(e,t,n){"use strict";e.exports=function(e,t,n){return 0===e.length?e:t?(n||e.sort(t),function(e,t){for(var n=1,i=e.length,r=e[0],o=e[0],a=1;a<i;++a)if(o=r,t(r=e[a],o)){if(a===n){n++;continue}e[n++]=r}return e.length=n,e}(e,t)):(n||e.sort(),function(e){for(var t=1,n=e.length,i=e[0],r=e[0],o=1;o<n;++o,r=i)if(r=i,(i=e[o])!==r){if(o===t){t++;continue}e[t++]=i}return e.length=t,e}(e))}},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var i=n(55),r=n(56),o=n(57);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return c(this,e,t,n)}function c(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=d(e,t);return e}(e,t,n,i):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|f(t,n),r=(e=s(e,i)).write(t,n);r!==i&&(e=e.slice(0,r));return e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|p(t.length);return 0===(e=s(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?s(e,0):d(e,t);if("Buffer"===t.type&&o(t.data))return d(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(u(t),e=s(e,t<0?0:0|p(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|p(t.length);e=s(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function p(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function f(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return F(e).length;default:if(i)return j(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function A(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:m(e,t,n,i,r);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,i,r){var o,a=1,s=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(r){var u=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*a}else-1!==u&&(o-=o-u),u=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){for(var h=!0,d=0;d<l;d++)if(c(e,o+d)!==c(t,d)){h=!1;break}if(h)return o}return-1}function v(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var a=0;a<i;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function b(e,t,n,i){return z(j(t,e.length-n),e,n,i)}function y(e,t,n,i){return z(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function w(e,t,n,i){return y(e,t,n,i)}function S(e,t,n,i){return z(F(t),e,n,i)}function E(e,t,n,i){return z(function(e,t){for(var n,i,r,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),i=n>>8,r=n%256,o.push(r),o.push(i);return o}(t,e.length-n),e,n,i)}function _(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function R(e,t,n){n=Math.min(e.length,n);for(var i=[],r=t;r<n;){var o,a,s,l,c=e[r],u=null,h=c>239?4:c>223?3:c>191?2:1;if(r+h<=n)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(o=e[r+1]))&&(l=(31&c)<<6|63&o)>127&&(u=l);break;case 3:o=e[r+1],a=e[r+2],128==(192&o)&&128==(192&a)&&(l=(15&c)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=e[r+1],a=e[r+2],s=e[r+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),r+=h}return function(e){var t=e.length;if(t<=x)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=x));return n}(i)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return c(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,i){return u(t),t<=0?s(e,t):void 0!==n?"string"==typeof i?s(e,t).fill(n,i):s(e,t).fill(n):s(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return h(null,e)},l.allocUnsafeSlow=function(e){return h(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,r=0,o=Math.min(n,i);r<o;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=l.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var a=e[n];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,r),r+=a.length}return i},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?R(this,0,e):function(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,n);case"utf8":case"utf-8":return R(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return I(this,t,n);case"base64":return _(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,i,r){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,i>>>=0,r>>>=0,this===e)return 0;for(var o=r-i,a=n-t,s=Math.min(o,a),c=this.slice(i,r),u=e.slice(t,n),h=0;h<s;++h)if(c[h]!==u[h]){o=c[h],a=u[h];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return A(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return A(this,e,t,n,!1)},l.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return y(this,e,t,n);case"latin1":case"binary":return w(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var x=4096;function C(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function I(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function T(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",o=t;o<n;++o)r+=V(e[o]);return r}function P(e,t,n){for(var i=e.slice(t,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function O(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function k(e,t,n,i,r,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<o)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function M(e,t,n,i){t<0&&(t=65535+t+1);for(var r=0,o=Math.min(e.length-n,2);r<o;++r)e[n+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function L(e,t,n,i){t<0&&(t=4294967295+t+1);for(var r=0,o=Math.min(e.length-n,4);r<o;++r)e[n+r]=t>>>8*(i?r:3-r)&255}function B(e,t,n,i,r,o){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(e,t,n,i,o){return o||B(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function N(e,t,n,i,o){return o||B(e,0,n,8),r.write(e,t,n,i,52,8),n+8}l.prototype.slice=function(e,t){var n,i=this.length;if(e=~~e,t=void 0===t?i:~~t,e<0?(e+=i)<0&&(e=0):e>i&&(e=i),t<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var r=t-e;n=new l(r,void 0);for(var o=0;o<r;++o)n[o]=this[o+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return i},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var i=this[e+--t],r=1;t>0&&(r*=256);)i+=this[e+--t]*r;return i},l.prototype.readUInt8=function(e,t){return t||O(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||O(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||O(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var i=t,r=1,o=this[e+--i];i>0&&(r*=256);)o+=this[e+--i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||O(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||O(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||O(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||O(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||O(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||O(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||k(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,o=0;for(this[t]=255&e;++o<n&&(r*=256);)this[t+o]=e/r&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||k(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,o=1;for(this[t+r]=255&e;--r>=0&&(o*=256);)this[t+r]=e/o&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);k(this,e,t,n,r-1,-r)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);k(this,e,t,n,r-1,-r)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return D(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return D(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return N(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return N(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r,o=i-n;if(this===e&&n<t&&t<i)for(r=o-1;r>=0;--r)e[r+t]=this[r+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},l.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=l.isBuffer(e)?e:j(new l(e,i).toString()),s=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function V(e){return e<16?"0"+e.toString(16):e.toString(16)}function j(e,t){var n;t=t||1/0;for(var i=e.length,r=null,o=[],a=0;a<i;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===i){(t-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function F(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(U,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function z(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}}).call(this,n(7))},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){for(var t,n=c(e),i=n[0],a=n[1],s=new o(function(e,t,n){return 3*(t+n)/4-n}(0,i,a)),l=0,u=a>0?i-4:i,h=0;h<u;h+=4)t=r[e.charCodeAt(h)]<<18|r[e.charCodeAt(h+1)]<<12|r[e.charCodeAt(h+2)]<<6|r[e.charCodeAt(h+3)],s[l++]=t>>16&255,s[l++]=t>>8&255,s[l++]=255&t;2===a&&(t=r[e.charCodeAt(h)]<<2|r[e.charCodeAt(h+1)]>>4,s[l++]=255&t);1===a&&(t=r[e.charCodeAt(h)]<<10|r[e.charCodeAt(h+1)]<<4|r[e.charCodeAt(h+2)]>>2,s[l++]=t>>8&255,s[l++]=255&t);return s},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,o=[],a=0,s=n-r;a<s;a+=16383)o.push(h(e,a,a+16383>s?s:a+16383));1===r?(t=e[n-1],o.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],o.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return o.join("")};for(var i=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)i[s]=a[s],r[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e){return i[e>>18&63]+i[e>>12&63]+i[e>>6&63]+i[63&e]}function h(e,t,n){for(var i,r=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),r.push(u(i));return r.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,i,r){var o,a,s=8*r-i-1,l=(1<<s)-1,c=l>>1,u=-7,h=n?r-1:0,d=n?-1:1,p=e[t+h];for(h+=d,o=p&(1<<-u)-1,p>>=-u,u+=s;u>0;o=256*o+e[t+h],h+=d,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=i;u>0;a=256*a+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,i),o-=c}return(p?-1:1)*a*Math.pow(2,o-i)},t.write=function(e,t,n,i,r,o){var a,s,l,c=8*o-r-1,u=(1<<c)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,f=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=u?(s=0,a=u):a+h>=1?(s=(t*l-1)*Math.pow(2,r),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,r),a=0));r>=8;e[n+p]=255&s,p+=f,s/=256,r-=8);for(a=a<<r|s,c+=r;c>0;e[n+p]=255&a,p+=f,a/=256,c-=8);e[n+p-f]|=128*g}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";"use restrict";function i(e){var t=32;return(e&=-e)&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}t.INT_BITS=32,t.INT_MAX=2147483647,t.INT_MIN=-1<<31,t.sign=function(e){return(e>0)-(e<0)},t.abs=function(e){var t=e>>31;return(e^t)-t},t.min=function(e,t){return t^(e^t)&-(e<t)},t.max=function(e,t){return e^(e^t)&-(e<t)},t.isPow2=function(e){return!(e&e-1||!e)},t.log2=function(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1},t.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},t.popCount=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},t.countTrailingZeros=i,t.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1},t.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)-(e>>>1)},t.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,27030>>>(e&=15)&1};var r=new Array(256);!function(e){for(var t=0;t<256;++t){var n=t,i=t,r=7;for(n>>>=1;n;n>>>=1)i<<=1,i|=1&n,--r;e[t]=i<<r&255}}(r),t.reverse=function(e){return r[255&e]<<24|r[e>>>8&255]<<16|r[e>>>16&255]<<8|r[e>>>24&255]},t.interleave2=function(e,t){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))<<1},t.deinterleave2=function(e,t){return(e=65535&((e=16711935&((e=252645135&((e=858993459&((e=e>>>t&1431655765)|e>>>1))|e>>>2))|e>>>4))|e>>>16))<<16>>16},t.interleave3=function(e,t,n){return e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2),(e|=(t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},t.deinterleave3=function(e,t){return(e=1023&((e=4278190335&((e=251719695&((e=3272356035&((e=e>>>t&1227133513)|e>>>2))|e>>>4))|e>>>8))|e>>>16))<<22>>22},t.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>i(e)+1}},function(e,t,n){"use strict";e.exports=function(e,t){switch(void 0===t&&(t=0),typeof e){case"number":if(e>0)return function(e,t){var n,i;for(n=new Array(e),i=0;i<e;++i)n[i]=t;return n}(0|e,t);break;case"object":if("number"==typeof e.length)return function e(t,n,i){var r=0|t[i];if(r<=0)return[];var o,a=new Array(r);if(i===t.length-1)for(o=0;o<r;++o)a[o]=n;else for(o=0;o<r;++o)a[o]=e(t,n,i+1);return a}(e,t,0)}return[]}},function(e,t,n){"use strict";var i=n(2);e.exports=function(e,t){var n,r;if(void 0!==t&&(!Number.isFinite(t)||t%1!==t))throw new Error("axis of dimension to unsqueeze must be an integer");return t=void 0===t?e.shape.length:t,n=e.shape.slice(0),r=e.stride.slice(0),n.splice(t||0,0,1),r.splice(t||0,0,(r[t]||1)*(n[t+1]||1)),i(e.data,n,r,e.offset)}},function(e,t,n){"use strict";e.exports=function(){var e,t,n,s,l,c,u,h,d,p,f;if(s=i({},a),0===arguments.length)throw new Error("Array of ndarrays to concatenate must not be empty");Array.isArray(arguments[0])?(n=arguments[0],i(s,arguments[1]||{})):2===arguments.length&&(n=arguments[1],e=arguments[0],i(s,arguments[2]||{}));if(0===n.length)throw new Error("Array of ndarrays to concatenate must not be empty");if(1===n[0].dimension){for(u=[n[0].shape[0],n.length],c=0;c<n.length;c++){if(1!==(t=n[c]).dimension)throw new Error("all arrays must have the same dimensionality");if(t.shape[0]!==u[0])throw new Error("last n-1 dimensions of concatenated columns must have the same size")}if(e){if(u[1]!==e.shape[1]||u[0]!==e.shape[0])throw new Error("dimensions of output array must match dimension of concatenated columns")}else e=o.zeros(u,s.dtype);for(c=0;c<n.length;c++)r.assign(e.pick(null,c),n[c]);return e}for(l=0;l<n.length;l++)if(u){for(c=0;c<n[l].shape.length-1;c++)if(n[l].shape[c]!==u[c])throw new Error("last n-1 dimensions of concatenated columns must have the same size");if(n[l].dimension!==u.length)throw new Error("all arrays must have the same dimensionality");for(c=0;c<n[l].shape.length-1;c++)if(n[l].shape[c]!==u[c])throw new Error("last n-1 dimensions of concatenated columns must have the same size");u[u.length-1]+=n[l].shape[u.length-1]}else u=n[l].shape.slice(0);if(e){if(u[0]!==e.shape[0])throw new Error("first dimension of output array must match the total number of concatenated columns")}else e=o.zeros(u,s.dtype);for(p=new Array(u.length),f=new Array(u.length),c=0;c<u.length-1;c++)p[c]=0,f[c]=u[c];for(d=u.length-1,c=0,p[d]=0,f[d]=0;c<n.length;c++)t=n[c],f[d]=t.shape[d],h=(h=e.lo.apply(e,p)).hi.apply(h,f),r.assign(h,t),p[d]+=f[d];return e};var i=n(18),r=n(4),o=n(62),a={dtype:"double"}},function(e,t,n){"use strict";var i=n(2),r=n(4),o=n(9);t.clone=function(e){var t=e.dtype;"generic"!==t&&"array"!==t||(t="double");var n=o.malloc(e.size,t),a=i(n,e.shape);return r.assign(a,e),a},t.malloc=function(e,t){t||(t="double");for(var n=1,r=new Array(e.length),a=e.length-1;a>=0;--a)r[a]=n,n*=e[a];return i(o.malloc(n,t),e,r,0)},t.free=function(e){"generic"!==e.dtype&&"array"!==e.dtype&&o.free(e.data)},t.zeros=function(e,t){t||(t="double");for(var n=1,r=new Array(e.length),a=e.length-1;a>=0;--a)r[a]=n,n*=e[a];var s=o.malloc(n,t);for(a=0;a<n;++a)s[a]=0;return i(s,e,r,0)},t.ones=function(e,t){t||(t="double");for(var n=1,r=new Array(e.length),a=e.length-1;a>=0;--a)r[a]=n,n*=e[a];var s=o.malloc(n,t);for(a=0;a<n;++a)s[a]=1;return i(s,e,r,0)},t.eye=function(e,t){var n,r;t||(t="double");var a=1,s=new Array(e.length);for(n=e.length-1;n>=0;--n)s[n]=a,a*=e[n];var l=o.malloc(a,t);for(n=0;n<a;++n)l[n]=0;var c=1/0,u=0;for(n=e.length-1;n>=0;n--)u+=s[n],c=Math.min(c,e[n]);for(n=0,r=0;n<c;n++,r+=u)l[r]=1;return i(l,e,s,0)}},function(e,t,n){"use strict";e.exports=function(){var e,t,n,s,l,c,u,h,d,p;if(s=i({},a),0===arguments.length)throw new Error("Array of ndarrays to concatenate must not be empty");Array.isArray(arguments[0])?(n=arguments[0],i(s,arguments[1]||{})):2===arguments.length&&(n=arguments[1],e=arguments[0],i(s,arguments[2]||{}));if(0===n.length)throw new Error("Array of ndarrays to concatenate must not be empty");for(l=0;l<n.length;l++)if(u){if(n[l].dimension!==u.length)throw new Error("all arrays must have the same dimensionality");for(c=1;c<n[l].shape.length;c++)if(n[l].shape[c]!==u[c])throw new Error("last n-1 dimensions of concatenated rows must have the same size");u[0]+=n[l].shape[0]}else u=n[l].shape.slice(0);if(e){if(u[0]!==e.shape[0])throw new Error("first dimension of output array must match the total number of concatenated rows")}else e=o.zeros(u,s.dtype);for(c=0,h=0;c<n.length;c++)t=n[c],d=t.shape[0],p=e.lo(h).hi(d),r.assign(p,t),h+=d;return e};var i=n(18),r=n(4),o=n(64),a={dtype:"double"}},function(e,t,n){"use strict";var i=n(2),r=n(4),o=n(9);t.clone=function(e){var t=e.dtype;"generic"!==t&&"array"!==t||(t="double");var n=o.malloc(e.size,t),a=i(n,e.shape);return r.assign(a,e),a},t.malloc=function(e,t){t||(t="double");for(var n=1,r=new Array(e.length),a=e.length-1;a>=0;--a)r[a]=n,n*=e[a];return i(o.malloc(n,t),e,r,0)},t.free=function(e){"generic"!==e.dtype&&"array"!==e.dtype&&o.free(e.data)},t.zeros=function(e,t){t||(t="double");for(var n=1,r=new Array(e.length),a=e.length-1;a>=0;--a)r[a]=n,n*=e[a];var s=o.malloc(n,t);for(a=0;a<n;++a)s[a]=0;return i(s,e,r,0)},t.ones=function(e,t){t||(t="double");for(var n=1,r=new Array(e.length),a=e.length-1;a>=0;--a)r[a]=n,n*=e[a];var s=o.malloc(n,t);for(a=0;a<n;++a)s[a]=1;return i(s,e,r,0)},t.eye=function(e,t){var n,r;t||(t="double");var a=1,s=new Array(e.length);for(n=e.length-1;n>=0;--n)s[n]=a,a*=e[n];var l=o.malloc(a,t);for(n=0;n<a;++n)l[n]=0;var c=1/0,u=0;for(n=e.length-1;n>=0;n--)u+=s[n],c=Math.min(c,e[n]);for(n=0,r=0;n<c;n++,r+=u)l[r]=1;return i(l,e,s,0)}},function(e,t){e.exports=function(e,t){var n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);if(!n)throw new Error("This browser does not support webGL. Try using the canvas renderer");return n}},function(e,t){var n=new ArrayBuffer(0),i=function(e,t,i,r){this.gl=e,this.buffer=e.createBuffer(),this.type=t||e.ARRAY_BUFFER,this.drawType=r||e.STATIC_DRAW,this.data=n,i&&this.upload(i),this._updateID=0};i.prototype.upload=function(e,t,n){n||this.bind();var i=this.gl;e=e||this.data,t=t||0,this.data.byteLength>=e.byteLength?i.bufferSubData(this.type,t,e):i.bufferData(this.type,e,this.drawType),this.data=e},i.prototype.bind=function(){this.gl.bindBuffer(this.type,this.buffer)},i.createVertexBuffer=function(e,t,n){return new i(e,e.ARRAY_BUFFER,t,n)},i.createIndexBuffer=function(e,t,n){return new i(e,e.ELEMENT_ARRAY_BUFFER,t,n)},i.create=function(e,t,n,r){return new i(e,t,n,r)},i.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)},e.exports=i},function(e,t,n){var i=n(20),r=function(e,t,n){this.gl=e,this.framebuffer=e.createFramebuffer(),this.stencil=null,this.texture=null,this.width=t||100,this.height=n||100};r.prototype.enableTexture=function(e){var t=this.gl;this.texture=e||new i(t),this.texture.bind(),this.bind(),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture.texture,0)},r.prototype.enableStencil=function(){if(!this.stencil){var e=this.gl;this.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.stencil),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,this.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,this.width,this.height)}},r.prototype.clear=function(e,t,n,i){this.bind();var r=this.gl;r.clearColor(e,t,n,i),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT)},r.prototype.bind=function(){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer)},r.prototype.unbind=function(){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null)},r.prototype.resize=function(e,t){var n=this.gl;this.width=e,this.height=t,this.texture&&this.texture.uploadData(null,e,t),this.stencil&&(n.bindRenderbuffer(n.RENDERBUFFER,this.stencil),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,e,t))},r.prototype.destroy=function(){var e=this.gl;this.texture&&this.texture.destroy(),e.deleteFramebuffer(this.framebuffer),this.gl=null,this.stencil=null,this.texture=null},r.createRGBA=function(e,t,n,o){var a=i.fromData(e,null,t,n);a.enableNearestScaling(),a.enableWrapClamp();var s=new r(e,t,n);return s.enableTexture(a),s.unbind(),s},r.createFloat32=function(e,t,n,o){var a=new i.fromData(e,o,t,n);a.enableNearestScaling(),a.enableWrapClamp();var s=new r(e,t,n);return s.enableTexture(a),s.unbind(),s},e.exports=r},function(e,t,n){var i=n(21),r=n(22),o=n(24),a=n(26),s=n(27),l=function(e,t,n,l,c){this.gl=e,l&&(t=a(t,l),n=a(n,l)),this.program=i(e,t,n,c),this.attributes=r(e,this.program),this.uniformData=o(e,this.program),this.uniforms=s(e,this.uniformData)};l.prototype.bind=function(){this.gl.useProgram(this.program)},l.prototype.destroy=function(){this.attributes=null,this.uniformData=null,this.uniforms=null,this.gl.deleteProgram(this.program)},e.exports=l},function(e,t,n){var i=n(19);function r(e,t){if(this.nativeVaoExtension=null,r.FORCE_NATIVE||(this.nativeVaoExtension=e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object")),this.nativeState=t,this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var n=e.getParameter(e.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:new Array(n),attribState:new Array(n)}}this.gl=e,this.attributes=[],this.indexBuffer=null,this.dirty=!1}r.prototype.constructor=r,e.exports=r,r.FORCE_NATIVE=!1,r.prototype.bind=function(){return this.nativeVao?(this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.dirty&&(this.dirty=!1,this.activate())):this.activate(),this},r.prototype.unbind=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(null),this},r.prototype.activate=function(){for(var e=this.gl,t=null,n=0;n<this.attributes.length;n++){var r=this.attributes[n];t!==r.buffer&&(r.buffer.bind(),t=r.buffer),e.vertexAttribPointer(r.attribute.location,r.attribute.size,r.type||e.FLOAT,r.normalized||!1,r.stride||0,r.start||0)}return i(e,this.attributes,this.nativeState),this.indexBuffer&&this.indexBuffer.bind(),this},r.prototype.addAttribute=function(e,t,n,i,r,o){return this.attributes.push({buffer:e,attribute:t,location:t.location,type:n||this.gl.FLOAT,normalized:i||!1,stride:r||0,start:o||0}),this.dirty=!0,this},r.prototype.addIndex=function(e){return this.indexBuffer=e,this.dirty=!0,this},r.prototype.clear=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.attributes.length=0,this.indexBuffer=null,this},r.prototype.draw=function(e,t,n){var i=this.gl;return this.indexBuffer?i.drawElements(e,t||this.indexBuffer.data.length,i.UNSIGNED_SHORT,2*(n||0)):i.drawArrays(e,n,t||this.getSize()),this},r.prototype.destroy=function(){this.gl=null,this.indexBuffer=null,this.attributes=null,this.nativeState=null,this.nativeVao&&this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao),this.nativeVaoExtension=null,this.nativeVao=null},r.prototype.getSize=function(){var e=this.attributes[0];return e.buffer.data.length/(e.stride/4||e.attribute.size)}},function(e,t,n){e.exports={compileProgram:n(21),defaultValue:n(25),extractAttributes:n(22),extractUniforms:n(24),generateUniformAccessObject:n(27),setPrecision:n(26),mapSize:n(23),mapType:n(10)}},function(e,t){e.exports="precision highp float;\n\nattribute vec2 aVertexPosition;\nuniform vec2 bounds;\nuniform float uFourSigma;\nvoid main(void)\n{\n    vec2 xy = (aVertexPosition/bounds * vec2(2.0, -2.0)) + vec2(-1.0, 1.0);\n    gl_Position = vec4(xy, 0.0, 1.0);\n    gl_PointSize = uFourSigma;\n}\n"},function(e,t){e.exports="precision highp float;\n\n// Sampler for the kernel sprite\nuniform sampler2D u_KernelSampler;\n// Render into a float texture: RGBA where each is float32\nvoid main(void)\n{\n    vec4 color = texture2D(u_KernelSampler, gl_PointCoord);\n    int iCol = int(100.0*color.r);\n    gl_FragColor = vec4(float(iCol), float(iCol), float(iCol), 1.0);\n    //gl_FragColor = vec4 (1.0, 1.0, 1.0, 1.0);, // fixed color for texting\n}\n"},function(e,t){e.exports="precision highp float;\n\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n// Standard trick to pack a 32bit Float as IEEE encoding into 4 bytes of UByte RGBA\n// Taken from\n// http://stackoverflow.com/questions/17981163/webgl-read-pixels-from-floating-point-render-target\n// Originally from http://concord-consortium.github.io/lab/experiments/webgl-gpgpu/webgl.html\n// but other versions are available\nfloat shift_right (float v, float amt) {\n    v = floor(v) + 0.5;\n    return floor(v / exp2(amt));\n}\nfloat shift_left (float v, float amt) {\n    return floor(v * exp2(amt) + 0.5);\n}\nfloat mask_last (float v, float bits) {\n    return mod(v, shift_left(1.0, bits));\n}\nfloat extract_bits (float num, float from, float to) {\n    from = floor(from + 0.5); to = floor(to + 0.5);\n    return mask_last(shift_right(num, from), to - from);\n}\nvec4 encode_float (float val) {\n    if (val == 0.0) return vec4(0, 0, 0, 0);\n    float sign = val > 0.0 ? 0.0 : 1.0;\n    val = abs(val);\n    float exponent = floor(log2(val));\n    float biased_exponent = exponent + 127.0;\n    float fraction = ((val / exp2(exponent)) - 1.0) * 8388608.0;\n    float t = biased_exponent / 2.0;\n    float last_bit_of_biased_exponent = fract(t) * 2.0;\n    float remaining_bits_of_biased_exponent = floor(t);\n    float byte4 = extract_bits(fraction, 0.0, 8.0) / 255.0;\n    float byte3 = extract_bits(fraction, 8.0, 16.0) / 255.0;\n    float byte2 = (last_bit_of_biased_exponent * 128.0 + extract_bits(fraction, 16.0, 23.0)) / 255.0;\n    float byte1 = (sign * 128.0 + remaining_bits_of_biased_exponent) / 255.0;\n    return vec4(byte4, byte3, byte2, byte1);\n}\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = encode_float(color.r);\n}\n"},function(e,t){e.exports="precision highp float;\n\nuniform sampler2D uSampler;\nuniform float uRange;\nuniform int uLevels;\nvarying vec2 vTextureCoord;\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    // scale the big float color to something in the 0.0 - 1.0 range.\n    // discretize into levels\n    float fLevels = float(uLevels);\n    float grayLevel = float(int(fLevels * color.r/uRange))/fLevels;\n    gl_FragColor = vec4(grayLevel, grayLevel, grayLevel, 1.0);\n}\n"},function(e,t,n){var i={"./Accent.png":76,"./Blues.png":77,"./BrBG.png":78,"./BuGn.png":79,"./BuPu.png":80,"./CMRmap.png":81,"./Dark2.png":82,"./GnBu.png":83,"./Greens.png":84,"./Greys.png":85,"./OrRd.png":86,"./Oranges.png":87,"./PRGn.png":88,"./Paired.png":89,"./Pastel1.png":90,"./Pastel2.png":91,"./PiYG.png":92,"./PuBu.png":93,"./PuBuGn.png":94,"./PuOr.png":95,"./PuRd.png":96,"./Purples.png":97,"./RdBu.png":98,"./RdGy.png":99,"./RdPu.png":100,"./RdYlBu.png":101,"./RdYlGn.png":102,"./Reds.png":103,"./Set1.png":104,"./Set2.png":105,"./Set3.png":106,"./Spectral.png":107,"./YlGn.png":108,"./YlGnBu.png":109,"./YlOrBr.png":110,"./YlOrRd.png":111,"./afmhot.png":112,"./autumn.png":113,"./bone.png":114,"./brg.png":115,"./bwr.png":116,"./cool.png":117,"./coolwarm.png":118,"./copper.png":119,"./cubehelix.png":120,"./flag.png":121,"./gist_earth.png":122,"./gist_heat.png":123,"./gist_ncar.png":124,"./gist_rainbow.png":125,"./gist_stern.png":126,"./gnuplot.png":127,"./gnuplot2.png":128,"./gray.png":129,"./hot.png":130,"./hsv.png":131,"./inferno.png":132,"./jet.png":133,"./magma.png":134,"./nipy_spectral.png":135,"./ocean.png":136,"./pink.png":137,"./plasma.png":138,"./prism.png":139,"./rainbow.png":140,"./seismic.png":141,"./spring.png":142,"./summer.png":143,"./terrain.png":144,"./viridis.png":145,"./winter.png":146};function r(e){var t=o(e);return n(t)}function o(e){var t=i[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=75},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABSklEQVR4nHWSO0oEQRCGv6quWXURFFMnEtRjeAZPtNfRU2hqJJgJYmZiICgLys5UtUGPO73DGDRV/7OSltXDKmtWhIRmHV5CGPeiV3tWdPBbuz5HckKrQDHMB+pds2Kn64uZMKgEgqMSKDHgqHCHiGNt+kQJpDIW7BNcF43F1u6/Tpp9gstlVEABGeaA7ej4ExRkziAJ1Cr8Fxy9Ju3+RBzKKjzVUaF36HrBvg4P6HrY9ELXCZu+CJteRn6WK167vVv+E9otqEO1127ul3S94D00Hiw803imiSjTY3iZpWeOvOYzdvX4UZlHofHMwmf42PXY9dP7bLjxAA1yckKdrE6kMgtXNDtZvIyCOj/J+a6DaRLW2Cmy98unyhRlzgVTEJIJFBctk4S9tR8Mn3YrBHuFE51oacuXAsWe7QyXtCXqUEgaC3a0tD32C1Z0QAE9c936AAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAxklEQVR4nK1SQQ6DMAzzpPz/meMA0jpAogwU70CAlNLBYRLI2LEdEH0ME0kCBGEXSpwEcODSxdmMtAEyThN5skD6OBc33uH/KVAyGWjyCQdOQN1MmmF0AkASaphx86ibSR3HpdUMStvoNmkyt1J7lqr97AEfXgMoh0lCnu20vd5qTDj2EN18K2jaeB70RuTB1Sf1OybNO55pOUoIw2VYtVwir9ewHJAtuNxHreSRPvSXpl+a9KEDqHYMPZ5pOQpCZT/1fsjjF52BJvTQK0qCAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABGklEQVR4nI2OO0sEQRCEqx8XCRqIx0UiPjBR0P/iHxcxlDtWIwMxuBUMtstgZvdmx/ERND31VXUxcnezoAqgCpgIVIBRq2SW362cnx1ZOyiAaVkoxShU0vbT1d4OlgEVqDRY5fvJ8XIGxQyqBjGDqFfaCp08X15eQwtT1LJOgVaBqEEkbT+8uIWoTiDtpFHp2hc1+MHqCvipQBSA/rp9sX8+AYpMBv84HLds+55BIkCQQIAIAN8YM6+YP39+IEhwdogdy+GBxMBAkBgisib8afs+mUM2g5wzFiwfR/b84e11CkZECowzVLoxfr/pZuA/JVGMP643O5B/UU99NCtYd13TYATAACKAYPEeOYEIeP/STQbJKhRAixWFX+hdWIVMMmjdAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA8klEQVR4nI2TwW6EMAxEp5L//zPZVisW0QI5lPX0kNjYAaTCIfEw8xwI+Sj7m0S96oSItc9dY6ql7NqZCCMyBU1jgkt5K+ghthBBMgHpd02bT35+NyezLfHochgzyF6FkGUvUBLaumoDaJrjQqt+Gba5EwENBgdfaQRk2L5B6k1nPYdJEOo+eaxjIseQBWKoB8qwjvVj0XYjmk3TrAdNXtuXAxQdqM01ALJOyLhWAKhHp37UG50KmaeHF9Br02nUCHh91h+E9v62fPiHspqprppM83JsD9FBzkHtNJnmBa1dOz0ENJyWvo4+AoJnuX34H+gfb4w9awqIriQAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA2klEQVR4nJ2S246DMAxEz0r+/7+sWvUikBYobVnPPiSkhJAK9cn22D6ZKPm5T3+SAIQEAtY1UtLXtXXjCyqLe0DWj1MQUlPvWqAZIPBCE9b8PrKhcnHpqIRb2z0qDsCX4ArQmu5Z0qEKXbu1tn8iD0jFjkTUQh6iwN+wWbP7dcgXo7/9gNtA8uR8zn3xvjE3Lv1mYxdQwjjnDlQMEaH51Wbd/DJkJ38BCFdQgsS4oWnRmzWbjm0+5AL5x0VlgFODy+OvC9HlCA9/P0bHUYxJR9hhPKLV0uZwBfYP8fIS8IMOv8wAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAwElEQVR4nJ2TOw7CMBAFZ9craJAoQp9UcIBwADg7V6CHAyBRhA7hpTBBYD6JXDzt88izriyAixgihmqarxliVlWbYvm5QFEky1hmC5piWVGsoiZIRImoRAKpv7PrF5a6LafHdPgpZz1jtpocCBIxbgRuBOnnOGbtdF8sB4mIb5fuGnH1Z1BnLLOuORXLrhG7NGdQQCVLzsLXe0YzGxD/cTDqOUhIL4il3mcEM6q2WH4sWL99Dvj8QH9Z1+28WBbjDtWchVWz8bAvAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABUklEQVR4nKWNMW4UQRBFX3VXjx2QEZJYIkNEJOYUJHAXbsN1IAAJJC6AWCRIMBIWrNHUL4KeGffuWiQErer36/9f9uDVy2wKWgaTZpqCWw7aqmXXJ83bvynw57t3TDkEFUw5BI/Lh/CkGX/x5e0gBC1nyIKsEThhjaAt3Ag760wjzPHf8Yhra6g0oo7mu8ILDzv/eP5saVtNfsQ94Eqqkiotsz/Xr4dUJWd3Gm6o2uOZg3ZU8OTT96H91NCvDJx9LxPhgV9cfSM8mGv02YKowd77nIc511PN31x+OBCiduOJNuzGg/768j3hgYpwkkr2aRwyMK1snZ3EH5//GIxQLQ+Z/Mc+8afl+lYYmitJppECpSEZGjkNqeDtZ0Ey/qSxl5HJZpYgN7OhhNQh++7rvUPDcG0rWDkNZSEpKAui4J+v7pMLrOLGizYGTgp2Nxf/VfAX902ecCrTcH0AAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA6UlEQVR4nI2R6Q7CMAyDXSkSvP9bMsFAgh2IKeZHszY9OLRJdbP4c9aGZbuRIOK7PwDY17E3a3m8JgDZnEFts9d7r0zbjHoCgCALbDkRCMYGyLxNbZIBfKUHYAKQ0D2P/VX9rzGvMj7XnwD1+xpwea4gAwhAqzWaA8jgaiGG2SrDckyFj5CmliFyWg+WYJCUaoZ4QUnnWvTIcD8mc5qkTmVnEu4T3A/xUGgHpU6ToKoF9HvkepmsAOhXUNbqemQ8zyXdfWySC7hd43VcSioJKiqTT28AM0CFxcHctjdNAuq06xech47hf+AbTw0BT8Hs3zwAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA0ElEQVR4nI2R2w6DMAxDPSn//5mbdgGGKBdNLN4DpTSlnfrU5MQxjrjM60iCAACSAEIHMqoLGpnXsSDayX9zmb/TJiPtm6mRYdJ/3tUGBIGsAQmFnkyUBBOuYb5xaZbGC+1Ac6moJy6vpQVplzReMGn2uQYmj7E5XKNT7MKWTJmcR0LuUxtEGkxgGXDMEia3YSgLI6MSk+vgtn+8xyPCOfneMunfQwD1JsbAWQEOkVYkka530U1ITM6Lmiboegf/OYDwtX9zfawjIHjOxWGN6Q+DSlVyffJDxQAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAjklEQVR4nJ2PQQrAIAwEU8gH/P8LFVERBb24vdSDojatIDGb2SVeAEBE9JTPlUsp1M+fEK61EoBBnN+nGaeUxPBqxjnnAdgZdwzHGI+AKKC1NgzmfqX1nq21r9BJGwJOdxUGgNh7LwJ3oeycExuWG4QQfq8/fKFDc33TWGu9BSUhbIwRrbvTL6UUvhhm/QbJhaMs8zXl8QAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA0UlEQVR4nJVQQQ6DMAzzpPz/l0xDrZBYJxg7xDs0jAZatp1iO46V5MI5EiBAIleF5/vq+8LnkIWPqCfDx75gGXzjYDrBIIRT8Gs5/D1MMIXNTALAjq8YVU2Q0k40s+NtTZDum6C2otqKutMrHmEfTkyNwAIL+gAWN+Yf0q7KwyvOPy16BGSJs51mIW6AgLaHqYS84gxqNlPVTBnT1qQaN4wCS+oiQDUTQbvv11B5XENh3qo6DtfXwifDbTwEaCWwHdCPUNivrJa4ppVYuj/MNe0NDurypydz69MAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAy0lEQVR4nJWR2w7DIAxDjZT//8pp12rtLhXdHuI9QIFsQDWkyk44MS11nC8ECJCwCtT7VoXLDWFtw0FhasHrDlAzQC2A1UeteOF8/nsoHQRCkALio7Q12fAaP2Hc5U1tDbaDYkDx6sovqK+C8dQBtkME4xEs4OwJxjthMWBYJeR9HQKYhgpYG6GrV10DGHsrhNSz9W9PHpNPJ+cQ2Fo7Ac/Jh4sPXPBGXaUXWNJB9t6lv6fIQTnQVXo5SA7eAixUN2oCkGFxfagSXtYfo/vh+y0e4IIAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABGElEQVR4nI2NzUoDQRCEq2v6KJiLhhX8Ibn6EN59ez2poAExAQNehCjIdnuYmZ2ZzQZlGbqrvupaucGtkwSFIANIIghBpicBhTPxMOy6OFsmEUahUph9CQIJBINASDAQer64jCYjlCBgYApUXlNACGNOT6+7poBM7dWcYmQs0W45H0SZ5Y97Xi5MU7urk8EYQ5GRzrtUBfOLWQnJKCwCEBARiACY8PS4O4IIEqiDrVcf1p7svnbucLgbPH9uiCp5HvfB85w06MfP+4DG0Kpic4sPVnY36Ob7bRIcOhh7uvpcNbC3Hn2eNqVbT+/Xj/84arWZoTeHmUHvXp9gve+BMm2S510fntcHQ27+59PNy7YYfQutCU8X/gJ/vmyAxuuP7AAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABp0lEQVR4nG2MPW4UQRCFv5np+elljYgsJG5ABLkDSDgA1yDlMsRIFhkJsYkIgcQSZGARECAhEMbe6aquJuiZntk1Qaneq/fVq04/fEtBjRANUSPMExctK73ORA338t3XVRBvlLgm0Tuja43O2Uon+tZwt7cXdO0cpAPI6KdbYYpOJBT39OQLEpUQNW/TxZvyJyoiSthlf8i5V+dvbz5GpUrgaRlSi8cx0OJp8cmxpcXj8Tjcyc97GSSDPv1fD7T4lEs6q0kSSEFwz37cJwUhiZBCwERI4XryUsB5X4nwN4TCV98fPEx7oApV76j6hqp31Ctd9Q3V4PZyt3l0vHfIwPKQC5YbpmACMY/bPr5DZTodrvOevQqMMj1oeapKgeLq8zel0aoOqz1We2LtsXqDNR6rjxbvPLHxhXMXd5/nsJkfNyW0ZvHRGlQiIhEVQ6ftPl4+KeYwVLlE5XfOwjpbtDt7/YmE0Q/QecruhqxvHU23Afrp3g2p6Or92Ys0w+vHucx1iTgKcSfoKMRRieOsBXfcfSZeC/GXMI7C1QzsMrCGdRTibr/gH83yuoEEyPZPAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABDklEQVR4nJWSQUvDQBCFv7cd0GJqqwUR/f9XT/6cXsRzoUUEqWTHw07S3YRSDCzz3jczb0mIft/fPCvRS2QSWYks0SuFF6UfOmb64LZbvZKJhWpoXAjeU+mBk7Bd94LkSA5R69MwMlKPVcxW6+P1xdpDw6xbH5ELXE1tWE4XZ2x52FwPaCoNs+XhHimX9yOHdqS+8pOazto2Nx/zoSboUm8IuP0EqT0pXWCLGTdtt/8ImDPzh0dwxx3cHc+lMvHuBMsNs6/9D1RgHM6t91yHnJl9709AQgiREAlGLaS6p7YvYZ2e24VZgCYXtN7u0hMO8WHARXkGrQLi3ymHMovATt0iBs7QI6CEaBJYzKD/AHQQ230gA83tAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABD0lEQVR4nI2Su04DQQxFjyduIkSQoKOC/y/zHfwEJRWgkJDXXgp7Zp+RqMY+vvfujLW2fX9TkSiI8UmcizO1mb8evmfwtoEZ85fD18wIhih0FqcodMlkRpfsguFHHpBNxFOjlTTZiImCf6yeE0Z6qydGA0xQIGthgF/Y9MMqUIpQCpV9aKyFgD+eu9YYwy8MhfMATMjAN7pGs6pQza28llIsE9d61ez99LRLE028FFCvVefKt2ZANJZ7pr4fQf5Uwft91NrXtgtDXZYmAW2BS7XwO/2A+q8P08GQgqCcqlehgnNegYwuh0CabBBgxMWGAcH8dLwfpQ/FY1bDiQfEevD973oGF+sbzD/3/xPeYn8hKR7Bgi9xJQAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABJklEQVR4nIWOQUoDQRBFX/UUKEgk4EoNiIgrb+AxPJh3E9yJgqASRFeiC7Hru5jKpCcTcTF01X/vF2PXdqVihWJGsULXzNN8yvxsfrwVbB6zLj/PL2c/Ol1Mwm3imNuQ+fzyZAxLgc6wktk/u88uFpCgFwwa2bp2N6wrUAwzg2L43vkhmGWRAawlejY4TW6G7xzNNoTmiAFmyBhmIPeeux3sDsFKVIo0YlsaHAP/2XeEEAH5CoGiyeNPxz+1XIMsbSuEKqGKqMMcCvz9+wGpDStB3chimuUhf/q4GYuq1Mg5+ryqEpF/kawm8/vX2z5oYMS0NN6VnvD75R0h9TCU81qIENrGIwgJf3x5mxRWkoI8ABGgUL4Q6rk/P32tgWiKY3F0oPF+AX1dVexjH/qfAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA3ElEQVR4nJ2S2wrCQAxER8j//6MPIirYovSilYwPm26S0ooKLZlNTibp0h2HiSQAECUCJEAQ9gAkaPlyZOWkH6cAlsZolI0ZuALIML7qRNKg2GCwa6ubllv39Eb8aaChkLV/u9YNS11Ny6WfDcqUTT1f7kLLuZ9Scp6qSdtGwUxng2P/TNN01cwN4oBqoGZQI/K5Gq8wsr+PXliC6RzXd0b290f9hLrqD1GO7eh38GVMBqd2sL/C3qR1I+9a2DWW0I+g68wJuqslNQCuSbUbXGeEzWGzGVTwQzOoeANe+wjb+4SIpwAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA7klEQVR4nIWSy07FMAxED5L//xthcekVCBYXmpZW8rCo2zyawioTe+bEifKkaZUEICRAoEYjUKN3v6VxAaIoIWrDfxCb0no0thVipE79PJ09pvUIlSYKWBsOPpKwx7ziRbPWOexFWGjzCew9LRHaiJd6n6LR9pZWPIoep551hrV9e0nLYfCOoQT0+vacljzucZIOgyJ45bH715wbFKF4wLwv759hNnzPuDyIjuNIHq++7TdYoyNjr/OtCm0Nj7t2YBXYseHnBvL4HbHK46uV9b7HNA5/hHug2mOM9/1X7C+VTafa2Wd8fF4bq7p3Ab8bQAKr0rco/gAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABEElEQVR4nI2MO0tDQRCFzzyKVBZBLAIqaQUbsfPH+RetBfEJJhHFxmizMxa7d+7u5gYthjPfOWeGrq9mzgTEcLWTYyqTytPl3LtCd9RkBGKAmYpH0JMjCdhXompnQubS1ePFrCkQSwyzgERArI0fGQv0cHlWBbpToHgiTQ8kAAv04PQCYAVYwgR1zAqKLHM8oMXl7kHFTtwqsqKwpvl5McYSiAF0TAJv9qy03X67u8MdGNQGtoHHrOkYoO8fPxE0RZtg8+J7sL6tvyaDfQe96ur5szHyGCwVtUpTx2bQp7vNv4rNw+TwlD19vF0VoxwWrXk6y7u+3GziW/3ZzOCeihrMUqd519eH+8b862jMs/4CGxSAfupf/ykAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABCUlEQVR4nJVSXWvDMAy8gN76///gxtoNmr00jbsF7vagi2OHlDJIkKX7sGxrKNOPJAAQMgKSgPwAyRE44sVjXg6IMmEv2PEgxKMsKeC6cwrEbQ0JYrNu+DFf7+nG/4slIcp1Nsk9tkIB2JnVI5ofv+Oct/VK0B1z6yaWsWCQMDCBdZ0xc1AYhFpv8zh9TQZgIIWQGrMDzHmcPqcEqdo+yC33P5Bbro0f8Tb2BhSgFwb1KETE+wiJfhZCeVPgWgMh0QPEyoWYg3Sbzha6+FQo58mVuXG7X0AJ9IhS8hMLhNxxi8kvmlh8lNkGOdusYCOqWGueWBpkU45Mg67WRnZ5XPBdC+woz0x6/A9TQgrNyikFgQAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA40lEQVR4nIVSXRPCIAyLd/3/P1Q9ld1AcXPxAQpF4Hxa+pE0LTvt24cAQBLpCyhIBSBXKibAHEiM+5jwI8iqlHMECcg77k1CyQ1WUp5cREmID1sJioPGDSfkLBCeWyIokfjB6qDGMHVx7tUSMBHhQASEuCWCh234gw8rQoi7hUGzNs7Eak7cPQyKE/voa/JwsT6bFcB8fztEFhdTMluGsQ+7b4cJHoD481oCPYweCuYOlWSe8SBkPfuW1GEjnN1ZLP7ije2RQC+W1tBf+fLsG8uuhlCm10OChIRraImDpk7c9HwBHKMrHh0ei6UAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABI0lEQVR4nI2Qu0oEUQyG/1wQG1EQUbBYcLEQRR/L17USCwtvhYjiBXURPYnFyZ7NjDNqcUi+5Ms/y9IxJi4ECBHGKmN8r0eryzH4I4QIJAQWAgm3Xne3V2JYFywEYgKHVMU44OSEr5uHG70DBjEHc2MSqcfcnev6/iRS5yKnEOmFpJ4FYIGu7U1BUgEsIObhXgQIrsc1RJd2DioMhRADxPCoIAI4M0OxNYU3iRYHvJB+hCSm99nM3QFzhwMwB9y91swAqtdlvX39TCJg8CRmdhSL6t5Yr54/YgAUi0U76LJZ2gXr2f1bGxT73/tKvZ5cP/UEGxTzc6tfd3fo6eVjBYs/JwSPn++9Azd0HL27eRmQ5kFl8Urpcjx9uDj/RbLW20jIN3wPaQGRbenuAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA5klEQVR4nJ1Py0rEQBCsqm7EiyiIePCwsOJBFP0sfzom5BYJ+YTMeJjJOgnZzbqHprue0PzCLhoBI3FsC8d1/7y9zsRGCQkaISNoOtz+8nSTySTICIpQNiVjDqjwZL8/fjwsAgKljHXANEthzXm/f9vl1smoosQWJcUtA2Twu9dn0BKADJTWbzMg4xROJX61f09grYRKIeYw07DgGH6+459YGBccVzhQYAghxhhRTgjhJC45H4bh7OCEy+19368K527vum5G/He8bduLguM4poKmaWbE0rCleVVVJ82bL9R1fdEL0/wC6kqF+ErBGb4AAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA70lEQVR4nH2SwU7EMAxEH5L//yshLBIcaLeLoODhEGfjZtseorjj8bOb5Elfs5AAQIoFUGOd5BCYrksIYcqxhE5yAKZlSXQl+mB+yNVlmj55/IXzojyRMU9V8Jagm1x3RtdSLDB9/IS4TTSgDvTmN72v1eCRbF0jJsete/Kav9x2zK3TEbiBhOn5Vid0IeduarGiUN7PRN51m8sa5m0RGZDBI2AqK3LhUtrBvb7CvjP46rddyhzdu7gtDliGN78Le7tc4xZVz6vdFuD1ISddQx6s8DsUjkVVOwJb4S8J2jF1rU/Qgfaq76GLdqY5hvwDOwHLCfy6qJ0AAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABCklEQVR4nH2QzUoDQRCEq2Yb9CgJgggm4CH64r6UoIEguYghBNSLU+1hNvOXbA5NT1V/XTs7fMHKQwCaYqe7IpnPtlzwPHgSQnAgGMYaz3b/eJWG2QwnYOiWMhcIm69mzRC5p2twYLpO5R85DIRdP8+SGL/cw6iCS2D5N7On2wsvVmDyvG9cLqZfjmOlp+90KsPdQzbJaolsQ5pFVgHzBdwDHMPYA9RrhMKoZfj5++E+AqqWei13yNF1h22/byaH8r8zHhArz9b7nwIIkBIY5fksVVXP5LD37SGLWIdUy5Nh0WHrzf7ElBwuh6TGK/7RE2zztivDBhQ8poVjR1SrJdju9esi5DGBU/oftGhLbYqSOw4AAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABA0lEQVR4nI1Py0oDQRCsnm3Qc4IgOWTBQ+KP+z+eBE96cEEREUIIRJwuDzM7r0zUQ1Fdj+6dlTts6BxQQRrdQETSrONa+sWTIwIZBOIi4qyrm4sQJtOdFF2zlHpOoMvNogqRODxDBgnPKfy5h0Ggl7eLIOKX2zKKw/lg/kfV7VXzw/1ZpOcLVMbV+UWJKOdGK67XyRQZzha7WhwUyxGkwWggGqbBYCC/g7Y59ynX18PTPw4YjITNDCat037qhPMC64yEoc70efdeGZ4oGPBk5EJb1vr4eSwK5SJg1uiYexLeAuvDx1dleGOtk4ciy1rv3/bdA2YAjRlkrSN0etn9Wfot/wG521v4Pjn20wAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA30lEQVR4nI2Sy27DMAwEtwD//x97qgM/khRIkLQGpwdRthzJbg4GtbvkSDL0we2CQBIS8VVr7fjIuF3bw29CTPerhCfDo7JWFr/O5MgYv5pB0gFoZqkaU1fv7PsDG+3I1Hc74XtQ03AqQl6aOc5ARt8fNvwL0DDGn04GnhtZfKi93Gs/p4tw7TY0ocXant23gDjRtnrWTnHqbWbT+bEG3hiuagJ6eDadn/FKEZLybVDSKG6UdbxqD23j7xyNQZUWDQEsNlihARjmWU4iZkCp/UhLss/HHCZFmHYs9Wue9R+O4wCuj3feUwAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABUklEQVR4nJ2Nu05VQRSGv3VTE2lFMXYGE4kV8gB0Fia8E4+jJsbHIKGBhIQXsLUWZ/baQ7Fnn7PPgUNhMfnXfx35/fZdqxYUC6oFxYNqvuIPvVh4jn87PluLHo8U/Qkv8O/HZ4gOIInogHRccjQRLYj8hUUmJPGXBxdbpURk6KV5YPew772+RFPRNCwN7c8GXd9paD5DU1eZGf3w6tNEhqXxyGBuD05j/uH6CJOKa8WkYh1dyxavmFUsZq3gWvGTNz83Q7tGdmSknUvDBVz7ky18WnNOD/67jAuSw+eWpTFWyApZGlnpvJGl67UxLu5Z95sfpRe7UenBtqHvGvTbXw0VxzQwCVQCU59QAlUnJNCV79jzQF9M3D/uf12EA5Ne1j4mviov7/kjf//qC0ljlEbKSEojaRNKo8q4wSf/Hyl3pDT8eu9PD4yLwDzY9QcD6+w9G6MSSZhjfWwAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABK0lEQVR4nH2QO04DMRRFj59fpDSUSCBRoDRUsIgshp2xETaQPRAKQEhAESJC7EsxjmMnEwrr2ed+PONw//ggV8ZzZphi0p333DXsJ602f12OmDMT6Yi1RbVk/vJUm3ciCqQQSViZcXRuguEfXJKsQN+L22r+v8QX07txQ8eMKDAgSpggAibwdbgYgMChGFWZIaK2JUwTFhHwm+/UGOmMYyyWciyTLeFXeUW2hCyRdytuK9s0XJbIsfFZwp9niw7keFDWlpfilvmyFGB5+GQ0vEGzjwg/OO88fu3vvTkcmw6DXfFN+DwpCgNFpIiIoKIUBhGfbs6LOJh+ZVU8HbSq+Wp9O9zZtA5if7tUfkgBEchl+td6RoYOSoFcpqDyYx387eesmsdCLd+F2rI/YfhiurSRPq4AAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABbElEQVR4nH2MPW4UQRCFv6quHtlLAiJwgAidcA+uwK24DBGkJGQgRGIkpyRoQTI/stnp6iLonulZsyIo1Xvfe1Xy8tO7yBqMgSxN2xHv2dZLINc3b9YHdr+gQVTBXfs0XTfadr/OcVdmF+7+U1x43Wjxil1/fETymVQL6jOpHvouJJ+xvkfevC75s6vXJwsBHNSY+xw0MyfjVm1we4BdnT0+LiZj1tyP7j3o2lWZmMnM2Psnl2RppsHCxB3nbJjM60HLR2Yv9NU/BVcoKriCC3jXRems+VsF+35x0+Aa5FFU6Q/GwxSZRCbFRIqM7R8+xWgmRSbHxBlNW51auYyD5dh6X35/+BzteAKEKkHA6S1BhaNtP3Lu4M/JwrprEGVM9SBKxb7ufzZQGgiPje9s8T7Yktv+7TeCQAwkC2QQEyQDncluaDValhUxsN1zgyz9AdCPV21BwlHKZpwkTdvF5Zc1OFlctPim1zKl8Bd+FVIszOQmkAAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABGklEQVR4nIVOzUqDMRCcmSxYL3oogojaQ8G+hw/qWwmCBY+Kp3ooSCG7HhK/L4ktHsL87hA+8TEkQgmQiFRRApRmTKr+kNv6YTEX20IC0jBEBSiALCgF7HatKZBiCjuvOaKiG7Pl3XdnIBEUUf5MMBEQO59VIxF2vrkoQjpanjmbwTIOCWabq0m0wcjJYz5hXN2cPmR9LR+04fp+Msl0snhUUzAuV4gIBByOQIQjWoRXngtGzAiH7Q4fJ4569AByEB6AB5Er2vt+XwIUYy4SHjYViz92AHv9WvwpFT3zUbfcnnfqQ/9/xJ3wTLgT9vJpnVEeOp27rO/a2/ayP64cHpAHmAvKA/SAJu1IHrCz7WEyWYvKv9wHPeaBH2YtGxi9wYKPAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA5ElEQVR4nH1Tyw6DMAzzpPz/V45JQ3sIBkxDU7wDaWug44Dixo5rVeFENgQIwgEQiEoWXOUD29fbQ0HqEQRYM2C7HCMHyUxvMVQX2Lp5lMH90BajZuAynLCziBJ2Semht3Ya88FTRMUIU8ZL6AUk7Pqe8s0uKVyGCy6DHiZ2GcaFSNG2WOLvMAlrxqm4pjfIieJ24YrJ8lnT93/JYqap1pyd+27Zj2jQo8bN5VzvWXd/gR6LQhFHj/+Mo2fdbZAlwkrklF6FJwF79rMsxl6wNfCaQWzMuuYfscJJNTw+ByLBXtf8APa7MYwwh5EKAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABB0lEQVR4nH2TwU7DMBBEn9Pl/78PiQs9wKFpkUqjgkR2ONiO127gsPKMd2bWspMkPUsIcCQBIvKMhfC8qud2/5mboYrVeNvzEJ65EHZfZyRKHkh1TTlW437RFm7nr6kXhuajOXVmCWz+TrgolVgrZuClVgU9YC9XGwTZ6IKVFtx6YVgOODRRPXadEgPozZXb6+3pT/H/QakGWL6UrZRXLzfe9UCuTecCu1w8NENANPvOAIE72MfZN2Wq7+bB7ZBqWthDYnJhh7fP8OjtfZIGQ+inMMSm9yWcl/4k3WenflDBNp2Wx89uB6cxrGDjtKD658lBXnipDWvgDjh2XY5BrIZ3xFtI6P0CTYDkxqndzqIAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA2klEQVR4nJWQwW7DMAxDnwH9/y92l3VAEhQ9rOkOq7hDlChqvRY9GCBNkbTVpE+BQA4oT+EOUpcbv2MYduLGdyEP3NeAKdukitem/zDCNA/ZLu/g3l1iYx6CvHtuIMc4H94zkuYI+Min+boHge/+7Lv9lBlhjFPH3B/uFRnDCQVZ9MACXMFBnveKEAnsOl1CXIRF5KVxKRQ2j3MYM2DDzkvNzqfroxjNhT8LcHI38ZttT65W9Phh4IYdv9tm2A9kYLsLrLp9XVq95K6FVl5V5gA7/rQn5vqC3twfxijizg2ZD6YAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAzElEQVR4nJWSOxKDMAxE1zPi/hfLIZIUKWKoyABpvCkk/ONjUngk1rsPj2xH3ggSQEBZCbDqi6pewfxGG7AH0n4LaJ2iAgknv6Gmvg0TTB4I2d9XU8h6svLYXiAEvT8OmekMLBi8iTAxqxd04bCUhrATONEFw6LEYOSiP6qpF97n7SbbwQjAYwYDbU7MHlytaV11vV1Cxtc3E5kGXAetIoLVowC4dN0ESJfNyWWaSzM1jwxjFwFFOI4i+94D9J9O5wELXFyrV55/Bur1A/z3tAvj4a1uAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAVElEQVR4nNWSOQ6AMAwEx8c7YPn/I6EJwgWhIAWkWGmt0U5lA3YH3iY1MP6TwFsC3Er3cnd4auuMogwfeEpfC1Y1an4tovQzds8SaXrBMvZKCbMLDvEKBu3k80MHAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIklEQVR4nGP8z8Dwn4GRgYFczMIgQL7mUQNGDRg1YDAZAABhUQQcInuakgAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAqklEQVR4nLVQMRLDIAyTfMzKQNr//zQdCIkNOF3awXdgyZJsAjhIopWBIOD/1/ssmMOJItVIBIHVYO9dBtYFduQJFil+l6D1/pVgdcAhgXWBrd4kw+B+E1shDDeBKkcESLeCDWIEaBxWqHJEPAy3hMGARNGuGHE56BJwvEFVcPh2A5LBZLoB0uHkBtspYJ2A/qbr53h5S46cC2T4UmB2zvHykhx5JkSxGf8AzUYG14RE6RQAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAPUlEQVR4nO2RsREAIAjE8pxzqPtPhYuAO4ClRcqkiSDTCKqMjZflH3gUkLNaGxUiw6DK8F2Xf+BRQPP0Nl6WqwQ8lG1ziwAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAO0lEQVR4nGNkYPj/n4mJgYFczKKgQL7mUQMGiwGM///9+8/w7x8DuZiF4cEDsjWPGkAlAxj/y8lRFI0AGbwEuTJP3MgAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIklEQVR4nGNk+P//P+N/BgZyMYvAB/I1jxowasCoAYPJAAAvuAJKaJ4/IAAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABIElEQVR4nG2OwUoDQRBEq9oByUHFRJcg/om/4Ef7IZ4E2QQiEhFyiNvlYWZnepYclu6uelWzfHl9E81AI8gyzWCLm0ZYvZuXNs9bkKxGDzEXmVXGip5ZIj08rXu4mgilcyEqkzUgPW5viogWJGGGUoYME6EA9YE0DNclhBIqBUQIoYXY72lYLw2BVIMQ9lkvGimk4fZcIVKdSSiUqE5D89Nm9dsBFmGoD3ef5z+4v/rOgrxNxfuCBweKnu5Oe1BNoATIawhBm5k2HWl1HAHPYg+XPXiod9uTHcYseIFiwAUFTx5LBLkjTbtxAWVABVTQ5a105tLpcwctAjMc5/xi7wnp52MPueBTb0Qwe5fv9PV+qIJPgqYATYL/CTovp9f7H0WmVx6izexTAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAi0lEQVR4nKWRsQ7DIAwF7yFLZSBLk///1XYoSo3lSKk7oUMYToeAlwSSaHzWSxaIle0Y/dyQoEmIwG4wsh2buwD3UsZz0LPto68H5mDzLGjkfBpE9VKDqF5qsKhXG0T1UoO0ya8NonqpQfzOUoOoXmqQfbEk7DkeTLfvSmAJyNnY+vXgjYuM0f8yeAPrYQWRDvhnkAAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABOklEQVR4nG2Ty2pWQRCEv6ppXUSi4IVESQTBnaIL3/+lFFeatIvu02d+yaKpSxfDwNQISMsIYRkjJGOM5OYaLhltu3j34h7JsAXYcLg3bQ2P528+gkwe5oYpFVqgxgsO8ff9a9LUwtSIzUsQ586AsnkSeZcVMkjFpUQd1OjGjVtJXN/8xDqN//k5sDj1gjrg0/WvMZYSQ3FgaeMzal8sIL6FWLiMVC+O8RNo1qOHx/fH2xYLP4FndLXXR6l4fNbXMcRCigqNXohAWrBlaB2vrn6MQGuCqQU+fIPbk0kfnomHt1/KsMk20yYl0odW76pAVaLKxO+7D2CmZdU6pmlTqC5TbmXDEH/un6G9ad1kukwSU5xjV4UqHlc3D2N0zS/4jnMRgSUsiNuX1DcWGPVCdRnp9C6+u+qJJf4Bq2dP2Vu1vf4AAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABdklEQVR4nG3TvW4TQRSA0ZM1Dg77A0leg5YOiVehpaanQ+J9qJCo6ZB4DiQ7MLNLFixzKbx4ZzHFtJ9mzr0jiHj5LOL9m4ivnyIi4vMu4u2HiOevIlxF8CV4F7wIxFPiNfGRqA5w15MSYyb2mku6lvaazS206KZTy0jIqAbYZb4n7hOHXrumq+meUN9Cswj0UyCdAtuBb4khcRjUK7pHx0BzA3URaAxlIMOunwP7rK5or+g62rNAa5yun1D1sN1zl8mJn73VBd2mCKxLh5YykGE/OaTEmIiD5uEMuV44tNjMgYQTZErcZ34PC8ijw3IS/XlgcvhRQC4m8X/IKqH/dxL7rFnRXdE9LiFnh0Ugw3acIX/11he0E2RzDavFJP5CzoF7c2DMoJ0guxtWZ5BrfRkYy40c0xHy8ujQnhxKyGa+wQly2x8DE2TzoIA8W6jaUAZ62JWQvbqaVvoEWf6JI2RV/izbgbs0QWabqoC8Ma1ke3rCAX8A6n7VPhrrmDoAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABKUlEQVR4nHWSQUsEMQyFv5d03Z0ZEFkQYdeDguBB8N/5r/UoeFimHpqZ1p16KMl7eXlpMyMgizfgFjEiJmBCTIgR7AY5yAATMpADVrg03X90CzKBLzlNrqpxSOOLozCozUve4/VHk6YnR9oWZCDFNAWv5hZannDyOk10GgSaERmUI1achuMPkJHmiLnitaHPiZm0Hz4roQzMjUmDexyZdBi+OlfMGDOujEmU3QmP2HLpPFwawvCmWPapLafCS5CeD4cVLKL4KIjaoMZAYWCCdNrvVtAVNXkdEuaCdN7vVlCeL9bFE/lcfvjY26oBSMP37t9iNTMkR2UjSDWm6fKAKQRWLi2FKKK1GCu5hcHx7rWKbGnyImiO2ZaTOen4+F6AX4n86phj15w7vxnlS5ipXSRlAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAaklEQVR4nMWPSw6AMAhEH8jebZc9inf3JJ6kbjR+UlusiV1MhgnwAgIkBQSo+V6fs4XCgMctPJC9+XJByyv/APq/UL5AQBVkk+qRPW4h1gH3pdeA3cnIxphveGXEAdSaZcSpL0DSMqcvgBUq3Anzlm9W6gAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABUUlEQVR4nHWSO07DQBRFz4vfjCMhQhwpEiV1NsACKCgQ+2AZLAmJTbABEBINBTtA+Ywz9qMYx57EQdbVuXPu2JUFno1yC9MNlFsoO07zftiyHuYQKoSHWyNUpCRJnfUw785dn1Uwo48S36DiSB7lCpgCHtAubqDwbdaLfgzg6kRqsHMMYDXC/sWwOglqYA1sEiXnBmS8ibellWzwcY2PUDYkxkTfZP10L0Ce3rFJAX0066OzMlFFC8Wh6VmtrlEG4U76wIgj9jx0+bIbOx2ViGsj2iTSAC1nKfaDjYZWoJEznIy88nmZxM5Stjb03tH15sQbYncYe+gTs/7veQH7Clggxr2lX3GR5fw5FErQglBArRAKkI+lWSggdCLvtULwhvOG9y3eGd7nadHd4xrvjYtMOm+ICuJAVMDlHcTJsP++rk00SQ6yuzBcJn0k2+ne+QP8qNhtasQpqAAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAqElEQVR4nJ2SsRXCMAxEv/IUZqCkpaClZQsyIxmEjgUo6VkACKLATYRlOxR+p3c6653OFmNr8ACe6bi6m6AHVswx1WI7zJM5YcQpw/+Xvw6usQPT+VK5ReVimCdzwojTMRC2DpFNwUE9hB7B9lYS1AYoHIuCBge3vIOpKweRUDibLUrQoXJa+ASuJ6x/Heg7TsAnIQfMWn5wpNGhknOtJ3fnQHi1LZ/wA7LZjCWBzfIaAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAoElEQVR4nM2MsQ7CMAxE71wvMJl2RsqHwD/3A5j5DnaWLgwolcKQFEVRSWnFwHCy39l3BBBaCjoK2kzdh33iAwWeAj7MBZ9gi7Q3tzn8dcFYK7ibAylvNRQoBfvMq0mtKFirvyg4ghxB+jQnPQsu75HV7FJ9WLqlglr45wUAqUkN1OyWGdEkdwXrzE/c1ey8+FRjNTutCM14w3ANq0MZvwAoLXfjp0m5TgAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABGUlEQVR4nI2QS07EMBBEX9mdzAQ0wAjNAiQkJDbcgC134Aacjy134DBcgEw+LNyTOJ9ByGrVq6q2FxbQ31CyYUNBiflENkTKYcKKBkrslXc3BYESZRwoEMUfati93ggYokCYsyHihJOPA4uIFLGDXhDBw4CQa0Aa3fTgHdg+3KYAkHrnPo16oEe0nnVInXOL1GHX9u0LHah1bpFaROPcAE2WNUhHRIPtyi/EMY0axBF08ietwXXubbf9QNSgGlGnJdWQcep/BpYy//lIj0A+MLL8c6T0R6zkdnm1XpxjBAoj28V+WkwuhSUvHzjMwpkOj4b1zKq7aZAvkvsznVUPs6W4vDhoXHqrnlbK+H+17XP2QL4QMw0zn+kvnQ5DBSUMricAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAdUlEQVR4nNWMsQ2EMBAE58xGCELnVPCBK6D/KogpgNBHhPUgSyCL4D9YrTR3OwY4iNYI5ubxbwjMcO+Aa1RhtbvSzcP7gpDpQkZHp34r8DuqsNpdaVreEVjI0BBpWpqGRcDfC8zX6I8HJmAAxtIifk7gvs9sB1RoiQaMXM2mAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAI0lEQVR4nGNkYGD4z8jIyEAuZhEQECBb86gBowaMGjCYDAAA7f0G3R3UtjoAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAaUlEQVR4nOWRUQqAQAgFx1Yo6CZ7iS7fKYLO8vpaKtitrSCCPkR9yohqPagBApB8Kc5pHk8afgCw+eYRU2LqUPW4TN2JFeO+A8hoe8CNN5imzRGvAixgUitw8hYK+moOw0HDCwCTxkcrLFl6E0fYz3M2AAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAo0lEQVR4nKWSwQ3CQAwEx8FJA9RAEdRAD6Q3nvRADVADRfCAI8sjElEUX7iEx3yskbW3ZxOIBibUwSzAacvlyDNdfidQDZ0PpAqe9Nhd6MUwmCPy/LRAjrBdJkGHj8iVYGiv4sYCHI6FX5BN8OgTvDerSjDOUlFbmaXGIbMgkKs0pgFsi7S+AfB2gRxht5kETkdF+mKkybtMXPXPLTrkjrls6Qd8VZ4XsCYoMwAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABJElEQVR4nI2TwUoDQRBEX9V2MDGIIBKIinoQv8D//yIFwYMIanuYmU7WqHgYqutV98wsywgihUACjDDIVWvUmsqXaiLWR7cdTkjGe80eHOPBhqdlsVnclzHG6WoY3gh1Ld/uQVx9XDYjjQ/Y8yB37d4aOQiIi6NVb6Cgxb9ZXKw6rDAPB8garBqQktiu3mdDUlbYrjyy/JHF9vh174REZDup6pxvWj77DdYvs2A2NNgfdWxOn8vIifW588USDe55FmfnTwdQ+izGNy8neLdZnGwffwxGjQ89bhuiJJaXj70hac8g+08eS/1paLdkcFsxXS97sINpg6eZzz2PJ1JN4+PmrgZa028ave6qAAfxdvPQYAc4kAK8aKpAnUmBFe21KrAnvgBtmnb2K/V8ZwAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAu0lEQVR4nJ2P3QkCQQyEv5hYgeCjTWgBlmZxJ/igYAuCXVxifPCU1dtD14VhMjP5YQV2CQbM+c5jT+CQrUPlEyQTLXKDFm1s2wbqC2pNn5jIvyxIsAALZurYPFB7wjELZJmXVIIHHHvVNT32bM2xeajUtuH093XFsQ3Hv68rgVxzkW9mBOqOxQ11UAcJwAsUWvJMToWTdaGN7rfGqczY/36tVkuuii8E9A7u0MfA/oj6Af7B0kHWgppX4zvaer5OqQj4TwAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABFElEQVR4nG2SzU7EMAyEZ6ZesdsD0goJFFX0BO//cggJDmsOdtyE3UOV8Tfj/DUEzAkCJAAhtEJTABaQAquOsTNbz/sQiLCm0DL55SG0vVw+QWQTltDMEQvkKt1zgopb84/YuKumiYMMmkyNcBgfCdimK8g4vYgMoxiJ4OmHRmWtracMo8KjrnBfIOvQDmvrAB80Hru51UKH77B2vg1BHwI+rTSxIWvb5bdmuw/POnYwa2vrd15IN/xYodfZQB2Myezt+lUF5fda8TC7hroPQIA9t5/+igseY7+t1AIgpR8XZE/7afh/8VFznWd8wAXTfq0ApMk8mvWPqbjh/TXBYNZkY0NwLx6e+b7lCnODT0zTJGP9B5/INUhpnRAfAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA5UlEQVR4nJWSMU7EMBBF3zgjQbIWbEWH6PZqXAGJK3AFJI7DlpxhkWhoQCRsYXsoErKx5KyS4snvz5eLkS2A1WxoaKjZsMQvuMThEAR55MnGgDDnAUeL0CJ0E9dXbopFhyNSAXoWgTfLhjXQ0J8LXHnw4IBqYJEnkAASUHbfY8CFeScOpMwVvy8WEMFaSB2E9uSWu/B8a2PBcfU6yt1h5f65Cx/YkgvXwBX9OXW5N6xUeEATqA3MuLx/Yf+hSiCxxy1122MEWMXPCeUlH5Sw3+IjEwH5BCt/EbCBc66HScB72G5X8QfkQ57C724FywAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAiElEQVR4nLWQOxKEMAxDpY0LSg8N4RYckTPuKSg5AaEgfHaBGMJQSWPLbzQmWgQMBAKRo4JOsw5fBMz+McACRX8OIIFPQmXygkJ/F6kj7nOCWg8XZoMF4PX4wGpyGWCAbzVwJNys0UtZ6Trc6l9wN48qTa2Xgmcqjdd00GzgMxtEz2/Xhyc/GAF6Ul6L/rJhVwAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA7klEQVR4nJWRTW6DMBCFvzceTJKKhCopUjftJSL1/jfqOpt0gcHGhERdoHnz/mwZfcG9iZGmbZlmCAE3G2cImBmh+KbdJPznesXSYmaENE2aOZNQzUvIDP8ehmyYhH9M/+x7VJErDDNeaIBfjseFeRKs2rVR6OeuWxoqc7mXwXQKfurewEYBE0pCaRo1Zk4mSNjb4ZCDC2PmZEl7wHm8HDK5KsllGeeJhLfvuxTO5KpwIyyBx37/1LAqoi447dYn8eIGsy48dnvAkiA0vs4LLBh/Kh7jx1PDVLzFe9OcC1N5kzr4uES32+/9dWAb/wEBEQqZWlxOjgAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABDklEQVR4nIWSzU7DQAyEPzsGVVWpqtCqtFx5V56X0AuC1hzW+5NtBAfLs+Px2FEsT6t3H1wYiHBFETTeGatTcYQg2Nt1hwLqlVRoRIG9wRA6wV6v645MInFmXK2BeObAzrfHRkQV5SzdG1CNLGAvg6ACgkcGFUckmgOrgBRcsx23X4hmshV0WPtaCjuMlxBQyF6UmueRt7BxnBYF/xlIfJLtxg/4y6DZjIW6bZ+nxUI17QyaYQjYJj6hNaGZXPiZhjLA1vvpbmLGdI3En6DR2+pQN6CZWkyKAQUXTh17OH7eFeJeZ8a1now8OON0aW44CbzkxHs2UfDQety5fZ9vXSHdrcexe9fksZWrg/7wCwgIqJV0KIBtAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACHklEQVR4nG3Ty04UWRgH8N8JanAhxmjGSwZRHEeFhq7CGC8xjsYLj+DeN5i9macwvoA+hOLdKI7GUF00F7txFBtcaLzAJDiRWRwXVaQRXVTOqr7vnP/v+0Ikgr1IkWAQB9HDfCeZ4huPvJhndua4pYlz1E4KkndR/otdkd9QESUaUs9V3bfeCOboKounqKIf+whLUczLDjVMLvDPq27vpi6Q/0F2hNoBmz4Ge3EIVe+lahKPhehEZBToKzukGMDv6KbZURTPUF+mMUerMWx5/Kzg4qMoq+hobtZd/jPgq8SU1FP97uEmFtm+qsFgcZ0QF8WPXe0OOabe8/plv8+T58lPMTZE3mPrF/aVF61qGTImLPgzbnYLE6wvA1rRqCiS3VUUXsmpvsTMmy7z08OCv65G2VFqfTrnOvXgAAb9K1WXeKLXnfIZseBO2s8IcVq0p/BeecZ4ZPots822t6xKvt3OyH70ixJN4ZlrseqBDUbQKryrGCrPvsL7v23f5zS5wMtXvwquX4ry023vD2u9c4lHdrjtB+6EEG+IK94z69pjW/+fRotW44Ll+lmyE9QGdDTa3BVfhWuymPq79B7BQuG9emwPFbvy6SfcYctoX/w8eZ7aKbLDhfcSveW4V7WkxiQe+o57sMgpxCuiiiLaNd4TX2jObjL/YlgcP0N2jKzg3l0ubLhsMSYmpEb1uosbhfeeNXtRrvfbjavWG98AAxTh8XusPgwAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABJElEQVR4nIWNsU7EMBBEZ9dLS0uHTEVDgfhCPhGJii4ddwiETkggQbxD4bWdEE5XWNmZeTORe5CegP5scW8eN7lNdxzhf4UT2qbbuYuSAOoASwKYCFeEJpgAV3Zt0813LWgUInTlQkeuiwFtA9dfUAVUiaSAJPZblRAlrOVCSGcrZ1f5EyIcpgASsCqhrSQtJ0QGa/niow7IKEm7MQoqqJ4QAvbb8vmhAhglESJFWeEQ/MkROQjLZ+/dVHgFGX9vjzHiUeTwLf+8QUkIY4AxwAo0WEInX2eWD691wAMmkdrtAXoMuNdx98gIy7uXCjTTicR2D6/lqawzu5z2QCHgBNzj9qrL6a/haV+Nshg4ppcD4Rken7fQ5ns8Mzzs1tB8YmBeZ7/8Q4IZhexdKgAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAc0lEQVR4nM2PsQ2AMAwEz+BxYIRILMDOZBMGSWIaiggRAUkKipPs1//LFlgNBmDMuO5lXWGqDsOAwvxgvA9mF8yvjCVNRMxUoZplaQj3KBDv214Qi9EIgVqUbasOdykQc67pBUlgCfhCBOycdX8w/LMg5wDZi8q+sNgjfAAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAI0lEQVR4nGP8z/D/PwPjfwZyMQuDwAeyNY8aMGrAqAGDyQAAMagCSiGnPaAAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAALklEQVR4nGNkaEj7z8jAwMDIyMBADs0iwEGeRuINgLEH3gU4XDLqglEXDBMXAADR8QTr7Ck7QAAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAzklEQVR4nK2NvQ4BURCFz/yIQjwDjYIt1RKvqfRUG9EQHYXoLNkZxb1Zi70rNorJnJk55xuaz1fuIjBmuAh+1XrKss5hF4EeZ7OkCVICdAP4BkjsXIRdnPU6yeOhVlQPtJfSaA0lehbwOrfu+tDlcNgxHHUF6BKuAF3DRNDFYAArHWYeel2bw0qr5rs5itJePLrLzw2hd5Alby0A+9w1PKkB0l/SAIMethcwC1gEzBy6aKVFBT3hBk/QOp5m8Zg2hf4XwKeH9pvcv31pAzwAW0QJ2B0JSlkAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABB0lEQVR4nIWROU4DQRBF368uEMjCxiBwSIaEuAZH4P4ZgSMCEhujaYJeZ8ZLMKq/vK4KRh/6jMiQiX5iAgmZgQR1CnW9++a5leWzoq3T4y5KYODxaV3LEh7zUQJlXTPww+MCRIULGNUgBFjTfef7h6sZnC7Mlxybvlvb5OppeNYBvl/pIniu9997gEtwPLnYD6shBfRlrACd7ztl7cPqL0GUYjoTKMX8d1svwG+Xu1paBcfemPhu+mb5U83o41w2VO8vd9+YBkIFUhl6rYhR8pINacHrYpsW5AdttgcFTjMdS/2Av9181QuhPMxwoM9jW1h1xN+vt5jIMARBQFkLQ9kr+5C1YRj/Y5iTbVtyNssAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMUlEQVR4nGNkYPj/n4GRgYGB8T8DOTQLg8APsjTSywAYe9QFA+ECdMWjLhhIFxA2AAB0XII03rOYTwAAAABJRU5ErkJggg=="},function(e,t){e.exports="precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D colorSampler;\nuniform vec3 background;\n\nvoid main(void)\n{\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    float scaled = floor((original.r * 255.0) + 0.5);\n    // The textures are 16x16 LUTs where each texture pixel represents a mapping from\n    // a gray value to a color\n    float ycoord = scaled/16.0;\n    float xcoord = mod(scaled, 16.0);\n    vec2 colorCoord = vec2(clamp(xcoord/16.0, 0.0, 1.0), clamp(ycoord/16.0, 0.0, 1.0));\n    if ((xcoord <= 0.0) && (ycoord <= 0.0)) {\n        gl_FragColor = vec4(background.x,background.y, background.z, 1.0); //force 0 background to background\n    } else {\n        gl_FragColor = texture2D(colorSampler, colorCoord);\n    }\n}\n"},function(e,t,n){var i,r=r||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=function(){return e.URL||e.webkitURL||e},n=e.document.createElementNS("http://www.w3.org/1999/xhtml","a"),i="download"in n,r=/constructor/i.test(e.HTMLElement)||e.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent),a=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},s=function(e){setTimeout(function(){"string"==typeof e?t().revokeObjectURL(e):e.remove()},4e4)},l=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},c=function(c,u,h){h||(c=l(c));var d,p=this,f="application/octet-stream"===c.type,g=function(){!function(e,t,n){for(var i=(t=[].concat(t)).length;i--;){var r=e["on"+t[i]];if("function"==typeof r)try{r.call(e,n||e)}catch(e){a(e)}}}(p,"writestart progress write writeend".split(" "))};if(p.readyState=p.INIT,i)return d=t().createObjectURL(c),void setTimeout(function(){n.href=d,n.download=u,function(e){var t=new MouseEvent("click");e.dispatchEvent(t)}(n),g(),s(d),p.readyState=p.DONE});!function(){if((o||f&&r)&&e.FileReader){var n=new FileReader;return n.onloadend=function(){var t=o?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,p.readyState=p.DONE,g()},n.readAsDataURL(c),void(p.readyState=p.INIT)}d||(d=t().createObjectURL(c)),f?e.location.href=d:e.open(d,"_blank")||(e.location.href=d);p.readyState=p.DONE,g(),s(d)}()},u=c.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=l(e)),navigator.msSaveOrOpenBlob(e,t)}:(u.abort=function(){},u.readyState=u.INIT=0,u.WRITING=1,u.DONE=2,u.error=u.onwritestart=u.onprogress=u.onwrite=u.onabort=u.onerror=u.onwriteend=null,function(e,t,n){return new c(e,t||e.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */void 0!==e&&e.exports?e.exports.saveAs=r:null!==n(149)&&null!==n(150)&&(void 0===(i=function(){return r}.call(t,n,t,e))||(e.exports=i))},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){var i,r,o;r=[e,n(152),n(154),n(155)],void 0===(o="function"==typeof(i=function(e,t,n,i){"use strict";var r=s(t),o=s(n),a=s(i);function s(e){return e&&e.__esModule?e:{default:e}}var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.resolveOptions(n),i.listenClick(e),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),c(t,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText,this.container="object"===l(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=(0,a.default)(e,"click",function(e){return t.onClick(e)})}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new r.default({action:this.action(t),target:this.target(t),text:this.text(t),container:this.container,trigger:t,emitter:this})}},{key:"defaultAction",value:function(e){return h("action",e)}},{key:"defaultTarget",value:function(e){var t=h("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return h("text",e)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"==typeof e?[e]:e,n=!!document.queryCommandSupported;return t.forEach(function(e){n=n&&!!document.queryCommandSupported(e)}),n}}]),t}(o.default);function h(e,t){var n="data-clipboard-"+e;if(t.hasAttribute(n))return t.getAttribute(n)}e.exports=u})?i.apply(t,r):i)||(e.exports=o)},function(e,t,n){var i,r,o;r=[e,n(153)],void 0===(o="function"==typeof(i=function(e,t){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}}(t),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resolveOptions(t),this.initSelection()}return r(e,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=e.action,this.container=e.container,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var e=this,t="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return e.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px";var i=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=i+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,n.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,n.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){this.emitter.emit(e?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(e){if(void 0!==e){if(!e||"object"!==(void 0===e?"undefined":i(e))||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(e.hasAttribute("readonly")||e.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=e}},get:function(){return this._target}}]),e}();e.exports=o})?i.apply(t,r):i)||(e.exports=o)},function(e,t){e.exports=function(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var n=e.hasAttribute("readonly");n||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),n||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var i=window.getSelection(),r=document.createRange();r.selectNodeContents(e),i.removeAllRanges(),i.addRange(r),t=i.toString()}return t}},function(e,t){function n(){}n.prototype={on:function(e,t,n){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var i=this;function r(){i.off(e,r),t.apply(n,arguments)}return r._=t,this.on(e,r,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),i=0,r=n.length;i<r;i++)n[i].fn.apply(n[i].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),i=n[e],r=[];if(i&&t)for(var o=0,a=i.length;o<a;o++)i[o].fn!==t&&i[o].fn._!==t&&r.push(i[o]);return r.length?n[e]=r:delete n[e],this}},e.exports=n},function(e,t,n){var i=n(156),r=n(157);e.exports=function(e,t,n){if(!e&&!t&&!n)throw new Error("Missing required arguments");if(!i.string(t))throw new TypeError("Second argument must be a String");if(!i.fn(n))throw new TypeError("Third argument must be a Function");if(i.node(e))return function(e,t,n){return e.addEventListener(t,n),{destroy:function(){e.removeEventListener(t,n)}}}(e,t,n);if(i.nodeList(e))return function(e,t,n){return Array.prototype.forEach.call(e,function(e){e.addEventListener(t,n)}),{destroy:function(){Array.prototype.forEach.call(e,function(e){e.removeEventListener(t,n)})}}}(e,t,n);if(i.string(e))return function(e,t,n){return r(document.body,e,t,n)}(e,t,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var n=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"==typeof e||e instanceof String},t.fn=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},function(e,t,n){var i=n(158);function r(e,t,n,r,o){var a=function(e,t,n,r){return function(n){n.delegateTarget=i(n.target,t),n.delegateTarget&&r.call(e,n)}}.apply(this,arguments);return e.addEventListener(n,a,o),{destroy:function(){e.removeEventListener(n,a,o)}}}e.exports=function(e,t,n,i,o){return"function"==typeof e.addEventListener?r.apply(null,arguments):"function"==typeof n?r.bind(null,document).apply(null,arguments):("string"==typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,function(e){return r(e,t,n,i,o)}))}},function(e,t){var n=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var i=Element.prototype;i.matches=i.matchesSelector||i.mozMatchesSelector||i.msMatchesSelector||i.oMatchesSelector||i.webkitMatchesSelector}e.exports=function(e,t){for(;e&&e.nodeType!==n;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}}},function(e,t,n){var i,r,o;
/**
 * k-d Tree JavaScript - V 1.01
 *
 * https://github.com/ubilabs/kd-tree-javascript
 *
 * @author Mircea Pricop <pricop@ubilabs.net>, 2012
 * @author Martin Kleppe <kleppe@ubilabs.net>, 2012
 * @author Ubilabs http://ubilabs.net, 2012
 * @license MIT License <http://www.opensource.org/licenses/mit-license.php>
 */r=[t],void 0===(o="function"==typeof(i=function(e){function t(e,t,n){this.obj=e,this.left=null,this.right=null,this.parent=n,this.dimension=t}function n(e){this.content=[],this.scoreFunction=e}n.prototype={push:function(e){this.content.push(e),this.bubbleUp(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.sinkDown(0)),e},peek:function(){return this.content[0]},remove:function(e){for(var t=this.content.length,n=0;n<t;n++)if(this.content[n]==e){var i=this.content.pop();return void(n!=t-1&&(this.content[n]=i,this.scoreFunction(i)<this.scoreFunction(e)?this.bubbleUp(n):this.sinkDown(n)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(e){for(var t=this.content[e];e>0;){var n=Math.floor((e+1)/2)-1,i=this.content[n];if(!(this.scoreFunction(t)<this.scoreFunction(i)))break;this.content[n]=t,this.content[e]=i,e=n}},sinkDown:function(e){for(var t=this.content.length,n=this.content[e],i=this.scoreFunction(n);;){var r=2*(e+1),o=r-1,a=null;if(o<t){var s=this.content[o],l=this.scoreFunction(s);l<i&&(a=o)}if(r<t){var c=this.content[r];this.scoreFunction(c)<(null==a?i:l)&&(a=r)}if(null==a)break;this.content[e]=this.content[a],this.content[a]=n,e=a}}},e.kdTree=function(e,i,r){var o=this;Array.isArray(e)?this.root=function e(n,i,o){var a,s,l=i%r.length;return 0===n.length?null:1===n.length?new t(n[0],l,o):(n.sort(function(e,t){return e[r[l]]-t[r[l]]}),a=Math.floor(n.length/2),(s=new t(n[a],l,o)).left=e(n.slice(0,a),i+1,s),s.right=e(n.slice(a+1),i+1,s),s)}(e,0,null):function(e){o.root=e,function e(t){t.left&&(t.left.parent=t,e(t.left)),t.right&&(t.right.parent=t,e(t.right))}(o.root)}(e),this.toJSON=function(e){e||(e=this.root);var n=new t(e.obj,e.dimension,null);return e.left&&(n.left=o.toJSON(e.left)),e.right&&(n.right=o.toJSON(e.right)),n},this.insert=function(e){var n,i,o=function t(n,i){if(null===n)return i;var o=r[n.dimension];return e[o]<n.obj[o]?t(n.left,n):t(n.right,n)}(this.root,null);null!==o?(n=new t(e,(o.dimension+1)%r.length,o),i=r[o.dimension],e[i]<o.obj[i]?o.left=n:o.right=n):this.root=new t(e,0,null)},this.remove=function(e){var t;null!==(t=function t(n){if(null===n)return null;if(n.obj===e)return n;var i=r[n.dimension];return e[i]<n.obj[i]?t(n.left,n):t(n.right,n)}(o.root))&&function e(t){function n(e,t){var i,o,a,s,l;return null===e?null:(i=r[t],e.dimension===t?null!==e.left?n(e.left,t):e:(o=e.obj[i],a=n(e.left,t),s=n(e.right,t),l=e,null!==a&&a.obj[i]<o&&(l=a),null!==s&&s.obj[i]<l.obj[i]&&(l=s),l))}var i,a,s;if(null===t.left&&null===t.right)return null===t.parent?void(o.root=null):(s=r[t.parent.dimension],void(t.obj[s]<t.parent.obj[s]?t.parent.left=null:t.parent.right=null));null!==t.right?(a=(i=n(t.right,t.dimension)).obj,e(i),t.obj=a):(a=(i=n(t.left,t.dimension)).obj,e(i),t.right=t.left,t.left=null,t.obj=a)}(t)},this.nearest=function(e,t,a){var s,l,c;if(c=new n(function(e){return-e[1]}),a)for(s=0;s<t;s+=1)c.push([null,a]);for(o.root&&function n(o){function a(e,n){c.push([e,n]),c.size()>t&&c.pop()}var s,l,u,h,d=r[o.dimension],p=i(e,o.obj),f={};for(h=0;h<r.length;h+=1)h===o.dimension?f[r[h]]=e[r[h]]:f[r[h]]=o.obj[r[h]];l=i(f,o.obj),null!==o.right||null!==o.left?(n(s=null===o.right?o.left:null===o.left?o.right:e[d]<o.obj[d]?o.left:o.right),(c.size()<t||p<c.peek()[1])&&a(o,p),(c.size()<t||Math.abs(l)<c.peek()[1])&&null!==(u=s===o.left?o.right:o.left)&&n(u)):(c.size()<t||p<c.peek()[1])&&a(o,p)}(o.root),l=[],s=0;s<Math.min(t,c.content.length);s+=1)c.content[s][0]&&l.push([c.content[s][0].obj,c.content[s][1]]);return l},this.balanceFactor=function(){return function e(t){return null===t?0:Math.max(e(t.left),e(t.right))+1}(o.root)/(Math.log(function e(t){return null===t?0:e(t.left)+e(t.right)+1}(o.root))/Math.log(2))}},e.BinaryHeap=n})?i.apply(t,r):i)||(e.exports=o)},function(e,t,n){var i,r,o;!function(n){"use strict";var a=function(e){function t(e){return"function"==typeof e}Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var n=function(t){var i=window.Legalize,r={},o="required",a="optional",s="forbidden";function l(e){return function(t){return!e(t)}}function c(e){return Array.isArray(e)?"array":null===e?"null":typeof e}function u(e){return"function"===c(e)}function h(e){return"object"===c(e)}function d(e){return"number"===c(e)}function p(e){return"string"===c(e)}function f(e){return"array"===c(e)}function g(t){return null===t||t===e}function A(n){return f(n)||p(n)||u(n)?n.length:h(n)?t.keys(n).length:e}function m(e){return g(e)||0===A(e)}function v(e,t){return e instanceof t}var b=l(g);function y(e,n){var i;if(f(e))for(i=0;i<e.length;i+=1)e[i]=n(e[i],i);else{var r=t.keys(e);for(i=0;i<r.length;i+=1){var o=r[i];e[o]=n(e[o],o)}}}function w(e,t){y(e,function(e,n){return t(e,n),e})}function S(){for(var e={},t=0;t<arguments.length;t+=1){var n=arguments[t];w(n,function(t,n){if(f(e[n])){var i=function(t){e[n].push(t)};f(t)?t.forEach(i):i(t)}else h(e[n])&&h(t)?e[n]=S(e[n],t):e[n]=t})}return e}function E(e,t){return h(t)&&w(t,function(n,i){e[i]=t[i]}),e}function _(e,n){if(!f(e)&&!h(e))return e===n||e!=e&&n!=n;if(A(e)!==A(n))return!1;for(var i=S({x:t.keys(e)},{x:t.keys(n)}).x,r=0;r<i.length;r+=1){var o=i[r];if(!_(e[o],n[o]))return!1}return!0}function R(e){if(e._isSchema)return e;if(e._isSchemaBuilder&&u(e.compile))return e.compile();if(v(e,RegExp))return r.string().match(e).compile();if(f(e)){var t=r.alternatives;return t.apply(r,e).compile()}return h(e)?r.object().keys(e).compile():r.any().valid(e).compile()}function x(e,n,i){return function(){var r=Array.prototype.slice.call(arguments),o=t.create(this),a=this;return E(o,n),o.compile=function(t){var n=S(a.compile(!0),u(e)?e(r):e);if(!t){var o=function(e){return R(e)};y(n.includes,o),y(n.excludes,o),y(n.keys,o),y(n.alternatives,o)}return n._isSchema=!0,n._isType=!!i||null,n},o}}function C(e){return x(function(t){var n={};return n[e]=t[0],n})}function I(e){return x(function(t){var n={};return n[e]=t,n})}function T(e){return x(function(t){return{checks:function(n){return e(n,t[0])}}})}function P(e){return T(function(t){return e.test(t)})}function O(e,t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(e,n)}}function k(e){return S(e,{minLength:T(function(e,t){return A(e)>=t}),maxLength:T(function(e,t){return A(e)<=t}),length:T(function(e,t){return A(e)===t})})}var M,L,B={_isSchemaBuilder:!0,compile:function(){return{allowed:[],valid:[],invalid:[],checks:[],checksAfter:[],alias:{},keys:{},includes:[],excludes:[],alternatives:[],sanitizeBefore:[],sanitize:[],pattern:null,_isSchema:!0}},notEmpty:T(l(m)),allow:I("allowed"),valid:I("valid"),invalid:I("invalid"),alias:C("alias"),check:I("checksAfter"),satisfy:I("checks"),sanitize:I("sanitize"),sanitizeBefore:I("sanitizeBefore"),required:x({presence:o}),optional:x({presence:a}),forbidden:x({presence:s}),default:C("defaultValue")},D=x({}),N=x({type:"boolean"}),U=x({type:"function"},k({})),V=x({type:"number"},{min:T(function(e,t){return e>=t}),max:T(function(e,t){return e<=t}),greater:T(function(e,t){return e>t}),lesser:T(function(e,t){return e<t}),integer:T(function(e){return parseInt(e)===Number(e)})}),j=x({type:"string"},k({match:T(function(e,t){return new RegExp(t).test(e)}),insensitive:x({insensitive:!0}),lowercase:T(function(e){return(e=String(e)).toLowerCase()===e}),uppercase:T(function(e){return(e=String(e)).toUpperCase()===e}),alphanum:P(/^[0-9a-zA-Z]*$/),url:P(/^https?:\/\/(\w+:?\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/),element:T(function(e){return!!window.document.getElementById(e)}),digits:T(/^[0-9]*$/),numeric:T(function(e){var t=Number(e);return t==t})})),F=x({type:"array"},k({unique:T(function(e){for(var t={},n=0;n<e.length;n+=1){var i=e[n];if(d(i)||p(i)){if(t[i])return!1;t[i]=!0}}return!0}),includes:I("includes"),excludes:I("excludes")})),z=x({type:"object"},k({keys:C("keys"),type:x(function(e){return{checks:function(t){return v(t,e[0])}}},e,!0),pattern:C("pattern")})),G=I("alternatives");return r=t.freeze({any:O(B,D),bool:O(B,N),boolean:O(B,N),number:O(B,V),string:O(B,j),object:O(B,z),array:O(B,F),func:O(B,U),alternatives:O(B,G),compile:R,validate:function t(n,i,r,l){l=u(l)?l:u(r)?r:null;r=h(r)?r:{};if(m(r))r=L;else{var d=t(r,M);if(d.error)throw new Error(d.error);r=d.value}i=R(i);var g=[];var A=function t(n,i,l){var u=c(n);var d=i.presence||r.presence;var A=i.defaultValue;var v=i.type;function y(e,t,i){return{type:e,expected:t,actual:i,sourcePath:l,sourceValue:n}}function S(e,t,n){g.push(h(e)?e:y(e,t,n))}function x(e){return{value:e}}function C(e,t,n,i){var o=y(t,n,i);return b(A)&&d===a&&r.warnOnInvalidOptionals?(S(o),x(e)):{error:o,value:e}}var I=0,T=0;if("undefined"===u)return d===a?x(A):d===o?C(e,"required_missing"):x();if(d===s)return C(e,"forbidden_encountered");var P=i.alternatives;if(!m(P)){for(I=0;I<P.length;I+=1){var O=P[I],k=t(n,O,l);if(!k.error)return k}return C(A,"no_alternative_matched")}w(i.sanitizeBefore,function(e){n=e(n)});var M=i.alias;b(M[n])&&(n=M[n]);if(b(v)&&u!==v){if(r.strict)return C(A,"mismatching_types",v,u);S("mismatching_types",v,u),n=function(t,n){if(c(t)===n)return t;switch(n){case"string":return String(t);case"number":return Number(t);case"boolean":return"true"===t||"false"!==t&&Boolean(Number(t));default:return e}}(n,v)}var L=i.allowed;for(I=0;I<L.length;I+=1)if(_(L[I],n))return x(n);var B=i.invalid;for(I=0;I<B.length;I+=1)if(_(B[I],n))return C(A,"invalid_value");var D=i.valid;if(!m(D)){for(I=0;I<D.length;I+=1)if(_(D[I],n))return x(n);return C(A,"not_a_valid_value")}var N=[];w(i.checks,function(e){var t;try{t=e(n)}catch(e){return console.log("Error while executing user-defined function"),console.log(e),!1}!0!==t&&(h(t)||(t=y("check_failed")),N.push(t))});if(!m(N))return C(A,"checks_failed");if("object"===v){var U={},V=[];if(i._isType)U=n;else{w(i.keys,function(e,i){var o=t(n[i],e,l+"/"+i);if(o.error){var s=e.presence||r.presence;s===a&&r.warnOnInvalidOptionals?S(o.error):V.push(o.error)}U[i]=o.value,delete n[i]});var j=null,F=null;if(i.pattern&&(f(i.pattern)&&i.pattern.length>=2?(j=i.pattern[0],F=R(i.pattern[1])):j=i.pattern,w(n,function(n,o){if(!i.keys[o]){var s=y("unknown_key",e,o),c=!r.stripUnknown;if(j&&j.test(o)?c=!0:r.allowUnknown?r.warnUnknown&&S(s):V.push(s),c)if(F){var u=t(n,F,l+"/"+o);if(u.error){var h=n.presence||r.presence;h===a&&r.warnOnInvalidOptionals?S(u.error):V.push(u.error)}U[o]=u.value}else U[o]=n}})),!m(V))return C(U,V);n=U}}else if("array"===v){var z=[],G=[],Q=i.includes,Y=i.excludes;if(m(Q)?m(Y)?z=n:w(n,function(e){var n,i=!0;for(T=0;T<Y.length;T+=1)if(!(n=t(e,Y[T],l+"/"+I)).error){i=!1;break}i?z.push(n.value):G.push(y("matched_excluded_type"))}):w(n,function(e){var n,i=!1;for(T=0;T<Q.length;T+=1)if(!(n=t(e,Q[T],l+"/"+I)).error){i=!0;break}i?z.push(n.value):G.push(n.error)}),!m(G))return C(z,G);n=z}w(i.checksAfter,function(e){var t;try{t=e(n)}catch(e){return console.log("Error while executing user-defined function"),console.log(e),!1}!0!==t&&function e(t){f(t)?w(t,function(t){e(t)}):p(t)?e(y(t)):h(t)&&S(E(y(),t))}(t)});w(i.sanitize,function(e){n=e(n)});return x(n)}(n,i,"");var v=A.error?function e(t,n){f(t.type)?w(t.type,function(t){e(t,n)}):n.push(t);return n}(A.error,[]):null;var y=A.value;g=m(g)?null:g;if(!u(l))return{error:v,value:y,warnings:g};setTimeout(function(){l(v,y,g)},0)},typeOf:c,noConflict:function(){window.Legalize===n&&(window.Legalize=i);return n}}),M=R({allowUnknown:r.bool().default(!1),stripUnknown:r.bool().default(!0),warnUnknown:r.bool().default(!0),strict:r.bool().default(!0),warnOnInvalidOptionals:r.bool().default(!0),presence:r.any().valid(a).valid(o).valid(s).default(a)}),L={allowUnknown:!1,stripUnknown:!0,warnUnknown:!0,strict:!0,warnOnInvalidOptionals:!0,presence:a},r}({freeze:t(Object.freeze)?Object.freeze:function(e){return e},keys:t(Object.keys)?Object.keys:function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=n.length;return function(r){var o,a,s=[];for(o in r)e.call(r,o)&&s.push(o);if(t)for(a=0;a<i;a+=1)e.call(r,n[a])&&s.push(n[a]);return s}}(),create:t(Object.create)?Object.create:function(e){function t(){}return t.prototype=e,new t}});return n}();"undefined"!=typeof window?window.Legalize=a:this.Legalize=a,r=[],void 0===(o="function"==typeof(i=a)?i.apply(t,r):i)||(e.exports=o)}()},function(e,t,n){"use strict";var i=n(162),r=n(3),o=n(32),a=n(11),s=n(33),l=Object.prototype.toString,c=0,u=-1,h=0,d=8;function p(e){if(!(this instanceof p))return new p(e);this.options=r.assign({level:u,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=i.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==c)throw new Error(a[n]);if(t.header&&i.deflateSetHeader(this.strm,t.header),t.dictionary){var f;if(f="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=i.deflateSetDictionary(this.strm,f))!==c)throw new Error(a[n]);this._dict_set=!0}}function f(e,t){var n=new p(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}p.prototype.push=function(e,t){var n,a,s=this.strm,u=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=o.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new r.Buf8(u),s.next_out=0,s.avail_out=u),1!==(n=i.deflate(s,a))&&n!==c)return this.onEnd(n),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(r.shrinkBuf(s.output,s.next_out))):this.onData(r.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==n);return 4===a?(n=i.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===c):2!==a||(this.onEnd(c),s.avail_out=0,!0)},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=p,t.deflate=f,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,f(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,f(e,t)}},function(e,t,n){"use strict";var i,r=n(3),o=n(163),a=n(30),s=n(31),l=n(11),c=0,u=1,h=3,d=4,p=5,f=0,g=1,A=-2,m=-3,v=-5,b=-1,y=1,w=2,S=3,E=4,_=0,R=2,x=8,C=9,I=15,T=8,P=286,O=30,k=19,M=2*P+1,L=15,B=3,D=258,N=D+B+1,U=32,V=42,j=69,F=73,z=91,G=103,Q=113,Y=666,W=1,H=2,K=3,q=4,X=3;function J(e,t){return e.msg=l[t],t}function Z(e){return(e<<1)-(e>4?9:0)}function $(e){for(var t=e.length;--t>=0;)e[t]=0}function ee(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(r.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function te(e,t){o._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ee(e.strm)}function ne(e,t){e.pending_buf[e.pending++]=t}function ie(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function re(e,t,n,i){var o=e.avail_in;return o>i&&(o=i),0===o?0:(e.avail_in-=o,r.arraySet(t,e.input,e.next_in,o,n),1===e.state.wrap?e.adler=a(e.adler,t,o,n):2===e.state.wrap&&(e.adler=s(e.adler,t,o,n)),e.next_in+=o,e.total_in+=o,o)}function oe(e,t){var n,i,r=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-N?e.strstart-(e.w_size-N):0,c=e.window,u=e.w_mask,h=e.prev,d=e.strstart+D,p=c[o+a-1],f=c[o+a];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(n=t)+a]===f&&c[n+a-1]===p&&c[n]===c[o]&&c[++n]===c[o+1]){o+=2,n++;do{}while(c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&o<d);if(i=D-(d-o),o=d-D,i>a){if(e.match_start=t,a=i,i>=s)break;p=c[o+a-1],f=c[o+a]}}}while((t=h[t&u])>l&&0!=--r);return a<=e.lookahead?a:e.lookahead}function ae(e){var t,n,i,o,a,s=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=s+(s-N)){r.arraySet(e.window,e.window,s,s,0),e.match_start-=s,e.strstart-=s,e.block_start-=s,t=n=e.hash_size;do{i=e.head[--t],e.head[t]=i>=s?i-s:0}while(--n);t=n=s;do{i=e.prev[--t],e.prev[t]=i>=s?i-s:0}while(--n);o+=s}if(0===e.strm.avail_in)break;if(n=re(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=n,e.lookahead+e.insert>=B)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+B-1])&e.hash_mask,e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<B)););}while(e.lookahead<N&&0!==e.strm.avail_in)}function se(e,t){for(var n,i;;){if(e.lookahead<N){if(ae(e),e.lookahead<N&&t===c)return W;if(0===e.lookahead)break}if(n=0,e.lookahead>=B&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+B-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-N&&(e.match_length=oe(e,n)),e.match_length>=B)if(i=o._tr_tally(e,e.strstart-e.match_start,e.match_length-B),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=B){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+B-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=e.strstart<B-1?e.strstart:B-1,t===d?(te(e,!0),0===e.strm.avail_out?K:q):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:H}function le(e,t){for(var n,i,r;;){if(e.lookahead<N){if(ae(e),e.lookahead<N&&t===c)return W;if(0===e.lookahead)break}if(n=0,e.lookahead>=B&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+B-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=B-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-N&&(e.match_length=oe(e,n),e.match_length<=5&&(e.strategy===y||e.match_length===B&&e.strstart-e.match_start>4096)&&(e.match_length=B-1)),e.prev_length>=B&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-B,i=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-B),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+B-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=B-1,e.strstart++,i&&(te(e,!1),0===e.strm.avail_out))return W}else if(e.match_available){if((i=o._tr_tally(e,0,e.window[e.strstart-1]))&&te(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return W}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<B-1?e.strstart:B-1,t===d?(te(e,!0),0===e.strm.avail_out?K:q):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:H}function ce(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}function ue(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=R,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?V:Q,e.adler=2===t.wrap?0:1,t.last_flush=c,o._tr_init(t),f):J(e,A)}function he(e){var t=ue(e);return t===f&&function(e){e.window_size=2*e.w_size,$(e.head),e.max_lazy_match=i[e.level].max_lazy,e.good_match=i[e.level].good_length,e.nice_match=i[e.level].nice_length,e.max_chain_length=i[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=B-1,e.match_available=0,e.ins_h=0}(e.state),t}function de(e,t,n,i,o,a){if(!e)return A;var s=1;if(t===b&&(t=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),o<1||o>C||n!==x||i<8||i>15||t<0||t>9||a<0||a>E)return J(e,A);8===i&&(i=9);var l=new function(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*M),this.dyn_dtree=new r.Buf16(2*(2*O+1)),this.bl_tree=new r.Buf16(2*(2*k+1)),$(this.dyn_ltree),$(this.dyn_dtree),$(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(L+1),this.heap=new r.Buf16(2*P+1),$(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*P+1),$(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0};return e.state=l,l.strm=e,l.wrap=s,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+B-1)/B),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=n,he(e)}i=[new ce(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(ae(e),0===e.lookahead&&t===c)return W;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,te(e,!1),0===e.strm.avail_out))return W;if(e.strstart-e.block_start>=e.w_size-N&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=0,t===d?(te(e,!0),0===e.strm.avail_out?K:q):(e.strstart>e.block_start&&(te(e,!1),e.strm.avail_out),W)}),new ce(4,4,8,4,se),new ce(4,5,16,8,se),new ce(4,6,32,32,se),new ce(4,4,16,16,le),new ce(8,16,32,32,le),new ce(8,16,128,128,le),new ce(8,32,128,256,le),new ce(32,128,258,1024,le),new ce(32,258,258,4096,le)],t.deflateInit=function(e,t){return de(e,t,x,I,T,_)},t.deflateInit2=de,t.deflateReset=he,t.deflateResetKeep=ue,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?A:(e.state.gzhead=t,f):A},t.deflate=function(e,t){var n,r,a,l;if(!e||!e.state||t>p||t<0)return e?J(e,A):A;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||r.status===Y&&t!==d)return J(e,0===e.avail_out?v:A);if(r.strm=e,n=r.last_flush,r.last_flush=t,r.status===V)if(2===r.wrap)e.adler=0,ne(r,31),ne(r,139),ne(r,8),r.gzhead?(ne(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),ne(r,255&r.gzhead.time),ne(r,r.gzhead.time>>8&255),ne(r,r.gzhead.time>>16&255),ne(r,r.gzhead.time>>24&255),ne(r,9===r.level?2:r.strategy>=w||r.level<2?4:0),ne(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(ne(r,255&r.gzhead.extra.length),ne(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=s(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=j):(ne(r,0),ne(r,0),ne(r,0),ne(r,0),ne(r,0),ne(r,9===r.level?2:r.strategy>=w||r.level<2?4:0),ne(r,X),r.status=Q);else{var m=x+(r.w_bits-8<<4)<<8;m|=(r.strategy>=w||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(m|=U),m+=31-m%31,r.status=Q,ie(r,m),0!==r.strstart&&(ie(r,e.adler>>>16),ie(r,65535&e.adler)),e.adler=1}if(r.status===j)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),ee(e),a=r.pending,r.pending!==r.pending_buf_size));)ne(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=F)}else r.status=F;if(r.status===F)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),ee(e),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,ne(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.gzindex=0,r.status=z)}else r.status=z;if(r.status===z)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),ee(e),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,ne(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.status=G)}else r.status=G;if(r.status===G&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&ee(e),r.pending+2<=r.pending_buf_size&&(ne(r,255&e.adler),ne(r,e.adler>>8&255),e.adler=0,r.status=Q)):r.status=Q),0!==r.pending){if(ee(e),0===e.avail_out)return r.last_flush=-1,f}else if(0===e.avail_in&&Z(t)<=Z(n)&&t!==d)return J(e,v);if(r.status===Y&&0!==e.avail_in)return J(e,v);if(0!==e.avail_in||0!==r.lookahead||t!==c&&r.status!==Y){var b=r.strategy===w?function(e,t){for(var n;;){if(0===e.lookahead&&(ae(e),0===e.lookahead)){if(t===c)return W;break}if(e.match_length=0,n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=0,t===d?(te(e,!0),0===e.strm.avail_out?K:q):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:H}(r,t):r.strategy===S?function(e,t){for(var n,i,r,a,s=e.window;;){if(e.lookahead<=D){if(ae(e),e.lookahead<=D&&t===c)return W;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=B&&e.strstart>0&&(i=s[r=e.strstart-1])===s[++r]&&i===s[++r]&&i===s[++r]){a=e.strstart+D;do{}while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<a);e.match_length=D-(a-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=B?(n=o._tr_tally(e,1,e.match_length-B),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=0,t===d?(te(e,!0),0===e.strm.avail_out?K:q):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:H}(r,t):i[r.level].func(r,t);if(b!==K&&b!==q||(r.status=Y),b===W||b===K)return 0===e.avail_out&&(r.last_flush=-1),f;if(b===H&&(t===u?o._tr_align(r):t!==p&&(o._tr_stored_block(r,0,0,!1),t===h&&($(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),ee(e),0===e.avail_out))return r.last_flush=-1,f}return t!==d?f:r.wrap<=0?g:(2===r.wrap?(ne(r,255&e.adler),ne(r,e.adler>>8&255),ne(r,e.adler>>16&255),ne(r,e.adler>>24&255),ne(r,255&e.total_in),ne(r,e.total_in>>8&255),ne(r,e.total_in>>16&255),ne(r,e.total_in>>24&255)):(ie(r,e.adler>>>16),ie(r,65535&e.adler)),ee(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?f:g)},t.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==V&&t!==j&&t!==F&&t!==z&&t!==G&&t!==Q&&t!==Y?J(e,A):(e.state=null,t===Q?J(e,m):f):A},t.deflateSetDictionary=function(e,t){var n,i,o,s,l,c,u,h,d=t.length;if(!e||!e.state)return A;if(2===(s=(n=e.state).wrap)||1===s&&n.status!==V||n.lookahead)return A;for(1===s&&(e.adler=a(e.adler,t,d,0)),n.wrap=0,d>=n.w_size&&(0===s&&($(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new r.Buf8(n.w_size),r.arraySet(h,t,d-n.w_size,n.w_size,0),t=h,d=n.w_size),l=e.avail_in,c=e.next_in,u=e.input,e.avail_in=d,e.next_in=0,e.input=t,ae(n);n.lookahead>=B;){i=n.strstart,o=n.lookahead-(B-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+B-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++}while(--o);n.strstart=i,n.lookahead=B-1,ae(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=B-1,n.match_available=0,e.next_in=c,e.input=u,e.avail_in=l,n.wrap=s,f},t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,n){"use strict";var i=n(3),r=4,o=0,a=1,s=2;function l(e){for(var t=e.length;--t>=0;)e[t]=0}var c=0,u=1,h=2,d=29,p=256,f=p+1+d,g=30,A=19,m=2*f+1,v=15,b=16,y=7,w=256,S=16,E=17,_=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],x=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],T=new Array(2*(f+2));l(T);var P=new Array(2*g);l(P);var O=new Array(512);l(O);var k=new Array(256);l(k);var M=new Array(d);l(M);var L,B,D,N=new Array(g);function U(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}function V(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function j(e){return e<256?O[e]:O[256+(e>>>7)]}function F(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function z(e,t,n){e.bi_valid>b-n?(e.bi_buf|=t<<e.bi_valid&65535,F(e,e.bi_buf),e.bi_buf=t>>b-e.bi_valid,e.bi_valid+=n-b):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function G(e,t,n){z(e,n[2*t],n[2*t+1])}function Q(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function Y(e,t,n){var i,r,o=new Array(v+1),a=0;for(i=1;i<=v;i++)o[i]=a=a+n[i-1]<<1;for(r=0;r<=t;r++){var s=e[2*r+1];0!==s&&(e[2*r]=Q(o[s]++,s))}}function W(e){var t;for(t=0;t<f;t++)e.dyn_ltree[2*t]=0;for(t=0;t<g;t++)e.dyn_dtree[2*t]=0;for(t=0;t<A;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*w]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function H(e){e.bi_valid>8?F(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function K(e,t,n,i){var r=2*t,o=2*n;return e[r]<e[o]||e[r]===e[o]&&i[t]<=i[n]}function q(e,t,n){for(var i=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&K(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!K(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i}function X(e,t,n){var i,r,o,a,s=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],r=e.pending_buf[e.l_buf+s],s++,0===i?G(e,r,t):(G(e,(o=k[r])+p+1,t),0!==(a=R[o])&&z(e,r-=M[o],a),G(e,o=j(--i),n),0!==(a=x[o])&&z(e,i-=N[o],a))}while(s<e.last_lit);G(e,w,t)}function J(e,t){var n,i,r,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=m,n=0;n<l;n++)0!==o[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(r=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[r]=0,e.opt_len--,s&&(e.static_len-=a[2*r+1]);for(t.max_code=c,n=e.heap_len>>1;n>=1;n--)q(e,o,n);r=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],q(e,o,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,o[2*r]=o[2*n]+o[2*i],e.depth[r]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,o[2*n+1]=o[2*i+1]=r,e.heap[1]=r++,q(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,i,r,o,a,s,l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,f=t.stat_desc.max_length,g=0;for(o=0;o<=v;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<m;n++)(o=l[2*l[2*(i=e.heap[n])+1]+1]+1)>f&&(o=f,g++),l[2*i+1]=o,i>c||(e.bl_count[o]++,a=0,i>=p&&(a=d[i-p]),s=l[2*i],e.opt_len+=s*(o+a),h&&(e.static_len+=s*(u[2*i+1]+a)));if(0!==g){do{for(o=f-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[f]--,g-=2}while(g>0);for(o=f;0!==o;o--)for(i=e.bl_count[o];0!==i;)(r=e.heap[--n])>c||(l[2*r+1]!==o&&(e.opt_len+=(o-l[2*r+1])*l[2*r],l[2*r+1]=o),i--)}}(e,t),Y(o,c,e.bl_count)}function Z(e,t,n){var i,r,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=a,a=t[2*(i+1)+1],++s<l&&r===a||(s<c?e.bl_tree[2*r]+=s:0!==r?(r!==o&&e.bl_tree[2*r]++,e.bl_tree[2*S]++):s<=10?e.bl_tree[2*E]++:e.bl_tree[2*_]++,s=0,o=r,0===a?(l=138,c=3):r===a?(l=6,c=3):(l=7,c=4))}function $(e,t,n){var i,r,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),i=0;i<=n;i++)if(r=a,a=t[2*(i+1)+1],!(++s<l&&r===a)){if(s<c)do{G(e,r,e.bl_tree)}while(0!=--s);else 0!==r?(r!==o&&(G(e,r,e.bl_tree),s--),G(e,S,e.bl_tree),z(e,s-3,2)):s<=10?(G(e,E,e.bl_tree),z(e,s-3,3)):(G(e,_,e.bl_tree),z(e,s-11,7));s=0,o=r,0===a?(l=138,c=3):r===a?(l=6,c=3):(l=7,c=4)}}l(N);var ee=!1;function te(e,t,n,r){z(e,(c<<1)+(r?1:0),3),function(e,t,n,r){H(e),r&&(F(e,n),F(e,~n)),i.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}t._tr_init=function(e){ee||(function(){var e,t,n,i,r,o=new Array(v+1);for(n=0,i=0;i<d-1;i++)for(M[i]=n,e=0;e<1<<R[i];e++)k[n++]=i;for(k[n-1]=i,r=0,i=0;i<16;i++)for(N[i]=r,e=0;e<1<<x[i];e++)O[r++]=i;for(r>>=7;i<g;i++)for(N[i]=r<<7,e=0;e<1<<x[i]-7;e++)O[256+r++]=i;for(t=0;t<=v;t++)o[t]=0;for(e=0;e<=143;)T[2*e+1]=8,e++,o[8]++;for(;e<=255;)T[2*e+1]=9,e++,o[9]++;for(;e<=279;)T[2*e+1]=7,e++,o[7]++;for(;e<=287;)T[2*e+1]=8,e++,o[8]++;for(Y(T,f+1,o),e=0;e<g;e++)P[2*e+1]=5,P[2*e]=Q(e,5);L=new U(T,R,p+1,f,v),B=new U(P,x,0,g,v),D=new U(new Array(0),C,0,A,y)}(),ee=!0),e.l_desc=new V(e.dyn_ltree,L),e.d_desc=new V(e.dyn_dtree,B),e.bl_desc=new V(e.bl_tree,D),e.bi_buf=0,e.bi_valid=0,W(e)},t._tr_stored_block=te,t._tr_flush_block=function(e,t,n,i){var l,c,d=0;e.level>0?(e.strm.data_type===s&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return o;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return a;for(t=32;t<p;t++)if(0!==e.dyn_ltree[2*t])return a;return o}(e)),J(e,e.l_desc),J(e,e.d_desc),d=function(e){var t;for(Z(e,e.dyn_ltree,e.l_desc.max_code),Z(e,e.dyn_dtree,e.d_desc.max_code),J(e,e.bl_desc),t=A-1;t>=3&&0===e.bl_tree[2*I[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),l=e.opt_len+3+7>>>3,(c=e.static_len+3+7>>>3)<=l&&(l=c)):l=c=n+5,n+4<=l&&-1!==t?te(e,t,n,i):e.strategy===r||c===l?(z(e,(u<<1)+(i?1:0),3),X(e,T,P)):(z(e,(h<<1)+(i?1:0),3),function(e,t,n,i){var r;for(z(e,t-257,5),z(e,n-1,5),z(e,i-4,4),r=0;r<i;r++)z(e,e.bl_tree[2*I[r]+1],3);$(e,e.dyn_ltree,t-1),$(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,d+1),X(e,e.dyn_ltree,e.dyn_dtree)),W(e),i&&H(e)},t._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(k[n]+p+1)]++,e.dyn_dtree[2*j(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){z(e,u<<1,3),G(e,w,T),function(e){16===e.bi_valid?(F(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},function(e,t,n){"use strict";var i=n(165),r=n(3),o=n(32),a=n(34),s=n(11),l=n(33),c=n(168),u=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=i.inflateInit2(this.strm,t.windowBits);if(n!==a.Z_OK)throw new Error(s[n]);if(this.header=new c,i.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=o.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=i.inflateSetDictionary(this.strm,t.dictionary))!==a.Z_OK))throw new Error(s[n])}function d(e,t){var n=new h(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}h.prototype.push=function(e,t){var n,s,l,c,h,d=this.strm,p=this.options.chunkSize,f=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?d.input=o.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new r.Buf8(p),d.next_out=0,d.avail_out=p),(n=i.inflate(d,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&f&&(n=i.inflateSetDictionary(this.strm,f)),n===a.Z_BUF_ERROR&&!0===g&&(n=a.Z_OK,g=!1),n!==a.Z_STREAM_END&&n!==a.Z_OK)return this.onEnd(n),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&n!==a.Z_STREAM_END&&(0!==d.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(d.output,d.next_out),c=d.next_out-l,h=o.buf2string(d.output,l),d.next_out=c,d.avail_out=p-c,c&&r.arraySet(d.output,d.output,l,c,0),this.onData(h)):this.onData(r.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(g=!0)}while((d.avail_in>0||0===d.avail_out)&&n!==a.Z_STREAM_END);return n===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(n=i.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),d.avail_out=0,!0)},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=h,t.inflate=d,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},t.ungzip=d},function(e,t,n){"use strict";var i=n(3),r=n(30),o=n(31),a=n(166),s=n(167),l=0,c=1,u=2,h=4,d=5,p=6,f=0,g=1,A=2,m=-2,v=-3,b=-4,y=-5,w=8,S=1,E=2,_=3,R=4,x=5,C=6,I=7,T=8,P=9,O=10,k=11,M=12,L=13,B=14,D=15,N=16,U=17,V=18,j=19,F=20,z=21,G=22,Q=23,Y=24,W=25,H=26,K=27,q=28,X=29,J=30,Z=31,$=32,ee=852,te=592,ne=15;function ie(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function re(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=S,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(ee),t.distcode=t.distdyn=new i.Buf32(te),t.sane=1,t.back=-1,f):m}function oe(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,re(e)):m}function ae(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?m:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,oe(e))):m}function se(e,t){var n,r;return e?(r=new function(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},e.state=r,r.window=null,(n=ae(e,t))!==f&&(e.state=null),n):m}var le,ce,ue=!0;function he(e){if(ue){var t;for(le=new i.Buf32(512),ce=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(c,e.lens,0,288,le,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(u,e.lens,0,32,ce,0,e.work,{bits:5}),ue=!1}e.lencode=le,e.lenbits=9,e.distcode=ce,e.distbits=5}function de(e,t,n,r){var o,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new i.Buf8(a.wsize)),r>=a.wsize?(i.arraySet(a.window,t,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>r&&(o=r),i.arraySet(a.window,t,n-r,o,a.wnext),(r-=o)?(i.arraySet(a.window,t,n-r,r,0),a.wnext=r,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}t.inflateReset=oe,t.inflateReset2=ae,t.inflateResetKeep=re,t.inflateInit=function(e){return se(e,ne)},t.inflateInit2=se,t.inflate=function(e,t){var n,ee,te,ne,re,oe,ae,se,le,ce,ue,pe,fe,ge,Ae,me,ve,be,ye,we,Se,Ee,_e,Re,xe=0,Ce=new i.Buf8(4),Ie=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return m;(n=e.state).mode===M&&(n.mode=L),re=e.next_out,te=e.output,ae=e.avail_out,ne=e.next_in,ee=e.input,oe=e.avail_in,se=n.hold,le=n.bits,ce=oe,ue=ae,Ee=f;e:for(;;)switch(n.mode){case S:if(0===n.wrap){n.mode=L;break}for(;le<16;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}if(2&n.wrap&&35615===se){n.check=0,Ce[0]=255&se,Ce[1]=se>>>8&255,n.check=o(n.check,Ce,2,0),se=0,le=0,n.mode=E;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&se)<<8)+(se>>8))%31){e.msg="incorrect header check",n.mode=J;break}if((15&se)!==w){e.msg="unknown compression method",n.mode=J;break}if(le-=4,Se=8+(15&(se>>>=4)),0===n.wbits)n.wbits=Se;else if(Se>n.wbits){e.msg="invalid window size",n.mode=J;break}n.dmax=1<<Se,e.adler=n.check=1,n.mode=512&se?O:M,se=0,le=0;break;case E:for(;le<16;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}if(n.flags=se,(255&n.flags)!==w){e.msg="unknown compression method",n.mode=J;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=J;break}n.head&&(n.head.text=se>>8&1),512&n.flags&&(Ce[0]=255&se,Ce[1]=se>>>8&255,n.check=o(n.check,Ce,2,0)),se=0,le=0,n.mode=_;case _:for(;le<32;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}n.head&&(n.head.time=se),512&n.flags&&(Ce[0]=255&se,Ce[1]=se>>>8&255,Ce[2]=se>>>16&255,Ce[3]=se>>>24&255,n.check=o(n.check,Ce,4,0)),se=0,le=0,n.mode=R;case R:for(;le<16;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}n.head&&(n.head.xflags=255&se,n.head.os=se>>8),512&n.flags&&(Ce[0]=255&se,Ce[1]=se>>>8&255,n.check=o(n.check,Ce,2,0)),se=0,le=0,n.mode=x;case x:if(1024&n.flags){for(;le<16;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}n.length=se,n.head&&(n.head.extra_len=se),512&n.flags&&(Ce[0]=255&se,Ce[1]=se>>>8&255,n.check=o(n.check,Ce,2,0)),se=0,le=0}else n.head&&(n.head.extra=null);n.mode=C;case C:if(1024&n.flags&&((pe=n.length)>oe&&(pe=oe),pe&&(n.head&&(Se=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,ee,ne,pe,Se)),512&n.flags&&(n.check=o(n.check,ee,pe,ne)),oe-=pe,ne+=pe,n.length-=pe),n.length))break e;n.length=0,n.mode=I;case I:if(2048&n.flags){if(0===oe)break e;pe=0;do{Se=ee[ne+pe++],n.head&&Se&&n.length<65536&&(n.head.name+=String.fromCharCode(Se))}while(Se&&pe<oe);if(512&n.flags&&(n.check=o(n.check,ee,pe,ne)),oe-=pe,ne+=pe,Se)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=T;case T:if(4096&n.flags){if(0===oe)break e;pe=0;do{Se=ee[ne+pe++],n.head&&Se&&n.length<65536&&(n.head.comment+=String.fromCharCode(Se))}while(Se&&pe<oe);if(512&n.flags&&(n.check=o(n.check,ee,pe,ne)),oe-=pe,ne+=pe,Se)break e}else n.head&&(n.head.comment=null);n.mode=P;case P:if(512&n.flags){for(;le<16;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}if(se!==(65535&n.check)){e.msg="header crc mismatch",n.mode=J;break}se=0,le=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=M;break;case O:for(;le<32;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}e.adler=n.check=ie(se),se=0,le=0,n.mode=k;case k:if(0===n.havedict)return e.next_out=re,e.avail_out=ae,e.next_in=ne,e.avail_in=oe,n.hold=se,n.bits=le,A;e.adler=n.check=1,n.mode=M;case M:if(t===d||t===p)break e;case L:if(n.last){se>>>=7&le,le-=7&le,n.mode=K;break}for(;le<3;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}switch(n.last=1&se,le-=1,3&(se>>>=1)){case 0:n.mode=B;break;case 1:if(he(n),n.mode=F,t===p){se>>>=2,le-=2;break e}break;case 2:n.mode=U;break;case 3:e.msg="invalid block type",n.mode=J}se>>>=2,le-=2;break;case B:for(se>>>=7&le,le-=7&le;le<32;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}if((65535&se)!=(se>>>16^65535)){e.msg="invalid stored block lengths",n.mode=J;break}if(n.length=65535&se,se=0,le=0,n.mode=D,t===p)break e;case D:n.mode=N;case N:if(pe=n.length){if(pe>oe&&(pe=oe),pe>ae&&(pe=ae),0===pe)break e;i.arraySet(te,ee,ne,pe,re),oe-=pe,ne+=pe,ae-=pe,re+=pe,n.length-=pe;break}n.mode=M;break;case U:for(;le<14;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}if(n.nlen=257+(31&se),se>>>=5,le-=5,n.ndist=1+(31&se),se>>>=5,le-=5,n.ncode=4+(15&se),se>>>=4,le-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=J;break}n.have=0,n.mode=V;case V:for(;n.have<n.ncode;){for(;le<3;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}n.lens[Ie[n.have++]]=7&se,se>>>=3,le-=3}for(;n.have<19;)n.lens[Ie[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,_e={bits:n.lenbits},Ee=s(l,n.lens,0,19,n.lencode,0,n.work,_e),n.lenbits=_e.bits,Ee){e.msg="invalid code lengths set",n.mode=J;break}n.have=0,n.mode=j;case j:for(;n.have<n.nlen+n.ndist;){for(;me=(xe=n.lencode[se&(1<<n.lenbits)-1])>>>16&255,ve=65535&xe,!((Ae=xe>>>24)<=le);){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}if(ve<16)se>>>=Ae,le-=Ae,n.lens[n.have++]=ve;else{if(16===ve){for(Re=Ae+2;le<Re;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}if(se>>>=Ae,le-=Ae,0===n.have){e.msg="invalid bit length repeat",n.mode=J;break}Se=n.lens[n.have-1],pe=3+(3&se),se>>>=2,le-=2}else if(17===ve){for(Re=Ae+3;le<Re;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}le-=Ae,Se=0,pe=3+(7&(se>>>=Ae)),se>>>=3,le-=3}else{for(Re=Ae+7;le<Re;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}le-=Ae,Se=0,pe=11+(127&(se>>>=Ae)),se>>>=7,le-=7}if(n.have+pe>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=J;break}for(;pe--;)n.lens[n.have++]=Se}}if(n.mode===J)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=J;break}if(n.lenbits=9,_e={bits:n.lenbits},Ee=s(c,n.lens,0,n.nlen,n.lencode,0,n.work,_e),n.lenbits=_e.bits,Ee){e.msg="invalid literal/lengths set",n.mode=J;break}if(n.distbits=6,n.distcode=n.distdyn,_e={bits:n.distbits},Ee=s(u,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,_e),n.distbits=_e.bits,Ee){e.msg="invalid distances set",n.mode=J;break}if(n.mode=F,t===p)break e;case F:n.mode=z;case z:if(oe>=6&&ae>=258){e.next_out=re,e.avail_out=ae,e.next_in=ne,e.avail_in=oe,n.hold=se,n.bits=le,a(e,ue),re=e.next_out,te=e.output,ae=e.avail_out,ne=e.next_in,ee=e.input,oe=e.avail_in,se=n.hold,le=n.bits,n.mode===M&&(n.back=-1);break}for(n.back=0;me=(xe=n.lencode[se&(1<<n.lenbits)-1])>>>16&255,ve=65535&xe,!((Ae=xe>>>24)<=le);){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}if(me&&0==(240&me)){for(be=Ae,ye=me,we=ve;me=(xe=n.lencode[we+((se&(1<<be+ye)-1)>>be)])>>>16&255,ve=65535&xe,!(be+(Ae=xe>>>24)<=le);){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}se>>>=be,le-=be,n.back+=be}if(se>>>=Ae,le-=Ae,n.back+=Ae,n.length=ve,0===me){n.mode=H;break}if(32&me){n.back=-1,n.mode=M;break}if(64&me){e.msg="invalid literal/length code",n.mode=J;break}n.extra=15&me,n.mode=G;case G:if(n.extra){for(Re=n.extra;le<Re;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}n.length+=se&(1<<n.extra)-1,se>>>=n.extra,le-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=Q;case Q:for(;me=(xe=n.distcode[se&(1<<n.distbits)-1])>>>16&255,ve=65535&xe,!((Ae=xe>>>24)<=le);){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}if(0==(240&me)){for(be=Ae,ye=me,we=ve;me=(xe=n.distcode[we+((se&(1<<be+ye)-1)>>be)])>>>16&255,ve=65535&xe,!(be+(Ae=xe>>>24)<=le);){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}se>>>=be,le-=be,n.back+=be}if(se>>>=Ae,le-=Ae,n.back+=Ae,64&me){e.msg="invalid distance code",n.mode=J;break}n.offset=ve,n.extra=15&me,n.mode=Y;case Y:if(n.extra){for(Re=n.extra;le<Re;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}n.offset+=se&(1<<n.extra)-1,se>>>=n.extra,le-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=J;break}n.mode=W;case W:if(0===ae)break e;if(pe=ue-ae,n.offset>pe){if((pe=n.offset-pe)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=J;break}pe>n.wnext?(pe-=n.wnext,fe=n.wsize-pe):fe=n.wnext-pe,pe>n.length&&(pe=n.length),ge=n.window}else ge=te,fe=re-n.offset,pe=n.length;pe>ae&&(pe=ae),ae-=pe,n.length-=pe;do{te[re++]=ge[fe++]}while(--pe);0===n.length&&(n.mode=z);break;case H:if(0===ae)break e;te[re++]=n.length,ae--,n.mode=z;break;case K:if(n.wrap){for(;le<32;){if(0===oe)break e;oe--,se|=ee[ne++]<<le,le+=8}if(ue-=ae,e.total_out+=ue,n.total+=ue,ue&&(e.adler=n.check=n.flags?o(n.check,te,ue,re-ue):r(n.check,te,ue,re-ue)),ue=ae,(n.flags?se:ie(se))!==n.check){e.msg="incorrect data check",n.mode=J;break}se=0,le=0}n.mode=q;case q:if(n.wrap&&n.flags){for(;le<32;){if(0===oe)break e;oe--,se+=ee[ne++]<<le,le+=8}if(se!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=J;break}se=0,le=0}n.mode=X;case X:Ee=g;break e;case J:Ee=v;break e;case Z:return b;case $:default:return m}return e.next_out=re,e.avail_out=ae,e.next_in=ne,e.avail_in=oe,n.hold=se,n.bits=le,(n.wsize||ue!==e.avail_out&&n.mode<J&&(n.mode<K||t!==h))&&de(e,e.output,e.next_out,ue-e.avail_out)?(n.mode=Z,b):(ce-=e.avail_in,ue-=e.avail_out,e.total_in+=ce,e.total_out+=ue,n.total+=ue,n.wrap&&ue&&(e.adler=n.check=n.flags?o(n.check,te,ue,e.next_out-ue):r(n.check,te,ue,e.next_out-ue)),e.data_type=n.bits+(n.last?64:0)+(n.mode===M?128:0)+(n.mode===F||n.mode===D?256:0),(0===ce&&0===ue||t===h)&&Ee===f&&(Ee=y),Ee)},t.inflateEnd=function(e){if(!e||!e.state)return m;var t=e.state;return t.window&&(t.window=null),e.state=null,f},t.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?m:(n.head=t,t.done=!1,f):m},t.inflateSetDictionary=function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&n.mode!==k?m:n.mode===k&&r(1,t,i,0)!==n.check?v:de(e,t,i,i)?(n.mode=Z,b):(n.havedict=1,f):m},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,n){"use strict";e.exports=function(e,t){var n,i,r,o,a,s,l,c,u,h,d,p,f,g,A,m,v,b,y,w,S,E,_,R,x;n=e.state,i=e.next_in,R=e.input,r=i+(e.avail_in-5),o=e.next_out,x=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=n.dmax,c=n.wsize,u=n.whave,h=n.wnext,d=n.window,p=n.hold,f=n.bits,g=n.lencode,A=n.distcode,m=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;e:do{f<15&&(p+=R[i++]<<f,f+=8,p+=R[i++]<<f,f+=8),b=g[p&m];t:for(;;){if(p>>>=y=b>>>24,f-=y,0===(y=b>>>16&255))x[o++]=65535&b;else{if(!(16&y)){if(0==(64&y)){b=g[(65535&b)+(p&(1<<y)-1)];continue t}if(32&y){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}w=65535&b,(y&=15)&&(f<y&&(p+=R[i++]<<f,f+=8),w+=p&(1<<y)-1,p>>>=y,f-=y),f<15&&(p+=R[i++]<<f,f+=8,p+=R[i++]<<f,f+=8),b=A[p&v];n:for(;;){if(p>>>=y=b>>>24,f-=y,!(16&(y=b>>>16&255))){if(0==(64&y)){b=A[(65535&b)+(p&(1<<y)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(S=65535&b,f<(y&=15)&&(p+=R[i++]<<f,(f+=8)<y&&(p+=R[i++]<<f,f+=8)),(S+=p&(1<<y)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(p>>>=y,f-=y,S>(y=o-a)){if((y=S-y)>u&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(E=0,_=d,0===h){if(E+=c-y,y<w){w-=y;do{x[o++]=d[E++]}while(--y);E=o-S,_=x}}else if(h<y){if(E+=c+h-y,(y-=h)<w){w-=y;do{x[o++]=d[E++]}while(--y);if(E=0,h<w){w-=y=h;do{x[o++]=d[E++]}while(--y);E=o-S,_=x}}}else if(E+=h-y,y<w){w-=y;do{x[o++]=d[E++]}while(--y);E=o-S,_=x}for(;w>2;)x[o++]=_[E++],x[o++]=_[E++],x[o++]=_[E++],w-=3;w&&(x[o++]=_[E++],w>1&&(x[o++]=_[E++]))}else{E=o-S;do{x[o++]=x[E++],x[o++]=x[E++],x[o++]=x[E++],w-=3}while(w>2);w&&(x[o++]=x[E++],w>1&&(x[o++]=x[E++]))}break}}break}}while(i<r&&o<s);i-=w=f>>3,p&=(1<<(f-=w<<3))-1,e.next_in=i,e.next_out=o,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=o<s?s-o+257:257-(o-s),n.hold=p,n.bits=f}},function(e,t,n){"use strict";var i=n(3),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,n,l,c,u,h,d){var p,f,g,A,m,v,b,y,w,S=d.bits,E=0,_=0,R=0,x=0,C=0,I=0,T=0,P=0,O=0,k=0,M=null,L=0,B=new i.Buf16(16),D=new i.Buf16(16),N=null,U=0;for(E=0;E<=15;E++)B[E]=0;for(_=0;_<l;_++)B[t[n+_]]++;for(C=S,x=15;x>=1&&0===B[x];x--);if(C>x&&(C=x),0===x)return c[u++]=20971520,c[u++]=20971520,d.bits=1,0;for(R=1;R<x&&0===B[R];R++);for(C<R&&(C=R),P=1,E=1;E<=15;E++)if(P<<=1,(P-=B[E])<0)return-1;if(P>0&&(0===e||1!==x))return-1;for(D[1]=0,E=1;E<15;E++)D[E+1]=D[E]+B[E];for(_=0;_<l;_++)0!==t[n+_]&&(h[D[t[n+_]]++]=_);if(0===e?(M=N=h,v=19):1===e?(M=r,L-=257,N=o,U-=257,v=256):(M=a,N=s,v=-1),k=0,_=0,E=R,m=u,I=C,T=0,g=-1,A=(O=1<<C)-1,1===e&&O>852||2===e&&O>592)return 1;for(;;){b=E-T,h[_]<v?(y=0,w=h[_]):h[_]>v?(y=N[U+h[_]],w=M[L+h[_]]):(y=96,w=0),p=1<<E-T,R=f=1<<I;do{c[m+(k>>T)+(f-=p)]=b<<24|y<<16|w|0}while(0!==f);for(p=1<<E-1;k&p;)p>>=1;if(0!==p?(k&=p-1,k+=p):k=0,_++,0==--B[E]){if(E===x)break;E=t[n+h[_]]}if(E>C&&(k&A)!==g){for(0===T&&(T=C),m+=R,P=1<<(I=E-T);I+T<x&&!((P-=B[I+T])<=0);)I++,P<<=1;if(O+=1<<I,1===e&&O>852||2===e&&O>592)return 1;c[g=k&A]=C<<24|I<<16|m-u|0}}return 0!==k&&(c[m+k]=E-T<<24|64<<16|0),d.bits=C,0}},function(e,t,n){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(e,t,n){var i={"./drawtarget.png":170,"./drawtarget2.png":171,"./intersect.png":172,"./subtract.png":173,"./union.png":174};function r(e){var t=o(e);return n(t)}function o(e){var t=i[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=169},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuNWWFMmUAAAVTSURBVFhHzVhNSyxHFLV7enq+R31RX2ZMniiPxKgQgoS3kAhBSZSgvvgvfAvduBE/NoH8D0H8AYLuRNy4EcGVLhRx496FbtyYc7r71tT03JlpzVt44NC3Tt26dae6Prqm4/n5+c1TFd8aVfGtURWTMg5oFPloqKT0WqqixmZAnQPmwBRokgTSYCH0agTqElMVNcYBjcl5YOn09LRzZ2fHh22SRJn6MEzxc8OWIVBOTFW0GQc0jljm+Pg4PT8/n8rlcoO+72f6+vqYiEkS5TL0bzOZjDszM+Pv7++7kEknjJQ8UVUU2kCZI5K+uLjIjY2NpYHC5OQkR4evmnWkSRIogSmUHfj5bDAyMuKen5+Lb5Asnm2pikIBbM6v7MbGRpGjNjU15V1eXnJE2RlfKe261w1UwTLIOvo7bIdc3fX1dbbjyCdKVBWFUYDc09NTdWFhIVMsFju3t7cZPEg68vMCRwC2STJUQqCYB5lYand31ymVSt709LSHuHz9HHH6NKUqkgLYvyDBvt7eXv/6+pqjFYxgVF0H6GqSAshM1EWcdH9/fwojy1gVkM+gX426GAG2i1fcgxHM3N3dsQOOoJoggTqTJFAXSwCNcfKMh7jltbU1/vBKVKeyUYgA28EiYcCOvb294NkM0hZsSNKmAHbwgw8ODnowRz30wx//s/jFWTNigOZiFbtzc3Ocg+9BrtQA0kZhyySFUQwuqu8R38eq5+v+ElQA4iesGRZQdrEPciX6Dw8PZmEIpM1X4CfE56LqODk5+QvPsha/ZlhA2cVG7X7+/Jm/8NUnRQIyfnlxcdHBiPbDDuamQPxqhgWU/Ww2mz48PPxfx1k7RvGyR0dHKfTH158LxAjGT5wFKDs4c10eZ7DrEtQggV7DqD0XUQaHhI9+eXqlgwrA9qsDxBQ+DjJDQ0MF2MVIbgkJ9hpG7bsGBwe70O93sEuBCNg+BhDaInJtaMzyC5gExt9uGPTVjjH/Oth1rUjXdqzzN0ZY8wi2g2kjtKHVK0wC418zIsDmnPRHR0c5ofORXAdpY9OGVq9RALtveHj4V/Q7CvubSK75GSMC7BRWWVe5XOYe1hnJDZB2QhvxOo02UOY5zl2FA2N2FOMrhkXujZ3Yt7yzs7OGr+gkEN9WFMB20M8A+vsB9kAkBzC+YhghrPxjdnY2t7y8zF/2o91AfDTYPu0ogJ1dWVkp4YrBPbLuCDa+YsT4jneSfD7vPT4+/mM3EGraSyhA/AL6KaA/7std1Bp840JEzsc/sXjSm5ubwdFo1bUie+eDiNcZCmD7W1tbBSwac/zafkJVjPgJl6Zu3AYLNzc3THIgVq+xbZIC2A7ievxGQD+dKPNO1OBPqiIZBfodl6b31WrVub+//4ByNqgAbF+LiZLE08Fr5pGbXV1d7UU52HZsP5uqaLEI/o1LU3p8fNxDovyCti9ecZokQ4/QxwbKTJDnsz8xMSFTqeV0UsUYP+JWV8SlKV+pVPyrqysGfvFFDFKwB97e3vooZpEgb6E90FqOIqmKCrvBEVyaCviES/PyhNHg4uIlyt5LG5KEyeTEn5KHV8zk3oEfqbWjKjYhP/OruDSl+E8EFlRuaWmpwg0fOqcBOzRJAhnQRT39eLx2gzkski7o/4KcSvE+VKpiMxJ4MikHd6BefPJ/QK4ujrQStpEh6CZJPJlYhsRGXcI++Bvkn0COfl3cdlTFZrSBMkeWr4xnfQ4fB9xGTJIol6HLPxdMjHaSG2cDVbEZmwF1TIJ/u5gkAc7BIMnQqx7QE1MV21GglE2SoRL6xEHtJVTFr8XXJKRRFd8aVfFt8bnjP7pLP1ubBl3DAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuNWWFMmUAAAXWSURBVFhHzVhLSyxHGLV7unum56XXq9eo3IdwIV4VQnBxFxIhKIkSfMR/YRa6cSM+NoH8D0H8AYLuRNy4EUGy0IUibty70I0bc05NVVnd8/U4DgQ8cPi+OvX6prqe0/b09PTmKYpvjaLYCtOQyrRKUWyWaUDLw+RhczXlGW6911IUJWYBeR6ogtLl3HRdsAYs2yxFUWIa0BhMAFZOTk7C7e1tpkvIoq0wDf2LLqdYq1kD0k1TFF2mAS0H5o+OjsLZ2dlcHMcDURSFOo+f24f1mYYe5/N5f2pqKtrb26PeUqCiaOgCaY5GeH5+Ho+MjIRAaXx8nMHEzNNlmGYwnJcsz7SHchErDA0N+WdnZ6assS9SFA0N4IdgYX19vYzRyU9MTAQXFxccUQYyCNInAxRvh/0IMviq0VHeYz3EqkaZGthUoKJoqBuIHx8f++bm5vLlcrl9a2uLjaugdTkGpgCfATCvo6bUgHQR5A/K7ezseJVKxZucnAzQLke9Aqr+siiKpAH8nxHgh+7u7ujq6ipCWo2gzk4AOgPmj4hrShKsB/pox+vv789hZNlWL0hr+05TFjXg+/jEXRjB/O3trZqToBgggTzTmVpIElgfDNge2q2urq7yh/fqPJH1ggZ8D4uEDbbt7u4qmwWTB8vVzUDVvCOYZ+gC6XB/f78LczRAP/zxP7llXT47KUDzsYr9mZkZfr4e0G7Mpo5LrRdgODKREgC3DGkAn4vqI9qPsOr5w/7SWfV1rOMAaR/7IFdidH9/bxeGgakjkA3daqugdUsXSH9H+1xUbcfHx3/AVrWerGMdB0j72Kj9+fn5xKcjTPkMsiEaIp1naQCf7VcXFhY8jGg/fDU3DWx56zhAOioUCuHBwQE/9f8WJIF04fDwMIf++PkTu4ItL1TimevzOIOfCFCCaUizlSC5KD0cEgH65cjWzX0RuByo4NwKjWAaAxsG2QgDAwNqBwHt9iXWg6B+FahWM8hThccc/XdgRRdlWRENsmxvcNke++GWZfpVowh20mpd8dmpgRs1yWONq5pbCn02xvlSBjnK1FVAryRHyZD9sF1atknL4JhXBOUgYc0v4rbARUPLi0IZ5Ii657SIBlm1TgC46toG2jM9ZTkYKi7y2XHACystdGUlmHpufVg3yEQ+KcHog4ODMfrtUQkNWy/dAHyu7o5qtcpfZSexBFPX1IelQ0PU5TcCznH2mxgUWzfdCHx+5nbsW8Hp6WnmSEpAvZaCRD8B+vuKcp+1pGDrGscKtczfpqen46WlJc6PHxMVGgD5rw4SecHy8nIFTwzO/cSWZ+saJ8VOvkmKxWLw8PDwt1uBdOFqsHT+1VaBrqEEtI9uiiX0x4uJWphuHVUvLWhyPv4+PDwcbmxsqKPRyVN0YdKwvCCwM7X/vQSUCzc3NwtYNPZkY1tpiqLmdzya3uE1WLq+vmaQn1P5utlnQPsGw5t24vmQBbTrYS7yccZDgwdIon1DUSQJ2F/X1tZ6+vr6vLu7u09IcxNXMGVcQPsAw7nVXlNkIN/DZ+YbvbCystKN9HutixRFh9zE/8SjKRwdHQ0QKG/Q7oauaABfnRzpMi6QZoA8XqOxsTEzleqmk0tRTPErXnVlPJqKvb290eXlJRsWtybo6kiD5SglwDrkzc0Nb+0FBMhXaBe0hqNIiqJAXi6G8Ggq4QoX8vGE0eDi4iKxAcP/AYajnzgEkPZR3pQL8IkZHC8S3BvdfkSKYgY5Qn14NOX4TwQWVLy4uNjLDR86pwHPdp657LyrFo/aqEOU4+WEiynGIulA/j8sC0r91FEUs0jAqs+GN1A3rvyfEKuPI62CbeQ99E4U4XRgUNyYuRXlsVFXsA/+Av0byNGva7sRRTGLLpDmyKq7H85cXg4YHBdMCTZCugDd3HIYGH17osBvmqKYxSwgj0Hwk3NR0FdbFawKkn4a0JumKL5EAyE9DWP/ZSPcfANTr1mKYivMglT2tRTFt0ZRfFt8avsPi39msoH0s3UAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IDN8dNUwAAAAlwSFlzAAAOwgAADsIBFShKgAAAAl5JREFUWMPtl6uOYkEQhrsn+wBIBAKJRCIQCBIEFoFEIBD7AAhGM56RvAGCEIIjgQQSBLwFCBy8QS9/ZarT13N6mE3IJltJhxy+7qr/9KWqj1RKiVfam3ixvVzAr4Q+P10j+awACnw6ncRisRDr9VpcLhdqpVKJ2mQyibJmsylarZao1+sqUwg2YaCpzWajGo2G+hJitSzmtlqtRv0Ns2IFgw+HQ+2gWCzS8263U+fzOZfh93A4qNFoRJz7gqUIUJ1ORw/qdrvqdrtp6S4Tn4par9fT/6MPG8ZGWFCAfrtCoaBms5k5bRbjwG7jNx4MBtbY5XIZYpYAWidWagT3WCy4bl/9ENT0gWeH2QJ4U2FqnWmyWJ4AnvJqter5CTECx+NRbypjzT2W+/bOUhi7X/CecBllQpxl2EOheKyxdWZNlmrcd7VaWQkJvl1GApBIYO1223PG7KM0ThbAfff7vcc4BjMSgAwGK5fL3gBmz1hoLMdgJrEOUkqdFZ2Uqdljbb8X/Xe+TzCaAeRuQ5UVidkzFhir+M2ZWQKu12uKk58IECEBEpXL3PGmMRtd35MDc99HJfQY735mEKBQNmHT6VTc73drgMlSjfvyWDb49hgnCZRNPCJbmckDvybLS0L9fp/6VioVLxOGWLAWuHn8b9SCgP94NUS6dB2Y7LvVEMHzqqEI1XxMuVkbXOZOe+g+EGHxCwkMKmO3njwWuxG5b555JYPN53Mqm6F7XhZzGzacs5xWkxlfRgS22y2dXRQP9+Y7Ho+jDOccR43zSOxWLBM+zV72XZDk4P+34T8v4A9Un6ysqt6SOQAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IDN8dNUwAAAAlwSFlzAAAOwgAADsIBFShKgAAAAmBJREFUWMPtV62OIkEQnr7sAyARCCQSiUAgSBBYBBJBLohzaxCc5jz7FghCCAoSSCBBwFuAwPEIvXx1VKenu2umdzcXcslWUuHnq6n6uru6qkZprZNnyo/kyfJ0Ai8RNl89I/VZAhT4dDol8/k8Wa/XyeVyIS2VSqSTyUTEms1m0mq1knq9rjOJIAkDqjebjW40GvpBJK1vWsYcrdVq5MuSVKxg8OFwaBwUi8W/v+9BoSFst9vp8/lM3/F5OBz0aDQinG2BxRDQnU7HPNTtdk1gqIvdbjfSXq9n/ocNSwYWJGBWVygUUoHtlQObTqfalcViYVY8GAxisBQBOif7jD19YFZwb/cQiO3w3bILYWkCnFTuttsJB0wIbvzwllerVdc2iBFwPB5NUkmrB4YzzSMAG95uK/tFjCoh7jLkztC7pqPrb4Pdzz+vsCjYsJ/lcpmLEQEUEsif0tjzyFi73Y4ufWy73+9zMSKACiYJY+VyOZoA24b8upjCOSj12NW3QNn/pUzFzKvrdoFln4HnUhjtAGq3JIw9GMc0Js2rC/j1sGgC1+s1+ggyCCQhAgqdy854WxjjmxIjnOH3TpiPIQfQTP5FHVitVin7EGYeRNukhvHz1SPAGCpZHoF+v0+2lUrFq4Qh7MO9wKnx3gwh9YIAJnfD0FHYmOXcCAJI3VDAfALuPEDNQ5gHgPE8wFsbmgcETB5IIGApTUQhjCciYNJE5K48cySDzGYzapvSTChijiLhMvKGSnHmVLzdbunuonm4k+94PBYx3HNMxVxHpDKuIl7NnvZeEOXg+93wvyfwDtK7/zuOF2QYAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IDN8dNUwAAAAlwSFlzAAAOwgAADsIBFShKgAAAAkFJREFUWMPtl79rwkAUx+9K/wDHFPwDHO0gOCgoCC6OgTpasODQ0VKHZBAK6a5j/4SCiDgp6ODoUArdOwjNf3G9dybp5XLvElpoLPQLD20/9+PleffeC2WMkTx1RnJW7g6cZxjz09+IftcBsfF+vyfz+Zys12tyOByEFYtFYZPJBGWtVou0221Sq9WY0RE4hBpjm82GNRoNFjgStynDmWLValWsJSm2l3bz0WgULWBZ1vFvvilYKgu+O44jeDgWWBYHmG3b0aRutxstCIaxXq8X/V+MkeaoTHVC++SFQiG2iPzkOhZa+MSDwcDIZCdokIjYdrslzWbzeDCmmoN/S3GWdVzAFosF6XQ6NJYHxuOx+OShTcxrPDdRpoqHXHyWny5R5rpudMsgAgyuWqVSITxMxHc+tJ6jTCPr4YL4vq+NQsj4zSD8Jh0jAHdZ9lCW47soS4vC8P0OZcvl8isVQyIBPRa9xAQTwxSO3e12qUw4ABkMk4mlKcu6p+EA5G5MJpamLOuehAMUKpd84mWZGKZwLK+EqUzkATiR9Xr9V/PAarUSDyciAN7wsimA/TpMTApZb3+dunn/5UaMLZVKCXb1dh+xILL0ZGoBhbTIK14UJlUmJocXxCuekfHNj5tSGi/Haj8gajnSD8is3++j/YDKTP1A5ISo50jXk8qQjkjtA4wtGWg2m7FyuYz2hChTjB84xn9z7eZyQ4J2xXA4oXLBVVU7X8/zUAY3C7riMI9gXTHN8GqW23tBpgX+3w3/vAOflUPr2Hvmww8AAAAASUVORK5CYII="},,,function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"GenerateDataPluginRunner",function(){return C}),n.d(i,"JobMonitor",function(){return m}),n.d(i,"JobMonitorControl",function(){return U}),n.d(i,"TsneJob",function(){return F}),n.d(i,"TsnePlugin",function(){return w});var r={};n.r(r),n.d(r,"SelectionConfig",function(){return z}),n.d(r,"SwitchableSelections",function(){return G}),n.d(r,"PlotConfig",function(){return Q}),n.d(r,"PluginFactory",function(){return E});var o={};n.r(o),n.d(o,"KDETexture",function(){return k}),n.d(o,"PointGroupView",function(){return M}),n.d(o,"LUTFilter",function(){return H}),n.d(o,"LUTTexture",function(){return W}),n.d(o,"ChoroplethSVGView",function(){return J});var a={};n.r(a),n.d(a,"ColorRamp",function(){return Z}),n.d(a,"SnapshotSaver",function(){return te}),n.d(a,"LookupEnum",function(){return ne}),n.d(a,"enumToOptions",function(){return re}),n.d(a,"css_color_string_from_int",function(){return oe}),n.d(a,"isVivaldiBrowser",function(){return ae}),n.d(a,"sortAndUnique",function(){return se}),n.d(a,"css_color_from_hextriplet",function(){return le}),n.d(a,"style_from_hextriplet",function(){return ce}),n.d(a,"int_from_css_color_string",function(){return ue}),n.d(a,"control_ids_to_strings",function(){return he}),n.d(a,"hide_container_behind",function(){return de}),n.d(a,"log",function(){return pe}),n.d(a,"warn",function(){return fe}),n.d(a,"error",function(){return ge});var s={};n.r(s),n.d(s,"ControlEventModel",function(){return be}),n.d(s,"DynamicSelection",function(){return ye}),n.d(s,"StartupSelection",function(){return we});var l={};n.r(l),n.d(l,"ChoroplethProtocol",function(){return g}),n.d(l,"PlotProtocol",function(){return A}),n.d(l,"SelectionProtocol",function(){return Ce}),n.d(l,"ControlProtocol",function(){return Ae}),n.d(l,"LayoutWidgetProtocol",function(){return st}),n.d(l,"ExportSelectionProtocol",function(){return lt}),n.d(l,"DataPreprocessProtocol",function(){return ct}),n.d(l,"SnapshotProtocolForCanvas",function(){return K}),n.d(l,"SnapshotProtocolForSVG",function(){return q});var c={};n.r(c),n.d(c,"ViewController",function(){return Yt}),n.d(c,"ChoroplethLoader",function(){return Le}),n.d(c,"ChoroplethController",function(){return Me}),n.d(c,"LayoutController",function(){return Ne}),n.d(c,"PixijsPlotController",function(){return Ze}),n.d(c,"SimplePlotController",function(){return D}),n.d(c,"ToolTipController",function(){return _e}),n.d(c,"SiteInstance",function(){return Ht}),n.d(c,"WidgetController",function(){return At}),n.d(c,"SelectionSubscriber",function(){return Ie}),n.d(c,"SnapShotController",function(){return Pe}),n.d(c,"toolTipController",function(){return Kt});var u={};n.r(u),n.d(u,"DataCache",function(){return Jt}),n.d(u,"LayoutCollection",function(){return at}),n.d(u,"PermanentSelection",function(){return $t}),n.d(u,"DataMapper",function(){return qe}),n.d(u,"PlotDataModel",function(){return p}),n.d(u,"PlotPropReader",function(){return Xe}),n.d(u,"LayoutSiteConfig",function(){return Gt});var h={};n.r(h),n.d(h,"OntologyTree",function(){return en}),n.d(h,"PlotContextMenu",function(){return tt}),n.d(h,"SelectionDataWidget",function(){return ze}),n.d(h,"SelectionEditWidget",function(){return Ge}),n.d(h,"SelectionUploadWidget",function(){return Qe}),n.d(h,"SelectionContextMenu",function(){return Fe}),n.d(h,"ContentTableWidget",function(){return dt}),n.d(h,"ControlWidgetLayout",function(){return Ue}),n.d(h,"TutorialControl",function(){return ft}),n.d(h,"PreloadSelectionWidget",function(){return it}),n.d(h,"LayoutWidgetBase",function(){return ht});const d=n(15);class p{constructor(){this.layoutDef=void 0,this.props={},this.plotDefs={},this.selectionDefs={},this.selectionPropKeys={},this.selectionProps={},this.dataCache=new ReScatter.data.DataCache}static get axis(){return{ROW:0,COL:1}}loadLayoutDefData(e,t){this.layoutDef=e;let n=[],i=[],r=[],o=[],a=[];var s=!0,l=!1,c=void 0;try{for(var u,h=e.plots[Symbol.iterator]();!(s=(u=h.next()).done);s=!0){let e=u.value;ReScatter.layoutManager.isSpaceLayout(e)?r.push(-1):(n.push(e.data.points),a.push({path:e.data.points,type:"json"}),i.push(e.data.props),a.push({path:e.data.props,type:"json"}),r.push(n.length-1))}}catch(e){l=!0,c=e}finally{try{s||null==h.return||h.return()}finally{if(l)throw c}}if(e.ontologies){var d=!0,p=!1,f=void 0;try{for(var g,A=e.ontologies[Symbol.iterator]();!(d=(g=A.next()).done);d=!0){let e=g.value;o.push(e.ontology_file),a.push({path:e.ontology_file,type:"json"})}}catch(e){p=!0,f=e}finally{try{d||null==A.return||A.return()}finally{if(p)throw f}}}this.dataCache.loadFiles(a,function(){t(n,i,r,o)})}putDataProps(e,t){this.props[e.id]=t,this.plotDefs[e.id]=e,this.selectionProps[e.selections.selectionOut]=t,this.selectionPropKeys[e.selections.selectionOut]=Object.keys(t),this.selectionDefs[e.selections.selectionOut]=e}getSelectionPropAtIndex(e,t,n,i){let r=this.selectionProps[e];return void 0===r?i:r[n][t]}getUniqueSelectionPropValues(e,t){return this.selectionProps[e][t].filter(function(e,t,n){return n.indexOf(e)===t})}getSelectionPrimaryProp(e){return this.selectionDefs[e].format.primary}getAllSelectionPropsAtIndex(e,t){let n={};return this.selectionPropKeys[e].forEach(function(i){n[i]=this.selectionProps[e][i][t]},this),n}getSelectionPropKeys(e){return Object.keys(this.selectionProps[e])}getSelectionIndexes(e,t,n,i){let r=this.selectionProps[e],o=!!i,a=[],s=String(n).toUpperCase();return r[t].forEach(function(e,t){o?String(e).toUpperCase()===s&&a.push(t):e===n&&a.push(t)}),a}getSelectionIndex(e,t,n){let i=this.selectionProps[e],r=[],o="number"==typeof i[t][0]?parseInt(n):n,a=i[t].indexOf(o);return a>0&&r.push(a),r}destroy(){this.props={},this.plotDefs={},this.selectionDefs={},this.selectionPropKeys={},this.selectionProps={},this.dataCache=void 0}getPlotPropSubSelection(e,t,n){let i=this.props[e];if(this.plotDefs[e].selections.selectionOut!==t)return{voxel_props:i};let r={};for(var o=Object.keys(i),a=0;a<o.length;a++){let e=o[a];r[e]=[],n.forEach(function(t){r[e].push(i[e][t])})}return{voxel_props:r}}getPredefinedSelectionsSubSelection(e,t,n,i){this.layoutDef.predefinedSelections||n(void 0);let r=[],o=[],a=[],s=0;var l=!0,c=!1,u=void 0;try{for(var h,p=this.layoutDef.predefinedSelections[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){let t=h.value;r.push(JSON.parse(JSON.stringify(t))),e===t.targetId&&(o.push({path:t.preselect,type:"json"}),a.push(s)),s++}}catch(e){c=!0,u=e}finally{try{l||null==p.return||p.return()}finally{if(c)throw u}}0===o.length&&n(r);let f=this;this.dataCache.loadFiles(o,function(){o.forEach(function(e,n){let i=[],o=f.dataCache.getFromCache(e.path);"string"==typeof o&&(o=JSON.parse(o));var s=!0,l=!1,c=void 0;try{for(var u,h=o[Symbol.iterator]();!(s=(u=h.next()).done);s=!0){let e=u.value,n={},r=Object.keys(e),o=[];for(var p=0;p<r.length;p++){let t=r[p];e[t]instanceof Array?("dataPoints"!==t&&o.push(t),n[t]=[]):n[t]=JSON.parse(JSON.stringify(e[t]))}t.forEach(function(t,i){let r=e.dataPoints.indexOf(t);if(-1!==r){n.dataPoints.push(i);for(var a=0;a<o.length;a++){let t=o[a];n[t].push(e[t][r])}}}),n.dataPoints.length>0&&i.push(n)}}catch(e){l=!0,c=e}finally{try{s||null==h.return||h.return()}finally{if(l)throw c}}let g=a[n],A=d();this.dataCache.insertInCache(i,A,!0),r[g].preselect=A},f),n(r)})}}var f=n(1);var g=f.define(["colorMap"],{onPlethResize:[],loadPleth:[],clearPlethColors:[],savePlethColors:[],restorePlethColors:[],setPlethColorsFromMap:["colorMap"]});var A=f.define(["points","props","plotProps","resizeEvent"],{loadPlotData:["points","props","plotProps"],onResize:["resizeEvent"]});class m{constructor(e){this.pubsubid="JOBMONITOR_"+Date.now(),this.algorithmName=e,this.jobGroups={},this.statuses={},this.progressData={},this.jsonStatuses=[]}get monitoredAlgorithm(){return this.algorithmName}_updateModel(e){this.jsonStatuses=[];for(var t=Object.keys(this.statuses),n=0;n<t.length;n++){let e=t[n],i={};i.jobid=e,i.createtime=this.jobGroups[e].createdtime.toLocaleString(),i.status=this.statuses[e].status,i.progress=this.jobGroups[e].jobsdone+" of "+this.jobGroups[e].numSubJobs,i.delete="",this.jsonStatuses.push(i)}PubSub.publish(this.pubsubid,{jobId:e})}getProgressData(e){return this.progressData[e]}addJobGroup(e,t){let n=t||!0;this.jobGroups[e.pubsubTopic]=e,this.statuses[e.pubsubTopic]={status:e.status,jobsDone:e.numComplete};const i={};var r=!0,o=!1,a=void 0;try{for(var s,l=e.jobIds[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){i[s.value]=null}}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}this.progressData[e.pubsubTopic]=i;let c=e.pubsubTopic;this._updateModel(c),PubSub.subscribe(c,(e,t)=>{this.jobCallback(e,t,c)}),n&&e.start()}getJobGroup(e){return this.jobGroups[e]}jobCallback(e,t,n){this.statuses[e]=t,(t.status=DimRS.JobGroup.JobStatus.PROGRESS)&&(this.progressData[e][t.jobId]=t.progressData),this._updateModel(n)}cancelJob(e){PubSub.unsubscribe(e),this.jobGroups[e].cancel(),delete this.statuses[e],this._updateModel(e)}getResultClient(e){return this.jobGroups[e].get_result()}}const v=n(8),b=n(2),y=n(49);class w{constructor(){let e=ReScatter.dimres_url;this.jobGroup=new DimRS.JobGroup(e),this.jobMonitor=new m(w.getAlgorithmName())}static getAlgorithmName(){return"Approximated-tSNE (server)"}addJob(e,t,n){let i;if(t.calcAxis===p.axis.COL){e=e.transpose(1,0);let t=y.clone(e);i=v.serialize({data:t.data,sizes:t.shape.slice().reverse()}),y.free(t)}else i=v.serialize({data:e.data,sizes:e.shape.slice().reverse()});let r=DimRS.JobGroup.default_tsne_params;if(e.shape[1]<100){let t=Math.ceil(e.shape[1]/4)<2?2:Math.ceil(e.shape[1]/4);console.log("Reducing perplexity to: "+t+" for "+e.shape[1]+" points in plot: "+n),r.perplexity=t}t.parameters&&t.parameters.algorithmParams&&t.parameters.algorithmParams.perplexity&&(r.perplexity=t.parameters.tsne.perplexity),console.log(`Added job, shape ${e.shape}, perplexity: ${r.perplexity}`);let o=this.getJobDataKey(t.data);return this.jobGroup.addJob(i,DimRS.JobGroup.JobType.ATSNE,n,r),o}getJobDataKey(e){return this.jobGroup.pubsubid+"_dataMap_"+e}start(e,t){let n=t=>{let n=[];var i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){let e=a.value,t=v.parse(e[1]),i=b(t.data,t.sizes.slice().reverse()),r={dims:2,points:[]},o=i.shape[1];for(let e=0;e<o;e++)r.points.push([i.get(0,e),i.get(1,e)]);n.push([e[0],r])}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}e(n)},i=(e,i)=>{if(console.log("job: "+e+" status: "+i.status),"success"===i.status){this.jobMonitor.getResultClient(e).then(n,t)}};PubSub.subscribe(this.jobGroup.pubsubid,function(e,t){i(e,t)}),this.jobGroup.jobs.length>0&&this.jobMonitor.addJobGroup(this.jobGroup)}}const S={_choroplethTypeMap:new Map,_plotTypeMap:new Map,_widgetTypeMap:new Map,_jobTypeMap:new Map,_preprocessTypeMap:new Map,registerChoroplethType(e,t){g.hasImpl(t)?S._choroplethTypeMap.has(e)||S._choroplethTypeMap.set(e,t):alert("Choropleth plugin must implement the ChoroplethProtocol! "+e)},createChoroplethType(e){if(S._choroplethTypeMap.has(e)){let r=S._choroplethTypeMap.get(e);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new r(...n)}return console.error("The choropleth plugin class: "+e+" is not reqistered"),null},registerPlotType(e,t){A.hasImpl(t)?S._plotTypeMap.has(e)||S._plotTypeMap.set(e,t):alert("Plot plugin must implement the PlotProtocol! "+e)},createPlotType(e){if(S._plotTypeMap.has(e)){let r=S._plotTypeMap.get(e);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new r(...n)}return console.error("The plot plugin class: "+e+" is not reqistered"),null},registerWidgetType(e,t){S._widgetTypeMap.has(e)||S._widgetTypeMap.set(e,t)},createWidgetType(e){if(S._widgetTypeMap.has(e)){let r=S._widgetTypeMap.get(e);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new r(...n)}return console.error("The widget plugin class: "+e+" is not reqistered"),null},registerDataJobType(e,t){if(!S._jobTypeMap.has(e)){S._jobTypeMap.set(e,t),(new ReScatter.widget.SelectionContextMenu).registerGenerateDataPlugin(e)}},createDataJobType(e){if(S._jobTypeMap.has(e)){let r=S._jobTypeMap.get(e);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new r(...n)}return console.error("The selection job plugin class: "+e+" is not reqistered"),null},registerPreprocessType(e,t){S._preprocessTypeMap.has(e)||S._preprocessTypeMap.set(e,t)},createPreprocessType(e){if(S._preprocessTypeMap.has(e)){let r=S._preprocessTypeMap.get(e);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new r(...n)}return console.error("The preprocess plugin class: "+e+" is not reqistered"),null}};var E=S;const _=n(8),R=n(2),x=(n(60),n(61),n(63),n(15));class C{constructor(e){this.plugin=E.createDataJobType(e)}get monitor(){return this.plugin.jobMonitor}run(e){let t=ReScatter.layoutManager.getRecalculation();if(void 0===t)return;let n={};ReScatter.layoutManager.getDataMaps().forEach(function(e){n[e.id]=e.filePath});let i={};ReScatter.layoutManager.getBaseDataMaps().forEach(function(e){i[e.id]=e.filePath});let r=e.selectionId,o=e.dataPoints,a=ReScatter.dataModel.dataCache,s=[],l=Object.getOwnPropertyNames(t.dataAnalysis.analyses),c=[];l.forEach(e=>{let n=t.dataAnalysis.analyses[e].inputData;c.includes(n)||(c.push(n),s.push({path:i[n],type:"arraybuffer"}))}),this.preprocessPlugin=E.createPreprocessType(t.dataAnalysis.dataPreprocess.preprocessPlugin);let u=this,h=ReScatter.layoutManager.getId();a.loadFiles(s,function(){let i=x(),s=u.preprocessPlugin.getRecalculationData(i,a,t,o,r),c=u.preprocessPlugin.getDataMap();l.forEach(e=>{let n=s[e],i=t.dataAnalysis.analyses[e];u.plugin.addJob(n,i,e)});var d=!0,p=!1,f=void 0;try{for(var g,A=Object.getOwnPropertyNames(n)[Symbol.iterator]();!(d=(g=A.next()).done);d=!0){let e=g.value;n[e]=c[e]}}catch(e){p=!0,f=e}finally{try{d||null==A.return||A.return()}finally{if(p)throw f}}let m=new ReScatter.data.LayoutCollection;u.plugin.start(function(s){let l="Generated by: "+u.plugin.constructor.getAlgorithmName()+" from selection: "+e.label,c=e.description,d={},p={};for(let e=0;e<s.length;e++){let n=s[e][0],l=t.dataAnalysis.analyses[n].targetPlotId,c=i+"_data_"+l,u=s[e][1],h=_.parse(u),f=R(h.data,h.sizes.slice().reverse());if(1!==f.shape.length&&(2!==f.shape.length||2!==f.shape[1]))throw"Plugin data was neither 1 or 2 dimensional";let g=f.shape[0]/(2/f.shape.length),A={dim:2,points:new Array(g)};for(let e=0;e<g;e++)1===f.shape.length?A.points[e]=[f.get(2*e),f.get(2*e+1)]:A.points[e]=[f.get(e,0),f.get(e,1)];let m=ReScatter.dataModel.getPlotPropSubSelection(l,r,o),v=i+"_props_"+l;a.insertInCache(A,c,!0),a.insertInCache(m,v,!0),p[l]=v,d[l]=c}m.addDerivedLayout(h,l,c,d,p,n,r,o)},function(e){window.alert("Job failed with error: "+JSON.stringify(e))})})}}let I=null;class T{constructor(e,t,n,i,r){if(I)return I;I=this,this._width=r,this._mean=e,this._level=t,this._displayStdDev=n,this._scaleFactor=i,this.rawCanvas=document.createElement("canvas"),this.stddevOrScaleChanged(),this.calculatePdf()}get pdf(){return this.done?this._pdf:(this.calculatePdf(),this._pdf)}get canvas(){let e=this.rawCanvas.getContext("2d");e.fillRect(0,0,this._canvasWidth,this._canvasWidth);let t=e.getImageData(0,0,this._canvasWidth,this._canvasWidth),n=t.data;this.done||this.calculatePdf();for(let e=0;e<this._canvasWidth;e++){let t=4*this._canvasWidth*e,i=this._canvasWidth*e;for(let e=0;e<this._canvasWidth;e++){let r=Math.round(this._pdf[i+e]);n[t+4*e]=r,n[t+4*e+1]=r,n[t+4*e+2]=r,n[t+4*e+3]=256}}return e.putImageData(t,0,0),this.rawCanvas}set mean(e){this._mean!==e&&(this._mean=e,this.done=!1)}get mean(){return this._mean}set level(e){this._level!==e&&(this._level=e,this.done=!1)}get level(){return this._level}set stddev(e){this._displayStdDev!==e&&(this._displayStdDev=e,this.stddevOrScaleChanged())}get stddev(){return this._displayStdDev}set scaleFactor(e){this._scaleFactor!==e&&(this._scaleFactor=e,this.stddevOrScaleChanged())}get scaleFactor(){return this._scaleFactor}set width(e){this._width=e,this.canvasWidthChanged()}get width(){return this._width}calculatePdf(){let e=new Float32Array(this._canvasWidth),t=this._canvasWidth/2;for(let n=0;n<this._canvasWidth;n++){let i=.5+n-t;e[n]=this._invdevroot2pi*Math.exp(-Math.pow(i-this._mean,2)/(2*this._variance))}let n=Math.max.apply(null,e),i=this._level/(n*n);for(let t=0;t<this._canvasWidth;t++){let n=t*this._canvasWidth;for(let r=0;r<this._canvasWidth;r++)this._pdf[n+r]=i*e[t]*e[r]}this.done=!0}stddevOrScaleChanged(){this._stddev=Math.round(this._displayStdDev*this._scaleFactor),this.canvasWidthChanged(),this._variance=Math.pow(this._stddev,2),this._invdevroot2pi=1/(Math.sqrt(2*Math.PI)*this._stddev),this.done=!1}canvasWidthChanged(){let e=this._width*this._stddev;this._canvasWidth!==e&&(this._canvasWidth=e,this._pdf=new Float32Array(e*e),this.rawCanvas.width=e,this.rawCanvas.height=e,this.done=!1)}}var P=n(0),O=n.n(P);class k{constructor(e,t,i){this.renderer=e,this.passes=[this],this.plotSize=t,this.windowSize=i,this.vertexKdeSrc=n(71),this.fragmentKdeSrc=n(72),this.vertexFloatPackSrc=n(28),this.fragmentFloatPackSrc=n(73),this.vertexDeclipSrc=n(28),this.fragmentDeclipSrc=n(74),this.vertCoords=new Float32Array([-1,-1,-1,1,1,-1,1,1]),this.numVertices=4,this.texCoords=new Float32Array([0,1,0,0,1,1,1,0]),this.quadIndices=new Uint16Array([0,1,2,0,2,3]),this.textureSize=128}setPoints(e){let t=this.renderer.gl;this.scatterPlotShader=new O.a.GLShader(t,this.vertexKdeSrc,this.fragmentKdeSrc),this.scatterPlotShader.bind(),this.scatterPlotShader.uniforms.uSampler=0,this.pointCoords=e,this.numPoints=e.length/2;let n=new O.a.GLBuffer.createVertexBuffer(t,e),i=new Uint16Array(e.length/2);for(let e=0;e<i.length;e++)i[e]=e;let r=new O.a.GLBuffer.createIndexBuffer(t,i);this.vao=new O.a.VertexArrayObject(t),this.vao.addAttribute(n,this.scatterPlotShader.attributes.aVertexPosition),this.vao.addIndex(r),this.floatPackShader=new O.a.GLShader(t,this.vertexFloatPackSrc,this.fragmentFloatPackSrc),this.floatPackShader.bind();let o=new O.a.GLBuffer.createVertexBuffer(t,this.vertCoords),a=new O.a.GLBuffer.createVertexBuffer(t,this.texCoords),s=new O.a.GLBuffer.createVertexBuffer(t,this.quadIndices);this.vaoPackQuad=new O.a.VertexArrayObject(t),this.vaoPackQuad.addAttribute(o,this.floatPackShader.attributes.aVertexPosition),this.vaoPackQuad.addAttribute(a,this.floatPackShader.attributes.aTextureCoord),this.vaoPackQuad.addIndex(s),this.declippingShader=new O.a.GLShader(t,this.vertexDeclipSrc,this.fragmentDeclipSrc),this.declippingShader.bind(),this.declippingShader.uniforms.uSampler=0;let l=new O.a.GLBuffer.createVertexBuffer(t,this.vertCoords),c=new O.a.GLBuffer.createVertexBuffer(t,this.texCoords),u=new O.a.GLBuffer.createVertexBuffer(t,this.quadIndices);this.vaoQuad=new O.a.VertexArrayObject(t),this.vaoQuad.addAttribute(l,this.declippingShader.attributes.aVertexPosition),this.vaoQuad.addAttribute(c,this.declippingShader.attributes.aTextureCoord),this.vaoQuad.addIndex(u)}__saveGLState(){let e=this.renderer.gl;this.glState={},this.glState.blend=e.getParameter(e.BLEND),this.glState.depthTest=e.getParameter(e.DEPTH_TEST),this.glState.colorClearValue=e.getParameter(e.COLOR_CLEAR_VALUE),this.glState.blendEquationSeparate={},this.glState.blendEquationSeparate.alpha=e.getParameter(e.BLEND_EQUATION_ALPHA),this.glState.blendEquationSeparate.rgb=e.getParameter(e.BLEND_EQUATION_RGB),this.glState.blendFuncSeparate={},this.glState.blendFuncSeparate.src_rgb=e.getParameter(e.BLEND_SRC_RGB),this.glState.blendFuncSeparate.dst_rgb=e.getParameter(e.BLEND_DST_RGB),this.glState.blendFuncSeparate.src_alpha=e.getParameter(e.BLEND_SRC_ALPHA),this.glState.blendFuncSeparate.dst_alpha=e.getParameter(e.BLEND_DST_ALPHA)}__restoreGLState(){let e=this.renderer.gl;void 0!==this.glState&&(this.glState.blend?e.enable(e.BLEND):e.disable(e.BLEND),this.glState.depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),e.clearColor(this.glState.colorClearValue[0],this.glState.colorClearValue[1],this.glState.colorClearValue[2],this.glState.colorClearValue[3]),e.blendEquationSeparate(this.glState.blendEquationSeparate.rgb,this.glState.blendEquationSeparate.alpha),e.blendFuncSeparate(this.glState.blendFuncSeparate.src_rgb,this.glState.blendFuncSeparate.dst_rgb,this.glState.blendFuncSeparate.src_alpha,this.glState.blendFuncSeparate.dst_alpha))}draw(e,t){this.stddev=e,this.contours=t;let n=this.renderer.gl;this.__saveGLState();let i=new T(0,10,16,1,4);this.kernelTexture=new O.a.GLTexture.fromSource(n,i.canvas,!1),this.renderArray=new Float32Array(4*this.textureSize*this.textureSize);n.getExtension("OES_texture_float"),n.getExtension("OES_texture_float_linear"),n.getExtension("WEBGL_color_buffer_float"),n.getExtension("EXT_color_buffer_float"),n.getExtension("EXT_float_blend");this.fbo=O.a.GLFramebuffer.createFloat32(n,this.textureSize,this.textureSize,this.renderArray);let r=!0;this.fbo.texture.minFilter(r),this.fbo.texture.magFilter(r),this.fbo.texture.enableWrapClamp(),this.fbo.enableTexture(this.fbo.texture),n.disable(n.DEPTH_TEST);let o=n.checkFramebufferStatus(n.FRAMEBUFFER);if(n.FRAMEBUFFER_COMPLETE!==o)return console.log("Frame buffer object is incomplete: "+o.toString()),error();this.scatterPlotShader.bind(),this.scatterPlotShader.uniforms.bounds=[this.plotSize,this.plotSize],this.scatterPlotShader.uniforms.uFourSigma=this.stddev,r=!0,this.kernelTexture.minFilter(r),this.kernelTexture.magFilter(r),this.kernelTexture.enableWrapClamp(),this.kernelTexture.bind(0),this.scatterPlotShader.uniforms.u_KernelSampler=0,n.enable(n.BLEND),n.blendFunc(n.ONE,n.ONE),n.viewport(0,0,this.textureSize,this.textureSize),n.clearColor(0,0,0,1),n.clear(n.COLOR_BUFFER_BIT),this.vao.bind(),n.drawElements(n.POINTS,this.numPoints,n.UNSIGNED_SHORT,0);n.getError();this.vao.unbind(),this.kernelTexture.unbind(),this.fbo.unbind(),n.clearColor(0,0,0,1),n.clear(n.COLOR_BUFFER_BIT),this.fboPack=O.a.GLFramebuffer.createRGBA(n,this.textureSize,this.textureSize),this.fboPack.texture.minFilter(!1),this.fboPack.texture.magFilter(!1),this.fboPack.texture.enableWrapClamp(),this.fboPack.enableTexture(this.fboPack.texture),n.disable(n.BLEND),n.disable(n.DEPTH_TEST),n.viewport(0,0,this.textureSize,this.textureSize),this.vaoPackQuad.bind(),this.floatPackShader.bind(),this.fbo.texture.bind(0),this.floatPackShader.uniforms.uSampler=0,n.drawArrays(n.TRIANGLE_STRIP,0,this.numVertices);let a=this.__readPackedFloat();this.fbo.texture.unbind(),this.vaoPackQuad.unbind(),this.fboPack.unbind(),n.clearColor(0,0,0,1),n.clear(n.COLOR_BUFFER_BIT);let s=0;for(let e=0;e<a.length;e+=4)a[e]>s&&(s=a[e]);n.viewport(0,0,this.windowSize,this.windowSize),this.declippingShader.bind(),this.declippingShader.uniforms.uRange=s,this.declippingShader.uniforms.uLevels=this.contours,this.vaoQuad.bind(),this.fbo.texture.bind(),n.drawArrays(n.TRIANGLE_STRIP,0,this.numVertices),this.fbo.texture.unbind(),this.vaoQuad.unbind(),this.rawCanvas=document.createElement("canvas"),this.rawCanvas.width=this.windowSize,this.rawCanvas.height=this.windowSize;let l=this.rawCanvas.getContext("2d"),c=l.createImageData(this.windowSize,this.windowSize);this.__imageDataFromGL(c,this.windowSize,this.windowSize),l.putImageData(c,0,0);let u=PIXI.Texture.fromCanvas(this.rawCanvas,PIXI.SCALE_MODES.LINEAR);return n.clearColor(0,0,0,1),n.clear(n.COLOR_BUFFER_BIT),this.__restoreGLState(),u}__readPackedFloat(){let e=this.renderer.gl;e.finish();let t=new Uint8Array(this.textureSize*this.textureSize*4);return e.readPixels(0,0,this.textureSize,this.textureSize,e.RGBA,e.UNSIGNED_BYTE,t),e.finish(),new Float32Array(t.buffer)}__imageDataFromGL(e,t,n){let i=this.renderer.gl;i.finish();let r=new Uint8Array(t*n*4);i.readPixels(0,0,t,n,i.RGBA,i.UNSIGNED_BYTE,r),e.data.set(new Uint8ClampedArray(r)),i.finish()}}class M{constructor(e,t,n,i,r,o,a,s){this.parentPlot=e,this.label=t,this.selectionsRoot=n,this.container=new PIXI.Container,this.container.interactive=!1,this.container.visible=!1,this.selectionsRoot.addChild(this.container),this.kdeOn=!1,this.kernelTexture=void 0,this.pdf=void 0,this.zoomFactor=s||1,this.color=r,this.pointSize=i,this.spriteDrawingScale=4,this.pointTexture=this.__createPointTexture(i*this.spriteDrawingScale,16777215),this.xTexture=this.__createXTexture(i*this.spriteDrawingScale,16777215),this.oTexture=this.__createOTexture(i*this.spriteDrawingScale,16777215),this.pointSprites=[],this.origTextures=[],this.linkedPoints=[],this.points=[],this.scaleFuncX=o,this.scaleFuncY=a,this.outlineFilter=new PIXI.filters.DropShadowFilter,this.outlineFilter.alpha=1,this.outlineFilter.blur=0,this.outlineFilter.distance=1,this.outlineFilter.padding=2,this.outlineFilter.color=16777215,this.sizeOnActive=!1}get visible(){return this.container.visible}set visible(e){this.container.visible=e}get outline(){return void 0!==this.container.filters&&-1!==this.container.filters.indexOf(this.outlineFilter)}set outline(e){if(e)this.container.filters?-1===this.container.filters.indexOf(self.outlineFilter)&&this.container.filters.push(self.outlineFilter):this.container.filters=[self.outlineFilter];else{let e=this.container.filters.indexOf(this.outlineFilter);this.container.filters.splice(e,1)}}__createPointTexture(e,t){let n=new PIXI.Graphics;return n.beginFill(0,0),n.drawRect(0,0,e,e),n.endFill(),n.beginFill(t,1),n.drawCircle(0,0,e),n.endFill(),n.generateTexture(1,PIXI.SCALE_MODES.LINEAR)}__createXTexture(e,t){let n=new PIXI.Graphics;return n.lineStyle(2*this.spriteDrawingScale,0,1),n.moveTo(0,0),n.lineTo(e,e),n.moveTo(e,0),n.lineTo(0,e),n.generateTexture(1,PIXI.SCALE_MODES.LINEAR)}__createOTexture(e,t){let n=new PIXI.Graphics;return n.beginFill(0,1),n.drawRect(-e,-e,2*e,2*e),n.endFill(),n.lineStyle(2*this.spriteDrawingScale,t,1),n.drawCircle(0,0,e+2),n.generateTexture(1,PIXI.SCALE_MODES.LINEAR)}destroy(){for(let e=0,t=this.pointSprites.length;e<t;e++)this.container.removeChild(this.pointSprites[e]),this.pointSprites[e].destroy();this.container=void 0,this.pointSprites=[],this.points=[],this.pointTexture=void 0}colorToOverrideMatrix(e){return[((16711680&e)>>16)/255,0,0,0,0,0,((65280&e)>>8)/255,0,0,0,0,0,(255&e)/255,0,0,0,0,0,1,0]}colorToInactiveOverrideMatrix(e){let t=.21*((16711680&e)>>16)/255+.72*((65280&e)>>8)/255+.07*(255&e)/255;return[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0]}colorToLuminanceMatrix(){return[.21,.72,.07,0,0,.21,.72,.07,0,0,.21,.72,.07,0,0,0,0,0,1,0]}colorPreserveMatrix(e){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]}pointOver(e){let t=e.target,n=this.pointSprites.indexOf(t);if(n>-1){this.linkedPoints[n]&&this.parentPlot.annotatePoint(this.linkedPoints[n])}}addPoint(e,t,n,i,r){let o;return(o="X"===i?new PIXI.Sprite(this.xTexture):"O"===i?new PIXI.Sprite(this.oTexture):new PIXI.Sprite(this.pointTexture)).anchor.x=.5,o.anchor.y=.5,o.position.x=this.scaleFuncX(e.x),o.position.y=this.scaleFuncY(e.y),o.interactive=!0,o.point=e,o.tint=t||this.color,o.scale={x:(n||1)/(this.spriteDrawingScale*this.zoomFactor),y:(n||1)/(this.spriteDrawingScale*this.zoomFactor)},o.pointSize=n||1,this.container.addChild(o),this.pointSprites.push(o),this.origTextures.push(o.texture),this.linkedPoints.push(r),this.points.push(e),o}zoom(e){let t=this;this.zoomFactor=e,this.pointSprites.forEach(function(n,i,r){n.scale={x:n.pointSize/(e*t.spriteDrawingScale),y:n.pointSize/(e*t.spriteDrawingScale)}})}setKdeOn(e,t){this.kdeOn||(this.kdeOn=!0,this.__addKDEToContainer(e,t))}updateKde(e,t){this.refreshKDE(e,t)}setKdeOff(){this.kdeOn=!1,this.__removeKDEFromContainer()}kdeValues(){let e={activate:this.kdeOn,sigma:12,contours:32};return this.kdeTexture&&(e.sigma=this.kdeTexture.stddev,e.contours=this.kdeTexture.contours),e}removePoint(e){let t=this.points.indexOf(e),n=this.pointSprites[t];this.container.removeChild(n),this.points.splice(t,1),this.pointSprites.splice(t,1)}setColor(e){this.container.children.map(function(t){t.tint=e})}setAlpha(e){this.container.alpha=e}showBlur(){}hideBlur(){}__setupKDETexture(){this.kdeTexture=new k(this.parentPlot.renderer,this.parentPlot.plotSize,this.parentPlot.plotWindowSize);let e=new Float32Array(2*this.pointSprites.length);this.pointSprites.forEach(function(t,n,i){e[2*n]=t.position.x,e[2*n+1]=t.position.y}),this.kdeTexture.setPoints(e)}__addKDEToContainer(e,t){void 0===this.kdeTexture&&this.__setupKDETexture();let n=this.kdeTexture.draw(e,t);this.kdeSprite=new PIXI.Sprite(n),this.kdeSprite.anchor.x=.5,this.kdeSprite.anchor.y=.5,this.kdeSprite.position.x=this.parentPlot.plotSize/2,this.kdeSprite.position.y=this.parentPlot.plotSize/2,this.kdeSprite.alpha=1,this.kdeSprite.interactive=!1,this.kdeSprite.visible=!0,this.kdeSprite.width=this.parentPlot.plotSize,this.kdeSprite.height=this.parentPlot.plotSize,this.container.addChild(this.kdeSprite),this.container.setChildIndex(this.kdeSprite,0),this.pointSprites.forEach(function(e,t,n){e.alpha=0})}refreshKDE(e,t){this.container.removeChild(this.kdeSprite),this.__addKDEToContainer(e,t)}__removeKDEFromContainer(){this.container.removeChild(this.kdeSprite),this.pointSprites.forEach(function(e,t,n){e.alpha=1})}}n(8);const L=n(2),B=n(4);class D{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.elementId=e,this.plotElement=$("#"+this.elementId)[0],this.plotWindowSize=this.plotElement.clientWidth,this.renderer=PIXI.autoDetectRenderer(this.plotWindowSize,this.plotWindowSize,{autoResize:!0,forceFXAA:!0,preserveDrawingBuffer:!0},t),this.plotElement.appendChild(this.renderer.view),this.plotRoot=new PIXI.Container,this.plotRoot.interactive=!0,this.plotRoot.visible=!0,this.pointSprites}setScaling(e){const t=L(e,[this.numPoints,2]);let n=B.sup(t.pick(null,0)),i=B.sup(t.pick(null,1)),r=B.inf(t.pick(null,0)),o=B.inf(t.pick(null,1)),a=n-r,s=i-o;this.yScaleFunc=(e=>(e-o)*((this.plotWindowSize-20)/s)+10),this.xScaleFunc=(e=>(e-r)*((this.plotWindowSize-20)/a)+10)}plotPoints(e,t,n,i){if(this.numPoints=e.length/2,this.setScaling(e),this.pointSprites&&this.pointSprites.length>0)this.movePoints(e);else{this.pointSprites=new Array(this.numPoints),this.pointGroup=new M(this,"plot_"+this.elementId,this.plotRoot,3,8421504,this.xScaleFunc,this.yScaleFunc,null),this.pointGroup.visible=!1;for(let t=0;t<this.numPoints;t++)this.pointSprites[t]=this.pointGroup.addPoint({x:e[2*t],y:e[2*t+1]},n);this.pointGroup.visible=!0,this.renderer.render(this.plotRoot)}}movePoints(e){this.pointGroup.visible=!1;for(let t=0;t<this.numPoints;t++)this.pointSprites[t].position.x=this.xScaleFunc(e[2*t]),this.pointSprites[t].position.y=this.yScaleFunc(e[2*t+1]);this.pointGroup.visible=!0,this.renderer.render(this.plotRoot)}render(){this.renderer.gl&&this.renderer.render(this.plotRoot)}}let N=null;class U{constructor(e){return N||(this.containerId=e,this.monitors=new Map,this.jsonStatuses=[],this._initTable(),this.plotPopup=null,this.activePlots=null,this.visiblePlot=null,this.plotInterval=null,this.activeGroupId=null,this.activeMonitorId=null,this.plotUpdateInterval=500,N=this)}_initTable(){let e=document.getElementById(this.containerId);if(!e)return;for(;e.firstChild;)e.removeChild(e.firstChild);this.jobMonitorControl=webix.ui({view:"window",container:this.containerId,hidden:!0,move:!0,css:"tutorialWindow",sizeToContent:!0,id:"jobMonitorControlWindow",head:{view:"toolbar",margin:-4,cols:[{view:"label",label:"Replot Jobs"},{view:"icon",icon:"times-circle",css:"alter",on:{onItemClick:function(e,t){N.hideControl()}}}]},body:{id:"jobMonitorControlTable",view:"datatable",columns:[{id:"jobid",header:"Job id",css:"rank",adjust:"data"},{id:"createtime",header:"Created",adjust:"data"},{id:"status",header:"Status",adjust:"data",minWidth:80},{id:"progress",header:"Completed",adjust:"data",minWidth:80},{id:"delete",header:"Remove",adjust:"data",template:"<input class='delbtn' type='button' value='Delete'>",minWidth:80},{id:"show",header:"Detail",adjust:"data",template:"<input class='showbtn' type='button' value='Show'>",minWidth:80},{id:"monitor",header:"Monitor",hidden:!0}],autoheight:!0,autowidth:!0,onClick:{delbtn:(e,t,n)=>{let i=this.table.getItem(t.row).jobid,r=this.table.getItem(t.row).monitor;return webix.message("Deleting job: "+i),this.monitors.get(r).cancelJob(i),!1},showbtn:(e,t,n)=>{if(this.plotPopup&&this.destructPopup(),!this.plotPopup){let e=this.table.getItem(t.row).jobid,n=this.table.getItem(t.row).monitor;this.showJobPlotPopup(e,n)}}}}}),this.table=$$("jobMonitorControlTable")}jobIdToCanvasId(e){return"plotCanvas_"+e.replace(/\W/g,"_")}showJobPlotPopup(e,t){const n=this.monitors.get(t);this.visiblePlot=null;const i=function(e){return'<div id="'+e.id+'" style="height 380px; width: 380px"></div><div><div class="title" style="display:inline, float:left">'+e.title+'</div><div class="text" id="ProgressPlot_'+e.id+'" style="display:inline, float:right"></div></div>'},r=n.getJobGroup(e),o=JSON.parse(JSON.stringify({view:"popup",move:!0,head:"Job data monitor",height:460,width:400,left:50,top:50,body:{view:"carousel",id:"jobPlotCarousel",cols:[],navigation:{type:"side",items:!1},template:"Some text"}})),a=r.jobIds,s=new Array(r.numSubJobs);for(let e=0;e<s.length;e++){const t={id:"plotCarouselItem_"+e,template:i,data:{id:this.jobIdToCanvasId(a[e]),title:a[e],progress:"Job not started"}};s[e]=t}o.body.cols=s,this.plotPopup=webix.ui(o),this.plotPopup.show(),this.visiblePlot=a[0],this.plotPopup.attachEvent("onHide",()=>{this.destructPopup()}),this.activeGroupId=e,this.activeMonitorId=t,$$("jobPlotCarousel").attachEvent("onShow",e=>{this.visiblePlot=$$("jobPlotCarousel").config.cols.find(function(t){return t.id===e}).data.title,this.plot()}),this.activePlots=new Map;var l=!0,c=!1,u=void 0;try{for(var h,d=a[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){let e=h.value;this.activePlots.set(e,new D(this.jobIdToCanvasId(e),!0))}}catch(e){c=!0,u=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw u}}this.plot(!0),this.plotInterval=setInterval(this.plot.bind(this),this.plotUpdateInterval)}destructPopup(){this.plotInterval&&clearInterval(this.plotInterval),this.activeGroupId=null,this.activeMonitorId=null,this.plotPopup.destructor(),this.activePlots.clear(),this.plotPopup=null}updateProgressText(e,t){document.getElementById("ProgressPlot_"+this.jobIdToCanvasId(e)).innerHTML=t}plot(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.plotPopup)return;const t=this.monitors.get(this.activeMonitorId),n=t.progressData[this.activeGroupId],i=t.getJobGroup(this.activeGroupId).jobIds;if(e){var r=!0,o=!1,a=void 0;try{for(var s,l=i[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){let e=s.value;n[e]&&n[e].data&&this.activePlots.has(e)&&(this.updateProgressText(e,n[e].string),this.activePlots.get(e).plotPoints(n[e].data,3,8421504,0))}}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}}else n[this.visiblePlot]&&(this.updateProgressText(this.visiblePlot,n[this.visiblePlot].string),n[this.visiblePlot].data&&this.activePlots.get(this.visiblePlot).plotPoints(n[this.visiblePlot].data,3,8421504,0))}subscribeToJobMonitor(e){if(!this.monitors.has(e.pubsubid)){this.monitors.set(e.pubsubid,e);let t=!0;PubSub.subscribe(e.pubsubid,(e,n)=>{if(this._updateView(e,n),t&&!this.plotPopup){let e=this.table.getLastId(),n=this.table.getItem(e).jobid,i=this.table.getItem(e).monitor;this.showJobPlotPopup(n,i),t=!1}})}}_updateView(e,t){let n=[];this.monitors.forEach((e,t,i)=>{let r=e.jsonStatuses;r.forEach((e,n,i)=>{e.monitor=t,r[n]=e}),n.push(...e.jsonStatuses)}),this.table.clearAll(),this.table.parse(n)}getColumnData(e){let t=[];return this.table.eachRow(n=>{t.push(this.table.getItem(n)[e])}),t}showControl(){this.jobMonitorControl.show(),this.enabled=!0}hideControl(){this.jobMonitorControl.hide(),this.enabled=!1}toggleControlVisibility(){this.enabled?this.hideControl():this.showControl()}}var V=n(35),j=n.n(V);class F{static get StatusEnum(){return{UNITIALIZED:Symbol("Job not yet submitted - under construction"),SUBMITTED:Symbol("Job submitted to dimensionality reduction service (DimRS)"),SUCCESS:Symbol("Job successfully completed"),FAIL:Symbol("Job failed")}}static get SubJobIs(){return{ROW:Symbol("Row job"),COL:Symbol("Col job")}}static get SelectIs(){return{ROW:Symbol("Selection is row"),COL:Symbol("Selection is col")}}constructor(e,t){this.createdTime=Date.now(),this.selection=e,this.submittedTime=void 0,this.completedTime=void 0,this.selectType=t,this.subJobs=[],this.status=F.StatusEnum.UNITIALIZED,this.completionStatus=""}addSubJob(e,t){this.subJobs.push({data:e,jobType:t,resultMap:void 0,resultValue:void 0,tsneParams:{perplexity:30,n_iter:1e3,n_components:2}})}submit(){this.submittedTime=Date.now();let e=[];this.subJobs.forEach((t,n)=>{console.log("processing subjob: "+String(t.jobType));let i=new Promise((e,t)=>{setTimeout(function(){t.resultValue=n,e(n)})});e.push(i)});let t=this;j()(regeneratorRuntime.mark(function n(){var i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e;case 3:return i=n.sent,t.completedTime=Date.now(),t.status=F.StatusEnum.SUCCESS,console.log("Passed: "+i),n.abrupt("return",!0);case 10:return n.prev=10,n.t0=n.catch(0),console.log(n.t0),t.status=F.StatusEnum.FAIL,t.completedTime=Date.now(),console.log("Failed"+n.t0),n.abrupt("return",!1);case 17:case"end":return n.stop()}},n,this,[[0,10]])}))}isStatus(e){return this.status===e}}class z{constructor(e){if(this.instance)return e&&this.instance.init(e),this.instance;this.__init(e),this.instance=this}__init(e){this.predefinedSelections=[],this.staticSelections=[],this.dynamicSelections=[],this.combinedSelections=[],e.predefinedSelections&&(this.predefinedSelections=e.predefinedSelections);var t=!0,n=!1,i=void 0;try{for(var r,o=e.plots[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){let e=r.value.selections;e.selectionOut&&(this.staticSelections.includes(e.selectionOut)||(this.staticSelections.push(e.selectionOut),this.combinedSelections.push({id:e.selectionOut,dynamic:!1}))),e.dynamicSelectionOut&&(this.dynamicSelections.includes(e.dynamicSelectionOut)||(this.dynamicSelections.push(e.dynamicSelectionOut),this.combinedSelections.push({id:e.selectionOut,dynamic:!0})))}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}getStaticSelectionsAsIdValueArray(){let e=[];var t=!0,n=!1,i=void 0;try{for(var r,o=this.staticSelections[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){let t=r.value;e.push({id:t,value:t})}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}return e}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(z,"instance",void 0);class G{constructor(e,t){this.mappings=t,this.configNames=e}static newFromPlotInfo(e){return new G(["Default"],{Default:{selectionIn:e.selections.selectionIn,dynamicSelectionIn:e.selections.dynamicSelectionIn}})}getSelectionMapping(e){return this.mappings[e].selectionIn}getDynamicSelectionMapping(e){return this.mappings[e].dynamicSelectionIn}}class Q{constructor(e){this.mappings=mappingData,this.configNames=configNames}}let Y=n(75);Y.keys().map(Y);class W{constructor(){this.lutNameGroups={"Diverging maps":["BrBG","bwr","coolwarm","PiYG","PRGn","PuOr","RdBu","RdGy","RdYlBu","RdYlGn","Spectral","seismic"],"Perceptually Uniform":["viridis","inferno","plasma","magma"],"Sequential Maps":["Blues","BuGn","BuPu","GnBu","Greens","Greys","Oranges","OrRd","PuBu","PuBuGn","PuRd","Purples","RdPu","Reds","YlGn","YlGnBu","YlOrBr","YlOrRd"],"Sequential(2) Maps":["afmhot","autumn","bone","cool","copper","gist_heat","gray","hot","pink","spring","summer","winter"]}}getLutNameGroups(){return this.lutNameGroups}getLutTexture(e,t){let n=new Image;n.onload=(()=>{let e=new PIXI.Texture(new PIXI.BaseTexture(n));e.scaleMode=PIXI.SCALE_MODES.NEAREST,t(e)}),n.src=Y("./"+e+".png")}}class H extends PIXI.AbstractFilter{constructor(e){let t=n(147),i=document.createElement("canvas");i.width=16,i.height=16;let r=H.__getDynamicLutTexture(i,2851271,16119236,12200544);super(null,t,{colorSampler:{type:"sampler2D",value:r}}),this.fragmentSrc=t,this.passes=[this],this.rawCanvas=i,this.begin=2851271,this.middle=16119236,this.end=12200544,this.texture=r,this.lutTexture=new W,this.currentName="",this.background=e,this.background_red=((16711680&e)>>16)/255,this.background_green=((65280&e)>>8)/255,this.background_blue=(255&e)/255}setColorMapPoints(e,t,n){this.begin=e,this.end=n,this.middle=t,this.texture=H.__getDynamicLutTexture(this.rawCanvas,this.begin,this.middle,this.end),this.uniforms={colorSampler:{type:"sampler2D",value:this.texture},background:{type:"3f",value:[this.background_red,this.background_green,this.background_blue]}},PIXI.AbstractFilter.call(this,null,this.fragmentSrc,this.uniforms)}static __getDynamicLutTexture(e,t,n,i){let r=e.getContext("2d");r.fillRect(0,0,16,16);let o=r.getImageData(0,0,16,16),a=o.data,s=new ReScatter.utils.ColorRamp;s.colorIntervals=[t,n,i],s.range=[0,255];for(let e=0;e<16;e++){let t=16*e*4;for(let n=0;n<16;n++){let i=t+4*n,r=s.getColorInRange(16*e+n);r=parseInt(r,16),a[i]=r>>>16&255,a[i+1]=r>>>8&255,a[i+2]=255&r,a[i+3]=256}}return a[0]=a[1]=a[2]=0,r.putImageData(o,0,0),new PIXI.Texture.fromCanvas(e,PIXI.SCALE_MODES.NEAREST)}setLut(e,t){this.currentName=e,this.lutTexture.getLutTexture(e,e=>{this.texture=e,this.uniforms={colorSampler:{type:"sampler2D",value:this.texture},background:{type:"3f",value:[this.background_red,this.background_green,this.background_blue]}},PIXI.AbstractFilter.call(this,null,this.fragmentSrc,this.uniforms),t()})}getLutNames(){return this.lutTexture.getLutNames()}}const K=f.define(["index"],{getNumberofCanvases:[],getCanvasNameAtIndex:["index"],getCanvasAtIndex:["index"]}),q=f.define(["index"],{getNumberofSVGFragments:[],getSVGNameAtIndex:["index"],getSVGTextAtIndex:["index"],getCSSTextAtIndex:["index"]});class X{constructor(e){this.svgId=e}}g.impl(X,[],{onPlethResize(){},loadPleth(){this.locatorRoot=document.body.querySelector("#"+this.svgId)},clearPlethColors(){$(this.locatorRoot).find("path[structure_id]").each(function(){$(this).css("fill","#ffffff")})},savePlethColors(){$(this.locatorRoot).find("path[structure_id]").each(function(){let e=$(this).css("fill");$(this).attr("iedata:savefill",e)})},restorePlethColors(){$(this.locatorRoot).find("path[structure_id]").each(function(){let e=$(this).attr("iedata:savefill");$(this).css("fill",e)})},setPlethColorsFromMap(e){let t=e=>e;"number"==typeof e[0]&&(t=(e=>"#"+e.toString(16)));let n=this;Object.keys(e).map(function(i){$(n.locatorRoot).find('path[structure_id="'+i+'"]').css("fill",t(e[i]))})}}),q.impl(X,[],{getNumberofSVGFragments(){let e=ReScatter.layoutManager.getCanvasSvgId();if(null!==e){return document.getElementById(e).childNodes.length}return 0},getSVGNameAtIndex:e=>"thematicmap_"+e,getSVGTextAtIndex(e){let t=ReScatter.layoutManager.getCanvasSvgId();if(null!==t){return document.getElementById(t).childNodes[e].innerHTML}return""},getCSSTextAtIndex:e=>""});var J=X;class Z{static get InterpolationEnum(){return{RGB:0,HSV:1}}constructor(){this._range=[0,255],this._colorArray=[16711680,16777215,255],this._intervals=[]}get range(){return this._range}set range(e){2===e.length&&(e[1]<=e[0]||(this._range=e,this._refreshColorIntervals()))}get colorIntervals(){return this._colorArray}set colorIntervals(e){e.map(function(e){return Math.round(e)}),e.forEach(function(e){if(0>e||e>16777215)throw new Error("Color value outside RGB range")}),this._colorArray=e,this._refreshColorIntervals()}getColorInRange(e){return e<this._range[0]&&(e=this._range[0]),e>this._range[1]&&(e=this._range[1]),this._rgbInterpolate(e)}_rgbInterpolate(e){let t=this._range[1]-this._range[0],n=this._colorArray.length-1,i=e-this._range[0],r=i<t?Math.floor(i/t*n):n-1,o=this._intervals[r],a=i-t/n*r;return o.cr+Math.round(o.crStep*a)<<16|o.cg+Math.round(o.cgStep*a)<<8|o.cb+Math.round(o.cbStep*a)}_hsvInterpolate(){}_refreshColorIntervals(){let e=this._range[1]-this._range[0],t=this._colorArray.length-1;if(t<1)return;let n=e/t;this._intervals=new Array(t);for(let e=0;e<t;e++){let t=this._colorArray[e],i=(16711680&t)>>>16,r=(65280&t)>>>8,o=255&t,a=this._colorArray[e+1],s=(16711680&a)>>>16,l=(65280&a)>>>8,c=255&a;this._intervals[e]={c:t,cr:i,crStep:(s-i)/n,cg:r,cgStep:(l-r)/n,cb:o,cbStep:(c-o)/n}}}}const ee=n(148);HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){let i=atob(this.toDataURL(t,n).split(",")[1]),r=i.length,o=new Uint8Array(r);for(let e=0;e<r;e++)o[e]=i.charCodeAt(e);e(new Blob([o],{type:t||"image/png"}))}});class te{static __getCleanupLinkFn(e){return function(){document.body.removeChild(e)}}static saveCanvasToPng(e,t){let n=document.getElementById(e).childNodes[0];this.saveRawCanvasToPng(n,t)}static saveRawCanvasToPng(e,t){e.toBlob(e=>{ee.saveAs(e,t)})}static saveTextToFile(e,t){let n=$(e).text();ee.saveAs(new Blob([n],{type:"text/plain;charset="+document.characterSet}),t)}static __createImgOnLoad(e,t){return function(){let n=document.createElement("canvas");n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(t,0,0,n.width,n.height),n.toBlob(t=>{ee.saveAs(t,e)})}}static __formatSVGForRendering(e,t){let n=e.match(/viewBox=\"\d+ \d+ (\d+) (\d+)\"/i),i=(new DOMParser).parseFromString(e,"image/svg+xml"),r=0,o=0;if(i.children[0].hasAttribute("width")&&i.children[0].hasAttribute("height")?(r=parseInt(i.children[0].getAttribute("width")),o=parseInt(i.children[0].getAttribute("height"))):n.length>=3&&(r=n[1],o=n[2],i.children[0].setAttribute("width",r+"px"),i.children[0].setAttribute("height",o+"px")),i.children[0].hasAttribute("xmlns")||i.children[0].setAttribute("xmlns","http://www.w3.org/2000/svg"),t){let e=i.createElement("style");e.innerHTML="/* <![CDATA[ */"+t+"/* ]]> */",i.children[0].appendChild(e)}return{svgString:(new XMLSerializer).serializeToString(i),width:r,height:o}}static saveSvgChildrenToPng(e,t){let n=document.getElementById(e);for(let e=0;e<n.childNodes.length;e++){let i=n.childNodes[e];this.saveSvgFragmentToPng(i.innerHTML,t)}}static saveSvgFragmentToPng(e,t,n){let i=this.__formatSVGForRendering(e,t),r=i.svgString,o=i.width,a=i.height,s=new Blob([r],{type:"image/svg+xml;charset=utf-8"}),l=window.URL||window.webkitURL||window,c=n+".png",u=new Image(2*o,2*a);u.onload=this.__createImgOnLoad(c,u),u.src=l.createObjectURL(s)}}class ne{constructor(e){this.enum={},this.revEnum={},Object.keys(e).forEach(function(t){this.enum[t]=e[t],this.revEnum[e[t]]=t},this)}}const ie={WIDGETS:"ReScatter_ControlId_Widgets",CHOROPLETH:"ReScatter_ControlId_Choropleth",IMAGESTRIPFOOTER:"ReScatter_ControlId_ImageStripFooter",CHARTS:"ReScatter_ControlId_Charts",LEFTSPLITTER:"ReScatter_ControlId_LeftSplitter",RIGHTSPLITTER:"ReScatter_ControlId_RightSplitter",TUTORIAL:"ReScatter_ControlId_Tutorial",TUTORIALCHECKBOX:"ReScatter_ControlId_TutorialCheckbox",TOOLTIPCHECKBOX:"ReScatter_ControlId_TooltipCheckbox",ANNOTATECHOROPLETH:"ReScatter_ControlId_AnnotateChoropleth",SELECTIONINFO:"ReScatter_ControlId_SelectionInfo",PLOTMENU:"ReScatter_ControlId_PlotMenu",EXTERNCONTAINER:"ReScatter_ControlId_ExternContainer",LOADINGOVERLAY:"ReScatter_ControlId_LoadingOverlay",LOADINGPROMPT:"ReScatter_ControlId_LoadingPrompt",JOBMONITOR:"ReScatter_ControlId_JobMonitor"};function re(e){let t=[];return Object.keys(e.enum).forEach(function(n){t.push(e.enum[n])}),t}function oe(e){let t=e.toString(16);if(t.length>6)throw new RangeError("Value too large to convert to 6 digit hexadecimal: "+e);return"#000000".slice(0,-t.length)+t}function ae(){return navigator.userAgent.indexOf("Vivaldi")>-1}function se(e){return e.sort().filter(function(e,t,n){return 0===t||e!==n[t-1]})}function le(e){return{color:parseInt("0x"+e,16)>8388607.5?"black":"white","background-color":"#"+e}}function ce(e){let t=le(e),n=" style='";for(let e in t)t.hasOwnProperty(e)&&(n=n+e+":"+t[e]+"; ");return n+="' "}function ue(e){return parseInt(e.replace("#","0x"))}function he(){let e=document.querySelectorAll("[id^='ReScatter.CONTROL_ID']"),t=new Set;var n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){let e=o.value;t.add(e.id)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}let s="ReScatter.CONTROL_ID.",l=Object.getOwnPropertyNames(ie),c=l.map(e=>s+e),u=new Set([...t].filter(e=>!c.includes(e)));ReScatter.debugOn&&u.size>0&&alert("ReScatter config detected unknown control ids in the html: "+Array.from(u));let h=new Set;return l.forEach(function(e){let t="[id='"+s+e+"']",n=document.querySelectorAll(t);0===n.length&&h.add(e);var i=!0,r=!1,o=void 0;try{for(var a,l=n[Symbol.iterator]();!(i=(a=l.next()).done);i=!0){a.value.id=ie[e]}}catch(e){r=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(r)throw o}}}),ReScatter.debugOn&&h.size>0&&alert("ReScatter config detected unused control ids in the html: "+Array.from(h)),Array.from(t)}function de(e){e.parentNode.style.display="none",e.parentNode.style.zIndex=-200}function pe(e){ReScatter.debugOn&&console.log(e)}function fe(e){ReScatter.debugOn&&console.warn(e)}function ge(e){ReScatter.debugOn&&console.error(e)}var Ae=f.define(["context"],{onControlEvent:["context"]});class me{constructor(){this.observerList=[]}add(e){return this.observerList.push(e)}count(){return this.observerList.length}get(e){if(e>-1&&e<this.observerList.length)return this.observerList[e]}indexOf(e,t){let n=t;for(;n<this.observerList.length;){if(this.observerList[n]===e)return n;n++}return-1}removeAt(e){this.observerList.splice(e,1)}}class ve{constructor(e){this.observers=new me,this.notifyName=e}addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.removeAt(this.observers.indexOf(e,0))}removeAllObservers(){let e=this.observers.count();for(let t=0;t<e;t++)this.observers.removeAt(0)}notify(e){let t=this.observers.count();for(let n=0;n<t;n++){let t=this.observers.get(n),i=t[this.notifyName];void 0!==i&&i.call(t,e)}}}class be extends ve{constructor(){super("onControlEvent"),this.activeSelection=void 0}putControlEventModel(e,t){this.notify({eventName:e,event:t})}addObserver(e){Ae.hasImpl(e)||alert("ControlEvent observer: "+e.constructor.name+" must implement the ControlProtocol"),super.addObserver(e)}}class ye extends ve{constructor(){super("update"),this.activeSelection=void 0}putDynamicSelection(e,t,n,i,r){n=void 0!==n?n:7807522,this.activeSelection={originator:e,dataPoints:t,color:n,selectionId:i,sourceProps:r},this.notify({type:"dyna",op:"create",sel:this.activeSelection,id:i,background:!1})}putTransitiveSelection(e,t,n,i){let r={originator:e,dataPoints:t,color:n=void 0!==n?n:7807522,selectionId:i};this.notify({type:"dyna",op:"transitive",sel:r,id:i})}removeDynamicSelection(e){this.activeSelection&&this.activeSelection.selectionId===e&&(this.notify({type:"dyna",op:"delete",sel:this.activeSelection,id:this.activeSelection.selectionId}),this.activeSelection=void 0)}}class we{constructor(){}performStartupAction(){if(this.registerSelectionMessageListener(),$("#rescatter-data")&&$("#rescatter-data").attr("data-start-selection")){let e=JSON.parse($("#rescatter-data").attr("data-start-selection"));if(ReScatter.dimres_url=null,e.dimres_url&&(ReScatter.dimres_url=e.dimres_url),!e.display)return void we.sendReadyMessageToOpener();ReScatter.viewController.loadLayoutByIndex(e.display,()=>{we.addSelection(e),ReScatter.selectionDataWidget.expand()})}}static addSelection(e){try{let t=e.selection.split(","),n=e.description,i=e.group,r=e.property,o=e.color||7807522,a=[],s="data-start-selection";t.forEach(function(e){a=a.concat(ReScatter.dataModel.getSelectionIndex(i,r,e))});let l=ReScatter.selectionModel.getNewLabel(i);ReScatter.selectionModel.putSelection(l,s,a,o,n,i,void 0,!0)}catch(e){console.log("Could not process query:"+e)}}static sendReadyMessageToOpener(){window.opener&&window.opener.postMessage("BrainScope ready","*")}registerSelectionMessageListener(){window.addEventListener("message",we.receiveSelectionMessage,{capture:!0})}static receiveSelectionMessage(e){if("string"!=typeof e.data)return;let t;e.data;try{t=JSON.parse(e.data)}catch(e){return}if(!(t.display&&t.group&&t.property&&t.selections))return;e.stopPropagation(),window.removeEventListener("message",we.receiveSelectionMessage);Date.now();ReScatter.viewController.loadLayoutByIndex(t.display,()=>{ReScatter.controlEventModel.putControlEventModel("showProgress",{}),ReScatter.controlEventModel.putControlEventModel("selectionsProgress",{selectionState:"Loading additional selections"}),ReScatter.selectionDataWidget.expand(),function e(n,i){let r=i[n].split(":"),o={description:r[0],selection:r[2],group:t.group,property:t.property,display:t.display,color:parseInt(r[1])};ReScatter.controlEventModel.putControlEventModel("selectionsProgress",{selectionState:"Loading selection: "+o.description}),we.addSelection(o),n+1<i.length?setTimeout(e(n+1,i),100):ReScatter.controlEventModel.putControlEventModel("hideProgress",{})}(0,t.selections.split(";"))})}}class Se{constructor(e,t){this.svgidList=t,this.svgRetrieveTemplate=e}loadImages(e){let t=[];e.forEach(function(e,n,i){let r=this.svgidList.indexOf(e);r>=0&&t.push({id:e,index:r})},this),ReScatter.choroplethControl.addSvgs(t,this.svgRetrieveTemplate)}}let Ee=null;class _e{constructor(){return Ee||(this.enabled=!1,Ee=this)}setupToolTip(e){let t=e.getAttribute("data-ime-tooltip-id"),n=document.querySelector("#"+t);null!==n&&(e.setAttribute("data-toggle","tooltip"),e.setAttribute("data-html","true"),e.setAttribute("title",n.innerHTML))}setupAllToolTips(){let e=document.querySelectorAll("[data-IME-tooltip-id]");if(null!==e)for(let t=0,n=e.length;t<n;t++)this.setupToolTip(e.item(t))}enableToolTips(){$('[data-toggle="tooltip"]').tooltip("enable"),this.enabled=!0,this.updateCheckBox()}disableToolTips(){$('[data-toggle="tooltip"]').tooltip("disable"),this.enabled=!1,this.updateCheckBox()}syncToolTips(){$('[data-toggle="tooltip"]').tooltip(this.getEnabledState())}getEnabledState(){return this.enabled?"enable":"disable"}addTooltip(e,t,n,i){if(!document.querySelector("#"+ReScatter.CONTROL_ID.TOOLTIPCHECKBOX))return;let r=document.querySelector("#"+e);null===r.getAttribute("data-ime-tooltip-id")&&(r.setAttribute("data-ime-tooltip-id",t),r.setAttribute("data-placement",n),void 0!==i&&r.setAttribute("data-container",i),this.setupToolTip(r),$("#"+e).tooltip&&$("#"+e).tooltip(this.getEnabledState()))}addTooltipToWebixControl(e,t,n,i){let r=e.getNode();r.setAttribute("data-ime-tooltip-id",t),r.setAttribute("data-placement",n),void 0!==i&&r.setAttribute("data-container",i)}removeToolTips(){}changedToolTipVisibility(){let e=document.querySelector("#"+ReScatter.CONTROL_ID.TOOLTIPCHECKBOX);e&&(e.checked?this.disableToolTips():this.enableToolTips())}updateCheckBox(){let e=document.querySelector("#"+ReScatter.CONTROL_ID.TOOLTIPCHECKBOX);e&&(this.enabled?e.nextSibling.data="Disable tooltips":e.nextSibling.data="Enable tooltips")}}let Re=new _e;class xe{constructor(e,t,n,i){this.svgRetrieveTemplate=t,this.thumbnailTemplate=n,this.svgidList=i,this.stripElementId=e,this.imageElements={},this.selected=[],this.__initialize()}imageClicked(e,t){let n,i=t.target;"selected_thumbnail"===i.className?(i.className="unselected_thumbnail",ReScatter.choroplethControl.removeSvg(i.dataset.svgindex),(n=this.selected.indexOf(i.dataset.svgid))>=0&&this.selected.splice(n,1)):(i.className="selected_thumbnail",ReScatter.choroplethControl.addSvg(i.dataset.svgid,i.dataset.svgindex,e),-1===(n=this.selected.indexOf(i.dataset.svgid))&&this.selected.push(i.dataset.svgid))}__initialize(){window.setTimeout(this.__populateImageStrip.bind(this),2e3)}__populateImageStrip(){let e=document.getElementById(this.stripElementId);Re.addTooltip(this.stripElementId,"IMEChoroplethStrip","top"),this.svgidList.forEach(function(t,n){let i=document.createElement("img");i.src=this.thumbnailTemplate.replace("<svgid>",t),i.className="unselected_thumbnail",i.onclick=this.imageClicked.bind(this,this.svgRetrieveTemplate),i.setAttribute("data-svgid",t),i.setAttribute("data-svgindex",n),this.imageElements[t]=i,e.appendChild(i)},this),this.selected.forEach(function(e){this.imageElements[e].className="selected_thumbnail"},this)}loadImages(e){let t=[];e.forEach(function(e){let n=this.svgidList.indexOf(e);n>=0&&t.push({id:e,index:n}),-1===this.selected.indexOf(e)&&this.selected.push(e),this.imageElements[e]&&(this.imageElements[e].className="selected_thumbnail")},this),ReScatter.choroplethControl.addSvgs(t,this.svgRetrieveTemplate)}}var Ce=f.define(["context"],{processSelectionEvent:["context"]});class Ie{constructor(e){Ce.hasImpl(new.target)||alert("SelectionSubscriber child: "+new.target.name+" must implement the SelectionProtocol"),this.selectionEventQueue=[],this.dynamicEventQueue=[],this.dynamicLimit=e,this.processingSelectionEventQueue=!1,this.ready=!1,this.processLoopTimer=void 0,this.processWatchdogTimer=void 0,this.processTimedout=!0}update(e){"dyna"===e.type&&void 0!==this.dynamicLimit?(this.dynamicEventQueue.push(e),this.dynamicEventQueue.length>this.dynamicLimit&&this.dynamicEventQueue.splice(0,this.dynamicEventQueue.length-this.dynamicLimit)):this.selectionEventQueue.push(e),this.processTimedout&&this.processingLoop(!0)}processingDone(){this.processWatchdogTimer&&clearTimeout(this.processWatchdogTimer),this.processTimedout=!1,this.ready=!0}processingLoop(e){let t=this;e&&void 0!==this.processLoopTimer&&(clearTimeout(this.processLoopTimer),this.processWatchdogTimer&&clearTimeout(this.processWatchdogTimer),this.processTimedout=!1),this.ready=e||this.ready,this.ready&&this.__processNextEvent(),this.processLoopTimer=setTimeout(function(){t.processingLoop(!1)},10)}__getNextSelectionEvent(){let e;try{this.selectionEventQueue.length>0?e=this.selectionEventQueue.shift():this.dynamicEventQueue.length>0&&(e=this.dynamicEventQueue.shift())}catch(e){console.log("Error fetching next event "+e)}return e}__processNextEvent(){let e=this,t=this.__getNextSelectionEvent();t&&(this.ready=!1,this.processTimedout=!1,this.processWatchdogTimer&&clearTimeout(this.processWatchdogTimer),this.processWatchdogTimer=setTimeout(function(){e.processTimedout=!0},1e3),this.processSelectionEvent(t))}}const Te={_svgs:[],_canvases:[],addComponent(e){K.hasImpl(e)?Te._canvases.push(e):q.hasImpl(e)&&Te._svgs.push(e)},snapshotAll(){var e=!0,t=!1,n=void 0;try{for(var i,r=Te._svgs[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){let e=i.value;Te.__snapShotSvgComponent(e)}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}var o=!0,a=!1,s=void 0;try{for(var l,c=Te._canvases[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){let e=l.value;Te.__snapShotCanvasComponent(e)}}catch(e){a=!0,s=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}},snapShotSelected(e){Te._canvases.includes(e)?Te.__snapShotCanvasComponent(e):Te._svgs.includes(e)&&Te.__snapShotSvgComponent(e)},clearAll(){Te._svgs=[],Te._canvasses=[]},__snapShotCanvasComponent(e){let t=e.getNumberofCanvases();for(let n=0;n<t;n++){let t=e.getCanvasNameAtIndex(n),i=e.getCanvasAtIndex(n);ReScatter.utils.SnapshotSaver.saveRawCanvasToPng(i,t)}},__snapShotSvgComponent(e){let t=e.getNumberofSVGFragments();for(let n=0;n<t;n++){let t=e.getSVGNameAtIndex(n),i=e.getSVGTextAtIndex(n),r=e.getCSSTextAtIndex(n);ReScatter.utils.SnapshotSaver.saveSvgFragmentToPng(i,r,t)}}};var Pe=Te;let Oe=new _e;class ke extends Ie{constructor(e,t,n){super(2),this.index_to_brain_regions=[],this.svgId=e,this.annotateId=t,this.id=n.id,this.selectionIn=n.selectionIn,this.dynamicSelectionIn=n.dynamicSelectionIn,this.dynamicSelectionOut=n.dynamicSelectionOut,this.regionsIndexPath=n.region_ids,this.propsPath=n.props,this.preselect=n.preselect,this.popupAttributeList=n.popupAttributeList||[],this.lastColorSet=void 0,this.loadedSvgs={},this.cachedSvgs={},this.lastVisibleSelectionContext=void 0,this.selectedIds=[],this.regionsOrdered=[],this.regionMaps={},this.view=void 0}initialize(e){let t=this;this.view=e;let n=[{path:this.regionsIndexPath,type:"json"},{path:this.propsPath,type:"json"}];ReScatter.dataModel.dataCache.loadFiles(n,function(){let e=ReScatter.dataModel.dataCache.getFromCache(t.regionsIndexPath),n=ReScatter.dataModel.dataCache.getFromCache(t.propsPath);t.locatorRoot=document.body.querySelector("#"+t.svgId),t.locatorRoot.oncontextmenu=t.onContextEvent.bind(t),t.annotateRoot=$("#"+t.annotateId),t.__loadRegionMap(e),t.props={},t.__flattenOntology(n,t.props),t.view.loadPleth(),ReScatter.thematicMapController.loadImages(t.preselect),Oe.addTooltip(t.svgId,"IMEChoropleth","left"),t.dispatchLoadedEvent(t)})}destroy(){ReScatter.selectionModel&&ReScatter.selectionModel.removeObserver(this),self.locatorRoot&&(self.locatorRoot.innerHTML="")}__addMouseEventsToSvg(){let e=this.mouseoverSvgRegion.bind(this),t=this.mouseoutSvgRegion.bind(this),n=this.clickSvgRegion.bind(this);Object.keys(this.props).map(function(i){let r=this.locatorRoot.querySelectorAll('path[structure_id="'+i+'"]');for(let i=0;i<r.length;++i){let o=r[i];o.onclick=n,o.onmouseover=e,o.onmouseout=t}},this)}__loadRegionMap(e){this.regionsOrdered=[],this.regionMaps={},e.ordered_region_map.forEach(function(e){this.regionsOrdered.push(e[0]),this.regionMaps[e[0]]=e[1]},this)}mouseoverSvgRegion(e){let t=e.currentTarget.attributes.structure_id,n=this.props[t.value],i=Object.keys(n),r="<table>",o=this.popupAttributeList;i.map(function(e){o.indexOf(e)>=0&&(r+="<tr><td>"+e+"&nbsp;</td><td style='word-wrap:break-word'>"+n[e]+"&nbsp;</td></tr>")}),r+="</table>",this.inSvgRegion=!0,this.annotateRoot.html(r),this.annotateRoot.css({display:"inline",top:e.clientY-50,left:e.clientX-400,position:"fixed","z-index":"999",color:"#fff","background-color":"#000",opacity:"0.6","text-align":"left","table-layout":" fixed",width:"350"})}mouseoutSvgRegion(){let e=this;this.inSvgRegion=!1,setTimeout(function(){e.inSvgRegion||e.annotateRoot.css("display","none")},100)}clickSvgRegion(e){let t=e.currentTarget.attributes.structure_id;this.__peformRegionSelection(t.value,e.ctrlKey)}onContextEvent(e){e.preventDefault(),console.log("Saving SVGs as thematicmap_N.png"),Pe.snapShotSelected(this.view),e.stopPropagation()}__peformRegionSelection(e,t){t||(this.selectedIds=[],this.view.clearPlethColors()),this.selectedIds.push(e);let n=this.__mapSelectedRegionIds();n.length>0&&ReScatter.dynamicSelectionModel.putTransitiveSelection("ThematicMap",n,7807522,this.dynamicSelectionOut)}__mapSelectedRegionIds(){let e=[];return this.selectedIds.forEach(function(t){this.regionMaps.hasOwnProperty(t)&&Array.prototype.push.apply(e,this.regionMaps[t])},this),e.reduce(function(e,t){return-1===e.indexOf(t)&&e.push(t),e},[])}__flattenOntology(e,t){let n=e.msg[0];this.__flattenOntChildren(n,t)}__flattenOntChildren(e,t){let n=Object.keys(e),i={};void 0!==e.id&&(n.map(function(t){"children"!==t&&(i[t]=e[t])}),t[i.id]=i),void 0!==e.children&&e.children.map(function(e){this.__flattenOntChildren(e,t)},this)}__mapProperty(e,t,n,i,r,o){let a=n.propMap[e].mapOp,s=n.propMap[e].mapFn,l=this;return new Promise(function(c,u){if(void 0===a)o[e]=void 0===s?t:s(t,l.props,i,l.regionsOrdered,l.regionMaps,r),c(o);else{ReScatter.data.DataMapper.getDataMap(n.dataMap).mapData(t,a).then(function(t){o[e]=s(t,l.props,i,l.regionsOrdered,l.regionMaps,r),c(o)}).catch(function(e){console.log("Error in choropleth datamapping "+e),c(o)})}})}onPlethResize(){this.view.onPlethResize()}dispatchLoadedEvent(e){ReScatter.controlEventModel.putControlEventModel("rendererLoadComplete",{renderer:e,rendererId:e.id,type:"choropleth"})}addSvg(e,t,n){if(this.isCached(t))return this.loadedSvgs[t]=this.cachedSvgs[t],this.refreshLocator(),this.view.savePlethColors(),void this.reloadLastVisibleSelection();let i=n.replace("<svgid>",e),r=new XMLHttpRequest;r.open("GET",i,!0),r.responseType="text";let o=this;this.fetchSvg(i,t,function(){o.refreshLocator(),o.view.savePlethColors(),o.reloadLastVisibleSelection()})}addSvgs(e,t){if(0===e.length)return this.view.clearPlethColors(),this.refreshLocator(),this.view.savePlethColors(),void this.reloadLastVisibleSelection();let n=e.splice(0,1),i=t.replace("<svgid>",n[0].id),r=this.addSvgs.bind(this,e,t);this.fetchSvg(i,n[0].index,r)}fetchSvg(e,t,n){let i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="text";let r=this;i.onload=function(){let e=this.response.replace(/width=\"(\d*)\" height=\"(\d*)\"/,'xmlns:iedata="http://www.brainscope.nl/brainscope" width="100%" viewbox="0 0 $1 $2"');r.loadedSvgs[t]=e,r.cachedSvgs[t]=e,n()},i.onerror=function(t){alert("Error Loading SVG From source URL: "+e+" "+t.target.status),n()},this.displayLoading(),i.send()}removeSvg(e){delete this.loadedSvgs[e],this.refreshLocator(),this.reloadLastVisibleSelection()}isCached(e){return void 0!==this.cachedSvgs[e]}displayLoading(){this.locatorRoot.innerHTML="<h4>Loading vector images</h4>"}refreshLocator(){this.locatorRoot.innerHTML="";let e=document.createDocumentFragment(),t=Object.keys(this.loadedSvgs);t.sort(function(e,t){let n=parseInt(e),i=parseInt(t);return n===i?0:n>i?1:-1}),t.forEach(function(t){let n=document.createElement("div");n.innerHTML=this.loadedSvgs[t],e.appendChild(n)},this),this.locatorRoot.appendChild(e),this.__addMouseEventsToSvg()}reloadLastVisibleSelection(){this.lastVisibleSelectionContext&&this.processSelectionEvent(this.lastVisibleSelectionContext)}}Ce.impl(ke,[],{processSelectionEvent(e){let t;if(void 0!==(t="dyna"===e.type?this.dynamicSelectionIn[e.id]:this.selectionIn[e.id])){if("show"===e.op||"create"===e.op&&"dyna"===e.type){this.lastVisibleSelectionContext=e;let n=Promise.resolve({color:void 0}),i=this,r=e.sel.dataPoints,o=e.sel.color,a=e.sel.sourceProps;n.then(function(e){return i.__mapProperty("color",r,t,o,a,e)}).then(function(t){i.view.clearPlethColors(),i.view.setPlethColorsFromMap(t.color),"dyna"!==e.type&&(i.lastColorSet=$.extend(!0,{},t.color)),i.processingDone()}).catch(function(e){console.log("Error adding selection:"+e),i.processingDone()})}else"delete"===e.op&&"dyna"===e.type?(this.lastVisibleSelectionContext=void 0,this.view.clearPlethColors(),void 0!==this.lastColorSet?this.view.setPlethColorsFromMap(this.lastColorSet):this.view.restorePlethColors()):"hide"===e.op?(this.lastVisibleSelectionContext=void 0,this.lastColorSet=void 0,this.view.clearPlethColors(),this.view.restorePlethColors()):"delete"===e.op&&"dyna"!==e.type&&(this.lastColorSet=void 0);this.processingDone()}else this.processingDone()}}),Ae.impl(ke,[],{onControlEvent(e){}});var Me=ke;class Le{static get LoaderType(){return{SIMPLE_LOADER:0,IMAGE_STRIP_LOADER:1}}constructor(e,t,n,i){switch(this.containerId=t,this.annotationId=n,this.imageStripId=i,this.loaderType=null,e.type){case Le.LoaderType.SIMPLE_LOADER:this.loader=new Se(e.svgTemplate,e.svgList),this.loaderType=Le.LoaderTypes.SIMPLE_LOADER;break;case Le.LoaderType.IMAGE_STRIP_LOADER:this.loader=new xe(this.imageStripId,e.svgTemplate,e.thumbnailTemplate,e.svgList),this.loaderType=Le.LoaderTypes.IMAGE_STRIP_LOADER;break;default:this.loader=void 0,this.loaderType=Le.LoaderTypes.NO_LOADER}return this.plethDescrip=e,this}static get LoaderTypes(){return{SIMPLE_LOADER:0,IMAGE_STRIP_LOADER:1,NO_LOADER:9999}}initialize(){ReScatter.choroplethControl=new Me(this.containerId,this.annotationId,this.plethDescrip),this.plethDescrip.plugin?ReScatter.choroplethView=ReScatter.config.PluginFactory.createChoroplethType(this.plethDescrip.plugin,this.containerId):ReScatter.choroplethView=new J(this.containerId),Pe.addComponent(ReScatter.choroplethView),ReScatter.choroplethControl.initialize(ReScatter.choroplethView)}destroy(){ReScatter.choroplethControl&&(ReScatter.choroplethControl.destroy(),ReScatter.choroplethControl=void 0),this.plethDescrip=void 0,this.loader=void 0}loadImages(e){this.loader&&this.loader.loadImages(e)}getMapContainerId(){return this.containerId}}let Be=new _e,De=null;class Ne{static get LayoutFlags(){return{CHOROPLETH:1,MASTERGRID:2}}static get LayoutTarget(){return{SPACER:0,MASTER:1,GRID:2}}constructor(){return De||(De=this,this.__init(),this.clear(),De)}__init(){}clear(){this.idSuffix="",this.layoutDef={},this.gridPlots=[],this.masterPlots=[],this.idPrefix="",this.totalPlotItems=0,this.numSpacers=0,ReScatter.thematicMapController&&(ReScatter.thematicMapController.destroy(),ReScatter.thematicMapController=void 0),this.ontologyTree&&(this.ontologyTree.destroy(),this.ontologyTree=void 0),this.layoutDef={},this.chartNode=document.getElementById(ReScatter.CONTROL_ID.CHARTS),this.chartNode.innerHTML=""}setLayout(e,t){this.clear(),this.controlsEnabled=t,this.layoutDef=e,e.plots.forEach(function(e){switch(e.layoutTarget){case Ne.LayoutTarget.MASTER:this.masterPlots.push(e);break;case Ne.LayoutTarget.GRID:this.gridPlots.push(e);break;default:this.gridPlots.push(e),this.numSpacers+=1}},this),this.totalPlotItems=this.gridPlots.length+this.masterPlots.length;let n=0;void 0!==e.choropleths&&(n|=Ne.LayoutFlags.CHOROPLETH),this.masterPlots.length>0&&(n|=Ne.LayoutFlags.MASTERGRID);let i=this.gridPlots.length;if(n&Ne.LayoutFlags.MASTERGRID?(this.chartNode.innerHTML=ReScatter.masterGridLayout,this.idPrefix="mg-subPlot-",this.idSuffix="-8"):(1===i?(this.idSuffix="-1",this.chartNode.innerHTML=ReScatter.singlePlotLayout):i>=2&&(this.chartNode.innerHTML=ReScatter.gridPlotLayout,this.idSuffix="-8"),this.idPrefix="subPlot-"),this.choroplethEnabled=this.controlsEnabled.includes("ReScatter.CONTROL_ID.CHOROPLETH"),this.choroplethEnabled){let t=document.getElementById(ReScatter.CONTROL_ID.IMAGESTRIPFOOTER);if(n&Ne.LayoutFlags.CHOROPLETH){document.getElementById(ReScatter.CONTROL_ID.CHOROPLETH).style.display="inline-block",t&&(t.classList.add("visible_strip_footer"),t.classList.remove("hidden_strip_footer"));let n=e.choropleths[0];ReScatter.thematicMapController=new Le(n,ReScatter.CONTROL_ID.CHOROPLETH,ReScatter.CONTROL_ID.ANNOTATECHOROPLETH,ReScatter.CONTROL_ID.IMAGESTRIPFOOTER),ReScatter.thematicMapController.initialize()}else document.getElementById(ReScatter.CONTROL_ID.CHOROPLETH).style.display="none",t&&(t.classList.add("hidden_strip_footer"),t.classList.remove("visible_strip_footer"),t.innerHTML="")}return Be.addTooltip(ReScatter.CONTROL_ID.CHARTS,"IMEScatterPlot","left","body"),this.idSuffix}getLayoutElementId(e){let t=this.gridPlots.indexOf(e);return-1!==t?this.idPrefix+(t+1)+this.idSuffix:"mg-master"}isSpaceLayout(e){return e.layoutTarget===Ne.LayoutTarget.SPACER}getTotalPlots(){return this.totalPlotItems-this.numSpacers}clearTitles(){let e=document.getElementsByClassName("plot_title");for(let t=0,n=e.length;t<n;t++)e.item(t).innerHTML=""}getCanvasPlotIds(){let e=[];return this.layoutDef.plots.forEach(function(t){let n=this.getLayoutElementId(t);this.isSpaceLayout(t)||e.push([n,t.id])},this),e}getCanvasSvgId(){return void 0!==ReScatter.thematicMapController?ReScatter.thematicMapController.getMapContainerId():null}getNumberOfChoroplethsToLoad(){return void 0!==this.layoutDef.choropleths?1:0}getOntology(){if(this.layoutDef.ontologies)return this.layoutDef.ontologies[0]}getPredefinedSelections(){return this.layoutDef.predefinedSelections}getPlots(){return this.layoutDef.plots}getRecalculation(){return this.layoutDef.recalculation}getChoropleths(){return this.layoutDef.choropleths?this.layoutDef.choropleths:[]}getDataMaps(){return this.layoutDef.dataMaps}getBaseDataMaps(){if(this.layoutDef.recalculation)return this.layoutDef.recalculation.baseDataMaps}getId(){return this.layoutDef.id}}class Ue{constructor(){return this.controlLayout=webix.ui({container:ReScatter.CONTROL_ID.WIDGETS,id:"controlLayout",type:"clean",rows:[{gravity:1,type:"clean",animate:!1,rows:[{view:"tabbar",id:"toolTabs",multiview:!0,animate:!1,minHeight:35,align:"center",options:[]},{view:"multiview",id:"multiViewCellsId",animate:!1,type:"clean",cells:[{view:"template",id:"tpl",template:"ToolTabsPlaceholder"}]}]},{view:"resizer"},{gravity:3,multi:!0,id:"selectionAccordion",view:"accordion",type:"clean",rows:[{collapsed:!0,id:"selectionEditingId",body:{rows:[]}}]}]}),webix.event(window,"resize",function(){$$("controlLayout").adjust()}),this.layoutWidgetTabs=[],this}addTabOption(e,t,n){$$("toolTabs").addOption(e,t,n),$$("toolTabs").refresh(),$$("multiViewCellsId").adjust()}removeTabOption(e){$$("toolTabs").removeOption(e),$$("toolTabs").refresh(),$$("multiViewCellsId").adjust()}resize(){$$("controlLayout").adjust()}addTabView(e,t,n){let i=$$("multiViewCellsId").addView(e);return this.addTabOption(i,t,n),i}addLayoutTabView(e,t,n){let i={rows:[{id:e+"_in_tab",template:"html->"+e}]},r=this.addTabView(i,t,n);return this.layoutWidgetTabs.push(r),r}removeTabView(e){$$("multiViewCellsId").removeView(e),this.removeTabOption(e)}removeLayoutTabs(){var e=!0,t=!1,n=void 0;try{for(var i,r=this.layoutWidgetTabs[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){let e=i.value;this.removeTabView(e)}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}this.layoutWidgetTabs=[]}collapseSelectionEdit(){$$("selectionEditingId").collapse()}expandSelectionEdit(){$$("selectionEditingId").expand()}switchTabViewTo(e){$$("toolTabs").setValue(e),$$("multiViewCellsId").setValue(e)}addAccordionView(e){return $$("selectionAccordion").addView(e)}getMultiViewParent(){return $$("multiViewCellsId").getParentView()}}const Ve=n(151);let je=null;class Fe{static get PluginTypeEnum(){return{EXTERNAL_WEBSITE_ANALYSIS:0,PROCESS_GENERATE_DATA:1}}constructor(){if(je)return je;return this.analysisPluginMap=new Map,this.recalculatePluginMap=new Map,this.jobMonitorDiv=$("#"+ReScatter.CONTROL_ID.JOBMONITOR),this.jobMonitorControl=new U(ReScatter.CONTROL_ID.JOBMONITOR),this.selectionEditMenu=webix.ui({id:"editSubMenuId",view:"submenu",data:["Edit","Union","Intersect","Subtract","Cancel"],on:{onItemClick:function(e){let t=this.getTopMenu().getContext(),n=this.getItem(e),i=t.obj,r=t.id,o=i.getItem(r);ze.modeEnum;switch(n.value){case"Edit":ReScatter.selectionDataWidget.startEditOp(ze.modeEnum.EDIT,o.label,o.id);break;case"Union":ReScatter.selectionDataWidget.startEditOp(ze.modeEnum.UNION,o.label,o.id);break;case"Intersect":ReScatter.selectionDataWidget.startEditOp(ze.modeEnum.INTERSECT,o.label,o.id);break;case"Subtract":ReScatter.selectionDataWidget.startEditOp(ze.modeEnum.SUBTRACT,o.label,o.id);break;case"Cancel":ReScatter.selectionDataWidget.startEditOp(ze.modeEnum.NONE,o.label,o.id)}}}}),this.selectionAnalysisMenu=webix.ui({id:"analysisSubMenuId",view:"submenu",autowidth:!0,data:[],on:{onItemClick:function(e){let t=this.getTopMenu().getContext(),n=this.getItem(e),i=t.obj,r=t.id,o=i.getItem(r);je.callPlugins(n.value,o.selectionId,o.label)}}}),this.replotItemFixed=[{value:"Show jobs"}],this.selectionReplotMenu=webix.ui({id:"replotSubMenuId",view:"submenu",data:this.replotItemFixed,autowidth:!0,on:{onItemClick:function(e){let t=this.getTopMenu().getContext(),n=this.getItem(e),i=t.obj,r=t.id,o=i.getItem(r);switch(n.value){case"Show jobs":je.jobMonitorControl.showControl();break;default:je.callPlugins(n.value,o.selectionId,o.label)}}}}),this.menuItemFixed=[{value:"Edit...",submenu:this.selectionEditMenu},{value:"Analysis...",submenu:this.selectionAnalysisMenu},{value:"Replot...",submenu:this.selectionReplotMenu},{value:"Delete"},{value:"Export CSV"}],this.selectionContextMenu=webix.ui({id:"selectionContextId",view:"contextmenu",width:200,data:this.menuItemFixed,on:{onItemClick:function(e,t){let n=this.getContext(),i=n.obj,r=n.id,o=this.getItem(e).value,a=i.getItem(r);switch(o){case"Delete":ReScatter.selectionModel.deleteSelection(a.label),ReScatter.selectionEditWidget.editExistingSelection(void 0);break;case"Export CSV":je.selectionToClipboard(t,a.selectionId,a.label)}}}}),je=this}static saveToFile(e,t){ReScatter.utils.SnapshotSaver.saveTextToFile(e,t)}static closeSelectionCSV(e){let t=$(e);t.css({display:"none"}),t.html(""),Fe.clipboard.destroy()}refreshAnalysisMenu(){let e=[];this.analysisPluginMap.forEach((t,n,i)=>{e.push({value:n})}),this.selectionAnalysisMenu.data.clearAll(),e.forEach((e,t,n)=>{this.selectionAnalysisMenu.data.add(e)}),this.selectionAnalysisMenu.refresh(),this.selectionAnalysisMenu.resize()}refreshReplotMenu(){let e=[];this.recalculatePluginMap.forEach((t,n,i)=>{e.push({value:n})}),this.selectionReplotMenu.data.clearAll(),this.replotItemFixed.concat(e).forEach((e,t,n)=>{this.selectionReplotMenu.data.add(e)}),this.selectionReplotMenu.refresh(),this.selectionReplotMenu.resize()}registerExternalAnalysisPlugin(e,t,n){this.analysisPluginMap.set(e,{type:Fe.PluginTypeEnum.EXTERNAL_WEBSITE_ANALYSIS,symbol:t,callback:n}),this.refreshAnalysisMenu()}registerGenerateDataPlugin(e){this.recalculatePluginMap.set(e,{type:Fe.PluginTypeEnum.PROCESS_GENERATE_DATA}),this.refreshReplotMenu()}callPlugins(e,t,n){if(this.analysisPluginMap.has(e)){let i=this.analysisPluginMap.get(e).callback,r=ReScatter.selectionModel.getSelection(n),o=[],a=this.analysisPluginMap.get(e).symbol;r.dataPoints.forEach(function(e,n,i){o.push(ReScatter.dataModel.getSelectionPropAtIndex(t,e,a))}),i(o,n)}else if(this.recalculatePluginMap.has(e)){let t=ReScatter.selectionModel.getSelection(n);this.launchRecalculateDataPlugin(e,t)}}enablePlugins(e){}getMenuUi(){return this.selectionContextMenu}getEditMenuUi(){return this.selectionEditMenu}selectionToClipboard(e,t,n){let i=ReScatter.selectionModel.getSelection(n).dataPoints,r=Object.keys(ReScatter.dataModel.getAllSelectionPropsAtIndex(t,0)),o="__label__, "+r.join(",")+"\r\n";o+=i.map(function(e){let i=ReScatter.dataModel.getAllSelectionPropsAtIndex(t,e);return'"'+n+'",'+r.map(function(e){return'"'+(i[e]||"")+'"'}).join(",")}).join("\r\n");let a="#"+ReScatter.CONTROL_ID.SELECTIONINFO,s=$(a),l='<textarea id="selectionDataAsCSV", cols="80" rows="20" readonly>'+o+"</textarea>",c=this;l+='<br/><button id="clipToKeyboardButton" class="btn" data-clipboard-action="copy" data-clipboard-target="#selectionDataAsCSV">Copy to clipboard</button>',l+='<br/><button id="saveToFileButton" class="btn" onclick="ReScatter.widget.SelectionContextMenu.saveToFile(\'#selectionDataAsCSV\',\''+n+"')\">Save to file</button>",l+='<br/><button id="cancelClipButton" class="btn" onclick="ReScatter.widget.SelectionContextMenu.closeSelectionCSV(\''+a+"')\">Close</button>",s.html(l),s.css({display:"inline",top:"50%",left:"50%",transform:"translate(-50%, -50%)",position:"fixed","z-index":"999","text-align":"left"}),Fe.clipboard=new Ve("#clipToKeyboardButton"),Fe.clipboard.on("success",function(){setTimeout(c.closeSelectionCSV(a),1)})}launchRecalculateDataPlugin(e,t){let n=new C(e);this.jobMonitorControl.subscribeToJobMonitor(n.monitor),n.run(t)}}class ze{constructor(){this.tableWebixId="selectionsDataTableId",this.editMode=ze.modeEnum.NONE,this.editLabels=[];let e=this;this.selectionTableDef={view:"accordionitem",header:"Loaded selections",headerHeight:35,headerAltHeight:35,collapsed:!0,body:{view:"layout",rows:[{view:"datatable",id:this.tableWebixId,multiselect:!1,editable:!0,select:"row",columns:[{id:"label",header:"Selection",gravity:1,minWidth:80,sort:"string"},{id:"selectionId",header:"Group",gravity:1,minWidth:80,sort:"string"},{id:"description",header:"Description",gravity:2,minWidth:160,sort:"string"},{id:"color",header:"Color picker",editor:"color",template:"<span style='background:#color#; border-radius:4px; text-shadow: 1px 0px 1px #000,0px 1px 1px #000; font-family: monospace'>#color#</span>"}],fixedRowHeight:!1,rowHeight:25,rowLineHeight:25,autoConfig:!0,resizeColumn:!0,checkboxRefresh:!0,scrollX:!1,onContext:{},on:{onAfterEditStop:function(t,n,i){if(t.value!==t.old){let t=this.getItem(n.row);e.selectionRowChanged(t,n.column),console.log("Changed selection: "+t)}},onSelectChange:function(){let t=this.getSelectedItem(!0);if(1===t.length){e.editLabels.push(t[0].label);let n=e.editMode;switch(e.setMode(ze.modeEnum.NONE),n){case ze.modeEnum.NONE:t&&1!==t[0].show&&(ReScatter.selectionEditWidget.editExistingSelection(void 0),ReScatter.selectionModel.showSelection(t[0].label));break;case ze.modeEnum.UNION:ReScatter.selectionModel.unionSelections(e.editLabels,"User union");break;case ze.modeEnum.INTERSECT:ReScatter.selectionModel.intersectSelections(e.editLabels,"User intersect");break;case ze.modeEnum.SUBTRACT:ReScatter.selectionModel.subtractSelections(e.editLabels,"User subtract")}e.editLabels=[]}else 0===t.length&&ReScatter.selectionModel.hideVisibleSelection()}}},{view:"layout",id:"selectionButtonsLayout",rows:[{template:"Clear/delete",type:"section"},{margin:5,cols:[{view:"button",id:"hideVisibleSelection",value:"Deselect",click:function(e,t){$$("selectionsDataTableId").clearSelection()}},{view:"button",id:"deleteLastSelectionButton",value:"Delete last",click:function(e,t){ReScatter.selectionModel.deleteLastSelection()}},{view:"button",id:"deleteAllSelectionsButton",value:"Delete all",click:function(e,t){ReScatter.selectionModel.deleteAllSelections()}}]}]}]}},this.accordionId=ReScatter.controlWidgetLayout.addAccordionView(this.selectionTableDef),this.selectionTable=$$(this.tableWebixId),this.selectionContextMenu=new Fe,this.selectionContextMenu.getMenuUi().attachTo(this.selectionTable)}static get modeEnum(){return{NONE:0,EDIT:1,UNION:2,INTERSECT:3,SUBTRACT:4}}selectionRowChanged(e,t){switch(t){case"color":ReScatter.selectionModel.setColor(e.label,ue(e.color));break;default:console.log("Column: "+t+" not handled when selection edited")}}startEditOp(e,t,n){if(this.editMode=ze.modeEnum.NONE,ReScatter.selectionModel.showSelection(t),this.setMode(e),e===ze.modeEnum.EDIT)return this.editLabels=[],void ReScatter.selectionEditWidget.editExistingSelection(t);e!==ze.modeEnum.NONE&&(this.editLabels=[t])}setMode(e){this.editMode=e;let t=this.selectionTable.getNode().querySelector("div.webix_ss_body");switch(e){case ze.modeEnum.UNION:t.style.cursor="url("+ReScatter.cursors("./union.png")+"), auto";break;case ze.modeEnum.INTERSECT:t.style.cursor="url("+ReScatter.cursors("./intersect.png")+"), auto";break;case ze.modeEnum.SUBTRACT:t.style.cursor="url("+ReScatter.cursors("./subtract.png")+"), auto";break;default:t.style.cursor="default"}}update(e){let t=this;switch(e.op){case"create":(new PIXI.Graphics).beginFill(e.sel.color),this.selectionTable.add({label:e.sel.label,selectionId:e.sel.selectionId,description:e.sel.description,color:oe(e.sel.color)}),ReScatter.selectionEditWidget.editExistingSelection(void 0);break;case"delete":let n=this.selectionTable.find(function(t){return t.label===e.sel.label});for(let e=0,t=n.length;e<t;e++)this.selectionTable.remove(n[e].id);break;case"show":this.selectionTable.find(function(n){e.sel.label===n.label?(n.active=1,t.selectionTable.select(n.id)):n.active=0,t.selectionTable.updateItem(n.id,n)});break;case"hide":this.selectionTable.find(function(n){e.sel.label===n.label&&0!==n.active&&(n.active=0,t.selectionTable.unselect(n.id)),t.selectionTable.updateItem(n.id,n)});break;default:console.log("Unrecognized selection operation in SelectionDataWidget, op: "+e.op)}this.selectionTable.adjustRowHeight("description")}expand(){$$(this.accordionId).expand()}}class Ge{constructor(){this.tableWebixId="existingSelectionEditFormId",self=this,this.selectionTableDef={view:"accordionitem",header:"Edit selections",headerHeight:35,headerAltHeight:35,collapsed:!0,body:{id:this.tableWebixId,view:"form",hidden:!1,type:"clean",complexData:!0,elements:[{template:"Edit existing selection",type:"section"},{view:"select",id:"editModeId",label:"Edit mode",inputWidth:250,labelWidth:100,value:ReScatter.data.PermanentSelection.editModeEnum.enum.ADDPOINTS,yCount:"2",readonly:!0,options:ReScatter.utils.enumToOptions(ReScatter.data.PermanentSelection.editModeEnum)},{view:"text",name:"label",label:"Name",inputWidth:400,labelWidth:100,readonly:!0},{view:"text",name:"selectionId",label:"Group",inputWidth:400,labelWidth:100,readonly:!0},{view:"text",name:"description",label:"Description",inputWidth:400,labelWidth:100},{view:"text",name:"numPoints",label:"Num points",inputWidth:400,labelWidth:100,readonly:!0},{margin:5,cols:[{view:"button",id:"saveButton",value:"Save",click:function(e,t){ReScatter.selectionModel.saveEditingSelection(),self.editExistingSelection(void 0)}},{view:"button",id:"cancelButton",value:"Cancel",click:function(e,t){ReScatter.selectionModel.cancelEditingSelection(),self.editExistingSelection(void 0)}}]}]}},this.accordionView=ReScatter.controlWidgetLayout.addAccordionView(this.selectionTableDef),this.editForm=$$(this.tableWebixId),$$("editModeId").attachEvent("onChange",function(e,t){ReScatter.controlEventModel.putControlEventModel("editOp",{editOp:e}),ReScatter.selectionModel.setPutOperation(e)}),this.editForm.attachEvent("onValues",function(){let e=$$("editModeId").getValue();ReScatter.controlEventModel.putControlEventModel("editOp",{editOp:e}),ReScatter.selectionModel.setPutOperation(e)}),this.editForm.hide()}editExistingSelection(e){if(void 0!==e){let t=ReScatter.selectionModel.getSelection(e);ReScatter.selectionModel.setEditingSelection(e);let n=jQuery.extend(!0,{},t);n.numPoints=n.dataPoints.length,this.editForm.setValues(n),ReScatter.controlEventModel.putControlEventModel("editMode",{editMode:"EXISTING",editTarget:e,selectionId:n.selectionId}),this.editForm.show(),$$(this.accordionView).expand()}else this.editForm.hide(),$$(this.accordionView).collapse(),ReScatter.selectionModel.cancelEditingSelection(),ReScatter.controlEventModel.putControlEventModel("editMode",{editMode:"NEW"})}}class Qe{constructor(e){this.tableWebixId="loadSelectionsLayoutId";let t=this;this.uploadFormDef={view:"accordionitem",header:"Upload selections",headerHeight:35,headerAltHeight:35,collapsed:!0,body:{view:"layout",id:"loadSelectionsLayoutId",rows:[{template:"Load selection from CSV file, or enter ids manually",type:"section"},{margin:5,cols:[{view:"select",id:"uploadTargetId",label:"Type",inputWidth:200,labelWidth:70,readonly:!0,options:[]},{view:"select",id:"selectPropId",label:"Property",inputWidth:200,labelWidth:70,readonly:!0,options:[]}]},{type:"space",cols:[{view:"htmlform",minHeight:20,template:"<form><input type='file' id='selectionFileInput' onchange='self.loadSelectionFile(this.files, $$(\"uploadTargetId\").getValue())'></form>"},{view:"form",type:"clean",elements:[{view:"textarea",id:"manualTextAreaId",name:"manualSelText",height:100,placeholder:"Enter comma, semicolon, or LF separated ids here"},{view:"button",id:"enterManualSelection",value:"Select",click:function(e,n){let i=$$("manualTextAreaId").getValue().split(/\s*[,;\n]\s*/i);i.length>0&&t.loadValues(i,$$("uploadTargetId").getValue())}}]}]}]}},ReScatter.controlWidgetLayout.addAccordionView(this.uploadFormDef),this.uploadForm=$$(this.tableWebixId),$$("uploadTargetId").attachEvent("onChange",function(e,t){if("1"===e)return;let n=ReScatter.dataModel.getSelectionPropKeys(e);n.sort();let i=[];n.forEach(function(e,t,n){let r={id:e,value:e};i.push(r)}),$$("selectPropId").define("options",i),$$("selectPropId").setValue(ReScatter.dataModel.getSelectionPrimaryProp(e)),$$("selectPropId").refresh()})}updateOptionsFromSelections(e){$$("uploadTargetId").define("options",e),$$("uploadTargetId").refresh(),$$("uploadTargetId").setValue(e[0].id)}loadSelection(e,t,n,i){if(0===e.length)return void alert("No selection created - check the property selection and property names");let r=ReScatter.selectionModel.getNewLabel(i);ReScatter.selectionModel.putSelection(r,t,e,7479842,n,i)}selectionFileLoaded(e,t,n){let i=n.target.result,r=-1!==i.search("\r\n"),o=!r&&-1!==i.search("\n"),a=!r&&!o&&-1!==i.search(";");if(!(-1!==i.search(",")))if(r){let e=new RegExp("\r\n","g");i=i.replace(e,",")}else if(o){let e=new RegExp("\n","g");i=i.replace(e,",")}else if(a){let e=new RegExp(";","g");i=i.replace(e,",")}let s=[];i.split(",").forEach(function(e,t,n){s.push(e.trim())});let l=[],c=$$("selectPropId").getValue();s.forEach(function(t,n,i){l=l.concat(ReScatter.dataModel.getSelectionIndexes(e,c,t,!1))}),this.loadSelection(l,"From file","Loaded from "+t,e)}loadSelectionFile(e,t){let n=e[0],i=new FileReader;i.onload=this.selectionFileLoaded.bind(this,t,n.name),i.readAsText(n)}loadValues(e,t){let n=$$("selectPropId").getValue(),i=[];e.forEach(function(e,r,o){i=i.concat(ReScatter.dataModel.getSelectionIndexes(t,n,e,!0))}),this.loadSelection(i,"Manual","Manual selection: "+i.length+" points",t)}}const Ye=n(8),We=n(2),He=n(4),Ke={mapDict:{}};class qe{constructor(e){this.filePath=e,this.array=void 0,this.status=qe.status.NULL}static get maps(){return Ke}static setDataMaps(e){qe.maps.mapDict={},e?e.forEach(function(e){qe.maps.mapDict[e.id]=new qe(e.filePath)}):ReScatter.utils.warn("No data maps defined")}static get mapOp(){return{SUMROW:0,AVGROW:1,SUMCOL:2,AVGCOL:3,ALLROW:4,ALLCOL:5,PASSROW:6,PASSCOL:7,PASSALLROW:8,PASSALLCOL:9}}static get propAssign(){return{POINT:0}}static get groupdef(){return{ALL:0}}static get status(){return{NULL:0,BUSY:1,AVAIL:2,FAIL:3}}setData(e){this.filePath=e,this.array=void 0,this.status=qe.status.NULL}mapData(e,t){let n=this;switch(this.status){case qe.status.NULL:this.status=qe.status.BUSY;let i=[{path:this.filePath,type:"arraybuffer"}];return new Promise(function(r,o){ReScatter.dataModel.dataCache.loadFiles(i,function(){let i=ReScatter.dataModel.dataCache.getFromCache(n.filePath),o=Ye.parse(i);n.array=We(o.data,o.sizes.slice().reverse()),n.__resolveMapping(r,n,e,t)},function(e){n.status=qe.status.FAIL,console.log("Error retrieving: "+n.filePath),o(e)})});case qe.status.BUSY:let r=function(e,t){setTimeout(function(){e()},200)};return new Promise(function(i){setTimeout(function(){!function o(){if(n.status!==qe.status.AVAIL)return new Promise(r).then(o).catch(function(e){console.log("Error in DataMapper delay "+e)});n.__resolveMapping(i,n,e,t)}()},1)});case qe.status.AVAIL:return this.status=qe.status.BUSY,new Promise(function(i,r){n.__resolveMapping(i,n,e,t)})}}__resolveMapping(e,t,n,i){let r;try{r=t.__performMapping(n,i)}catch(e){console.log("Error in data mapping: "+e)}finally{t.status=qe.status.AVAIL,e(r)}}__performMapping(e,t){switch(t){case qe.mapOp.AVGROW:return this.averageRows(e);case qe.mapOp.SUMROW:return this.sumRows(e);case qe.mapOp.AVGCOL:return this.averageCols(e);case qe.mapOp.SUMCOL:return this.sumCols(e);case qe.mapOp.ALLROW:let n=this.array.shape[1];return this.getIndexArray(n);case qe.mapOp.ALLCOL:let i=this.array.shape[0];return this.getIndexArray(i);case qe.mapOp.PASSROW:return this.passRow(e);case qe.mapOp.PASSCOL:return this.passCol(e);case qe.mapOp.PASSALLROW:return this.passAllRow(e);case qe.mapOp.PASSALLCOL:return this.passAllCol(e);default:return this.sumRows(e)}}getIndexArray(e){let t=new Array(e);for(let n=0;n<e;n++)t[n]=n;return t}sumRows(e){if(!this.array)return[];let t=We(new Float32Array(this.array.shape[0]),[this.array.shape[0]]);for(let n=0,i=e.length;n<i;n++){let i=this.array.pick(null,e[n]);He.add(t,t,i)}return Array.prototype.slice.call(t.data)}averageRows(e){let t=this.sumRows(e),n=e.length;for(let e=0,i=t.length;e<i;e++)t[e]=t[e]/n;return t}sumCols(e){if(!this.array)return[];let t=We(new Float32Array(this.array.shape[1]),[this.array.shape[1]]);for(let n=0,i=e.length;n<i;n++){let i=this.array.pick(e[n],null);He.add(t,t,i)}return Array.prototype.slice.call(t.data)}averageCols(e){let t=this.sumCols(e),n=e.length;for(let e=0,i=t.length;e<i;e++)t[e]=t[e]/n;return t}passCol(e){if(!this.array)return[];let t=new Array(e.length);for(let n=0,i=e.length;n<i;n++)t[n]=this.array.get(0,e[n]);return t}passRow(e){if(!this.array)return[];let t=new Array(e.length);for(let n=0,i=e.length;n<i;n++)t[n]=this.array.get(e[n],0);return t}passAllCol(e){if(!this.array)return[];let t=new Array(e.length);for(let n=0,i=e.length;n<i;n++){let i=new Array(this.array.shape[0]);for(let t=0;t<this.array.shape[0];t++)i[t]=this.array.get(t,e[n]);t[n]=i}return t}passAllRow(e){if(!this.array)return[];let t=new Array(e.length);for(let n=0,i=e.length;n<i;n++){let i=new Array(this.array.shape[1]);for(let t=0;t<this.array.shape[1];t++)i[t]=this.array.get(e[n],t);t[n]=i}return t}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(qe,"getDataMap",function(e){return qe.maps.mapDict[e]});class Xe{constructor(e,t){this.props=e,this.propKeys=Object.keys(e),this.plotFormat=t}getPlotProp(e,t,n){let i=this.getAllPropsAtPoint(e);switch(typeof this.plotFormat[t]){case"undefined":return i[t]?i[t]:n;case"object":return i[this.plotFormat[t[t]]];case"function":return this.plotFormat[t](i);case"string":return i[this.plotFormat[t]];default:return this.plotFormat[t]}}getColor(e){return this.getPlotProp(e,"color",7109515)}getId(e){return this.getPlotProp(e,"id","")}getSymbol(e){return this.getPlotProp(e,"symbol","")}getShape(e){return this.getPlotProp(e,"shape","circle")}getSize(e){return this.getPlotProp(e,"size",3)}getGroup(e){return this.getPlotProp(e,"group",void 0)}getPrimaryProp(){return this.getPlotProp(0,"primary",void 0)}getBackgroundColor(){return this.getPlotProp(0,"background",0)}getAllPropsAtPoint(e){let t={},n=this;return this.propKeys.forEach(function(i){t[i]=n.props[i][e]}),t}getPointIndexFromProp(e,t,n){let i=!!n,r=[];return this.props[e].forEach(function(e,n,o){i?String(e).toUpperCase()===String(t).toUpperCase()&&r.push(n):e===t&&r.push(n)}),r}}const Je=n(159);class Ze extends Ie{constructor(e,t,n){super(3),this.elementId=e,this.id=t.id,this.selectionOutId=t.selections.selectionOut,this.dynamicSelectionId=t.selections.dynamicSelectionOut,void 0===n?(this.switchableSelections=ReScatter.config.SwitchableSelections.newFromPlotInfo(t),n=this.switchableSelections.configNames):this.switchableSelections=t.selections.switchableSelections,this.currentConfig=n[0],this.selectionIn=this.switchableSelections.getSelectionMapping(this.currentConfig),this.dynamicSelectionIn=this.switchableSelections.getDynamicSelectionMapping(this.currentConfig),this.selectionConfigs=n,document.getElementById(this.elementId+"-title").innerHTML=this.id,this.brushType="Circle",this.mouseOverIndexes=[],this.propertyOverIndexes=[],this.processingDynamicSelecton=!1,$("#"+e).mouseover(function(){$("#"+e).css("cursor","url("+ReScatter.cursors("./drawtarget.png")+") 20 20, auto")}).mouseout(function(){$("#"+e).css("cursor","default")}),this.frameDelay=20,this.plotElement=$("#"+this.elementId)[0],this.plotWindowSize=this.plotElement.clientWidth,this.originalSize=this.plotWindowSize,this.renderer=PIXI.autoDetectRenderer(this.plotWindowSize,this.plotWindowSize,{autoResize:!0,forceFXAA:!0,preserveDrawingBuffer:!0}),this.interactionElement=this.renderer.plugins.interaction.interactionDOMElement,this.plotElement.appendChild(this.renderer.view),window.addEventListener("resize",this.onResize.bind(this));let i=this;this.plotSize=this.plotWindowSize,this.plotRoot=new PIXI.Container,this.plotRoot.interactive=!0,this.basePlotContainer=new PIXI.Container,this.basePlotContainer.interactive=!0,this.basePlotContainer.filters=void 0,this.plotRoot.addChild(this.basePlotContainer),this.contextMenuLinked=!1,this.zoomed=!1,this.resizeZoom=1,this.maxZoomLevel=16,this.zoomLevels=Array.apply(null,{length:i.maxZoomLevel+1}).map(function(e,t){return Math.pow(2,t/4)}),this.currentZoomLevel=0,this.zoomFactor=this.zoomLevels[this.currentZoomLevel],this.selections=[];let r=t.selections.selectionDefaults||{};this.numNeighbours=r.hasOwnProperty("numNeighbours")?r.numNeighbours:49,this.selectOver=r.hasOwnProperty("selectOver")?r.selectOver:Ze.SelectionEnum.MOUSEOVER,this.mouseOverExcludeSeed=!!r.hasOwnProperty("mouseOverExcludeSeed")&&r.mouseOverExcludeSeed,this.mouseOverSeedIndex=-1,this.selectionsRoot=new PIXI.Container,this.selectionsRoot.interactive=!1,this.plotRoot.addChild(this.selectionsRoot),this.dynamicRoot=new PIXI.Container,this.dynamicRoot.interactive=!1,this.dynamicRoot.visible=!1,this.plotRoot.addChild(this.dynamicRoot),this.plotRoot.visible=!1,this.selectionViews={},this.popupContainer=new PIXI.Container,this.popupContainer.interactive=!1,this.plotRoot.addChild(this.popupContainer),this.plotRoot.brushViewTree=new PIXI.Container,this.plotRoot.brushViewTree.interactive=!1,this.plotRoot.mousedown=this.plotRoot.touchstart=this.startDrawing,this.plotRoot.mouseup=this.plotRoot.touchend=this.endDrawing,this.plotRoot.click=this.selectOnClick.bind(this),this.renderer.view.oncontextmenu=this.onContextMenu.bind(this),this.interactionElement.addEventListener("wheel",i.zoomWheel.bind(i),!1),this.interactionElement.addEventListener("mouseover",i.startAnimationFn.bind(i)),this.interactionElement.addEventListener("mouseout",i.stopAnimationFn.bind(i)),this.interactionElement.addEventListener("touchstart",i.startAnimationFn.bind(i)),this.interactionElement.addEventListener("touchmove",i.startAnimationFn.bind(i)),this.interactionElement.addEventListener("touchleave",i.stopAnimationFn.bind(i)),this.plotRoot.mousemove=this.plotRoot.touchmove=null,this.plotRoot.brushMousemove=this.brushMousemove,this.plotRoot.activeBrushView=void 0,this.plotRoot.activeBrushModel=void 0,this.plotRoot.renderer=this,this.plotRoot.captureMouse=!1;let o=this.endDrawing.bind(this.plotRoot);document.body.addEventListener("mouseup",function(e){i.plotRoot.captureMouse&&o(e)}),document.body.addEventListener("touchend",function(e){i.plotRoot.captureMouse&&o(e)}),document.body.addEventListener("touchcancel",function(e){i.plotRoot.captureMouse&&o(e)}),this.plotRoot.addChild(this.plotRoot.brushViewTree),this.annotations=[],this.annotationsColor=[],this.allPointSprites=[],this.dimensions=2,this.then=Date.now(),this.inRender=!1,this.stopAnimation=!0,this.plotRoot.hitArea=new PIXI.Rectangle(0,0,this.plotWindowSize,this.plotWindowSize),this.plotAreaRect=new PIXI.Graphics,this.plotAreaRect.lineStyle(2,3092271,1),this.plotAreaRect.drawRect(0,0,this.plotWindowSize,this.plotWindowSize),this.plotRoot.addChild(this.plotAreaRect)}startAnimationFn(){this.hasFocus=!0,this.plotRoot.visible=!0,this.stopAnimation&&(this.stopAnimation=!1,this.animate())}stopAnimationFn(){this.popupContainer.removeChildren(),this.render(),this.hasFocus=!1,this.stopAnimation=!0,this.plotRoot.visible=!1,this.dynamicSelectionId&&ReScatter.dynamicSelectionModel&&ReScatter.dynamicSelectionModel.removeDynamicSelection(this.dynamicSelectionId)}animate(){this.now=0;let e=this;return function t(){if(e.stopAnimation)return;e.animationId=window.requestAnimationFrame(t),e.now=Date.now();let n=e.now-e.then;if(n>e.frameDelay&&(e.then=e.now-n%e.frameDelay,!e.inRender)){e.inRender=!0;let t=Date.now();e.render();let n=Date.now()-t;e.hasFocus?(e.frameDelay=n>120?120:n,e.frameDelay=n<20?20:e.frameDelay):(e.frameDelay=n>800?800:10*n,e.frameDelay=n<120?120:e.frameDelay)}}()}render(e){let t=this.plotRoot.visible;this.plotRoot.visible=!0,e&&(this.basePlotContainer.cacheAsBitmap=!0),this.renderer.gl&&this.renderer.render(this.plotRoot),this.basePlotContainer.cacheAsBitmap=!1,this.inRender=!1,this.plotRoot.visible=t}destroy(){if(document.getElementById(this.elementId+"-title").innerHTML="",this.stopAnimation=!0,this.animationId&&window.cancelAnimationFrame(this.animationId),this.plotPoints={},this.scatter={},this.renderer.gl)try{this.renderer.gl.getExtension("WEBGL_lose_context").loseContext()}catch(e){console.log("Error forcing WebGL context release: "+e)}for(this.renderer.destroy();this.plotElement.firstChild;)this.plotElement.removeChild(this.plotElement.firstChild)}getParentWidth(){let e=window.getComputedStyle(this.plotElement);return this.plotElement.offsetWidth-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderLeftWidth)-parseFloat(e.borderRightWidth)}captureKeys(e){e?(this.keyListener=this.keyInput.bind(this),window.addEventListener("keydown",this.keyListener)):window.removeEventListener("keydown",this.keyListener)}keyInput(e){if(this.selectOver!==Ze.SelectionEnum.NONE&&this.hasFocus)switch(e.keyCode){case 78:this.numNeighbours>0&&ReScatter.controlEventModel.putControlEventModel("numNeighbours",{number:this.numNeighbours-1,selector:this.dynamicSelectionId});break;case 77:ReScatter.controlEventModel.putControlEventModel("numNeighbours",{number:this.numNeighbours+1,selector:this.dynamicSelectionId})}}startDrawing(e){this.renderer.selectOver!==Ze.SelectionEnum.MOUSEOVER&&($("#"+this.renderer.elementId).css("cursor","url("+ReScatter.cursors("./drawtarget2.png")+") 20 20, auto"),this.selectionShapeOrigin=e.data.getLocalPosition(this.renderer.plotRoot),this.activeBrushView=new PIXI.Graphics,this.activeBrushView.lineStyle(2/this.renderer.zoom,16711680,1),this.activeBrushModel=void 0,this.brushViewTree.addChild(this.activeBrushView),this.freehandPath=[],this.mousemove=this.touchmove=this.brushMousemove,this.captureMouse=!0)}brushMousemove(e){if(void 0===this.activeBrushView)return;let t=e.data.getLocalPosition(this.renderer.plotRoot);switch(this.activeBrushView.clear(),this.activeBrushView.lineStyle(2/this.renderer.zoom,16711680,1),this.renderer.brushType){case"Circle":let e={x:this.selectionShapeOrigin.x+(t.x-this.selectionShapeOrigin.x)/2,y:this.selectionShapeOrigin.y+(t.y-this.selectionShapeOrigin.y)/2},n=Math.sqrt(Math.pow(this.selectionShapeOrigin.x-t.x,2)+Math.pow(this.selectionShapeOrigin.y-t.y,2))/2;this.activeBrushView.drawCircle(e.x,e.y,n),this.activeBrushModel=new PIXI.Circle(e.x,e.y,n);break;case"Rectangle":let i=this.selectionShapeOrigin.x<t.x?this.selectionShapeOrigin.x:t.x,r=this.selectionShapeOrigin.y<t.y?this.selectionShapeOrigin.y:t.y;this.activeBrushView.drawRect(i,r,Math.abs(t.x-this.selectionShapeOrigin.x),Math.abs(t.y-this.selectionShapeOrigin.y)),this.activeBrushModel=new PIXI.Rectangle(i,r,Math.abs(t.x-this.selectionShapeOrigin.x),Math.abs(t.y-this.selectionShapeOrigin.y));break;case"Freehand":this.freehandPath.push(t.clone()),this.activeBrushView.drawPolygon(this.freehandPath),this.activeBrushModel=new PIXI.Polygon(this.freehandPath);break;default:}}endDrawing(e){if(this.captureMouse=!1,$("#"+this.renderer.elementId).css("cursor","url("+ReScatter.cursors("./drawtarget.png")+") 20 20, auto"),this.mousemove=this.touchmove=null,void 0===this.activeBrushView)return;if(void 0===this.activeBrushModel)return;let t="Circle";if(this.activeBrushModel.type===PIXI.SHAPES.POLY){let e=this.freehandPath.slice(0);e.push(this.freehandPath[0]),this.activeBrushView.drawPolygon(e),this.activeBrushModel=new PIXI.Polygon(e),t="Freehand "}else this.activeBrushModel.type===PIXI.SHAPES.CIRC?t="Circle ":this.activeBrushModel.type===PIXI.SHAPES.RECT&&(t="Rectangle ");let n=[];for(let e=0,t=this.renderer.allPointSprites.length;e<t;e++)this.activeBrushModel.contains(this.renderer.allPointSprites[e].position.x,this.renderer.allPointSprites[e].position.y)&&n.push(e);if(n.length>0){let e=this.renderer.selectionOutId;this.activeBrushModel.label=ReScatter.selectionModel.getNewLabel(e),ReScatter.selectionModel.putSelection(this.activeBrushModel.label,this.renderer.elementId,n,7807522,"User: "+t+", "+n.length+" points.",e,this.renderer.plotPropReader.props),this.activeBrushView.hitArea=this.activeBrushModel,this.activeBrushView.interactive=!0,this.activeBrushView.visible=!1,this.activeBrushView.mouseover=function(e){console.log("Shape contains: "+n.length+" points.")},this.activeBrushView.clear(),delete this.activeBrushView,delete this.activeBrushModel}else this.activeBrushView.clear(),delete this.activeBrushView,delete this.activeBrushModel;this.activeBrushView=void 0,this.activeBrushModel=void 0,this.activeBrushModel=void 0}onContextMenu(e){e.preventDefault();let t=this.scatterPoints.kdeValues();t.color="Grey",this.basePlotContainer.filters&&2===this.basePlotContainer.filters.length&&(t.color=this.lutFilter.currentName),ReScatter.controlEventModel.putControlEventModel("plotContextMenu",{plot:this,coords:{x:e.clientX,y:e.clientY},kde:t}),this.contextMenuLinked=!0,e.stopPropagation()}__mapProperty(e,t,n,i,r){let o=n.propMap[e].mapOp,a=n.propMap[e].mapFn,s=this,l=r;return new Promise(function(r,c){if(void 0===o){if(void 0===a){let n=l.group;if("group"===e)l[e]=t;else if("color"===e){let t=new Array(n.length);n.map(function(e,n){let i=s.allPointSprites[e];t[n]=i.tint}),l[e]=t}else if("size"===e){let t=new Array(n.length);n.map(function(e,n){let i=s.allPointSprites[e];t[n]=i.pointSize}),l[e]=t}}else l[e]=a(t,s.plotPropReader.props,i);r(l)}else{ReScatter.data.DataMapper.getDataMap(n.dataMap).mapData(t,o).then(function(t){l[e]=a?a(t,s.plotPropReader.props,i):t,r(l)}).catch(function(e){console.log("Error in property mapping: "+e+" for "+s.id),r(l)})}})}processDynamicSelection(e,t){switch(e.op){case"create":this.addSelectionToContainer(this.dynamicRoot,void 0,e,t);break;case"transitive":this.applyTransitiveSelection(e,t);break;case"delete":try{this.dynamicRoot.removeChildren(),this.dynamicRoot.visible=!1,this.selectionsRoot.visible=!0,this.render()}catch(e){console.log("Error processing dynamic selection "+e)}finally{let e=this;setTimeout(function(){e.processingDone()},0)}break;default:this.processingDone()}}addSelectionToContainer(e,t,n,i){let r=this;Promise.resolve({color:void 0,size:void 0,group:void 0}).then(function(e){return r.__mapProperty("group",n.sel.dataPoints,i,void 0,e)}).then(function(e){return r.__mapProperty("color",n.sel.dataPoints,i,n.sel.color,e)}).then(function(e){return r.__mapProperty("size",n.sel.dataPoints,i,void 0,e)}).then(function(o){try{let a=i.propMap,s=a.color.propAssign!==qe.propAssign.POINT,l=a.size.propAssign!==qe.propAssign.POINT,c=s?o.color:void 0,u=l?o.size:4;"dyna"===n.type&&r.dynamicRoot.removeChildren();let h,d=new ReScatter.view.PointGroupView(r,n.sel.label,e,u,c,r.xScaleFunc,r.yScaleFunc,r.zoom);a.effects&&a.effects.map(function(e){switch(e){case"Outline":d.outline=!0;break;case"X":case"O":h=e}});o.group;let p=function(e){r.annotateInteractionTarget(e)};for(let e=0,t=o.group.length;e<t;e++){let t=s?void 0:o.color[e],n=l?void 0:o.size[e],i=o.group[e];d.addPoint(r.allPointSprites[i].point,t,n,h,r.allPointSprites[i]).mouseover=p}t&&(r.selectionViews[n.sel.label]=d),"dyna"===n.type?(r.dynamicRoot.visible=!0,r.selectionsRoot.visible=!1,d.visible=!0):n.sel.background&&(d.visible=!1)}catch(e){console.log("Error adding selection "+e+" for "+r.id)}finally{setTimeout(function(){r.processingDone()},0),r.render()}}).catch(function(e){console.log("Error adding selection:"+e+" in plot: "+r.id),setTimeout(function(){r.processingDone()},0)})}applyTransitiveSelection(e,t){let n=this;try{let i=t.propFilter.mapFn,r=[];if(e.sel.dataPoints.forEach(function(e,t,o){let a=i(e,n.plotPropReader.props);-1!==a&&r.push(a)}),r.length>0){let t=ReScatter.selectionModel.getNewLabel(this.selectionOutId);ReScatter.selectionModel.putSelection(t,this.elementId,r,7807522,this.selectionOutId+" selection via: "+e.sel.originator+", points: "+r.length,this.selectionOutId,this.plotPropReader.props)}}catch(e){console.log("Error performing transitive selection:"+e+" in plot: "+n.id)}finally{setTimeout(function(){n.processingDone()},0)}}__deletePointGroup(e){let t=this.selectionViews[e];void 0!==t&&(delete this.selectionViews[e],t.destroy(),this.render())}displayPlotData(e){console.log("display plot data for: "+this.annotations.length);let t=this,n=Math.max.apply(Math,this.plotPoints.map(function(e){return e.x})),i=Math.min.apply(Math,this.plotPoints.map(function(e){return e.x})),r=n-i,o=Math.max.apply(Math,this.plotPoints.map(function(e){return e.y})),a=Math.min.apply(Math,this.plotPoints.map(function(e){return e.y})),s=o-a;this.plotSize;this.yScaleFunc=function(e){return(e-a)*((t.plotSize-40)/s)+20},this.xScaleFunc=function(e){return(e-i)*((t.plotSize-40)/r)+20},function(){let n=function(e){t.annotateInteractionTarget(e)};console.log("using single container, annotations: "+t.annotations.length),t.scatterPoints=new ReScatter.view.PointGroupView(t,"pointGroup_0",t.basePlotContainer,3,void 0,t.xScaleFunc,t.yScaleFunc,t.zoom),function(i){console.log("Sprites in container for: "+t.elementId);for(let r=i;r<t.plotPoints.length;r++){let i=t.plotPoints[r];t.allPointSprites[r]=t.scatterPoints.addPoint(i,e[r]),t.allPointSprites[r].mouseover=n}t.scatterPoints.visible=!0,t.render(),console.log("Start rendering"),t.frameDelay=50,t.processingLoop(!0),setTimeout(function(){!function(e){ReScatter.controlEventModel.putControlEventModel("rendererLoadComplete",{renderer:e,rendererId:e.elementId,type:"plot"})}(t)},100)}(0)}()}annotateInteractionTarget(e){let t=e.target;t.point&&this.annotatePoint(t,e)}annotatePoint(e,t){if(this.plotRoot.captureMouse)return;void 0!==t&&t.stopPropagation(),this.popupContainer.removeChildren(),this.annotationTarget=e;let n=e.point.sym,i=Math.round(14/this.zoom),r=Math.round(5/this.zoom),o=PIXI.RESOLUTION*this.zoom;this.textPopup=new PIXI.Text(n,{font:"bold "+i+"px Arial",fill:"white",stroke:"black",strokeThickness:r},o);let a=Math.sqrt(Math.pow(e.point.x,2)+Math.pow(e.point.y,2)),s=20/this.zoom,l=2/this.zoom,c=-s*e.point.x/a,u=-s*e.point.y/a;this.textPopup.x=e.position.x+c,this.textPopup.y=e.position.y+u,this.textPopup.anchor.x=e.point.x<0?0:1,this.textPopup.anchor.y=e.point.y<0?0:1,this.annotLine=new PIXI.Graphics,this.annotLine.lineStyle(l,16711680,1),this.annotLine.moveTo(e.position.x,e.position.y),this.annotLine.lineTo(this.textPopup.x,this.textPopup.y),this.popup=this.popupContainer.addChild(this.textPopup),this.popup=this.popupContainer.addChild(this.annotLine),this.dynamicSelectionId&&this.selectOver===Ze.SelectionEnum.MOUSEOVER&&this.mouseOverDynamicSelection(e.point.index)}mouseOverDynamicSelection(e){if(this.mouseOverSeedIndex=e,this.mouseOverIndexes=[],this.numNeighbours>=0){let t=this.tree.nearest(this.plotPoints[e],this.numNeighbours+1);for(let n=0;n<t.length;n++)(!this.mouseOverExcludeSeed||this.mouseOverExcludeSeed&&e!==t[n][0].i)&&this.mouseOverIndexes.push(t[n][0].i)}e>-1&&this.mouseOverIndexes.length>0&&ReScatter.dynamicSelectionModel.putDynamicSelection(this.elementId,this.mouseOverIndexes,7807522,this.dynamicSelectionId,this.plotPropReader.props)}applyZoomToPoint(e){let t=this.plotRoot.position,n=this.zoom,i=0,r=0;if(1!==this.zoomFactor){let o=this.plotRoot.scale.x,a=e.offsetX,s=e.offsetY;i=n/o*(t.x-a)+a,r=n/o*(t.y-s)+s}this.plotRoot.position=new PIXI.Point(i,r),this.plotRoot.scale=new PIXI.Point(this.zoom,this.zoom),this.zoomActiveOverlays(this),this.render()}zoomActiveOverlays(e){e.scatterPoints.zoom(e.zoom),Object.keys(e.selectionViews).forEach(function(t){e.selectionViews[t].visible&&e.selectionViews[t].zoom(e.zoom)}),e.popupContainer.children.length>0&&e.annotatePoint(e.annotationTarget)}zoomWheel(e){(e.ctrlKey||e.metaKey)&&(e.preventDefault(),e.deltaY<0&&this.currentZoomLevel<this.maxZoomLevel?(this.currentZoomLevel++,this.zoomFactor=this.zoomLevels[this.currentZoomLevel],this.applyZoomToPoint(e)):e.deltaY>0&&this.currentZoomLevel>0&&(this.currentZoomLevel--,this.zoomFactor=this.zoomLevels[this.currentZoomLevel],this.applyZoomToPoint(e)))}selectOnClick(e){if(this.selectOver!==Ze.SelectionEnum.MOUSEOVER)return;if(0===this.mouseOverIndexes.length)return;this.renderer.selectionOutId;let t=ReScatter.selectionModel.getNewLabel(this.selectionOutId);ReScatter.selectionModel.putSelection(t,this.renderer.elementId,this.mouseOverIndexes,7807522,"Seed: "+this.plotPropReader.getSymbol(this.mouseOverSeedIndex)+(this.mouseOverExcludeSeed?" (excluded) ":" ")+this.mouseOverIndexes.length+" points.",this.selectionOutId)}getPropertyIndexNeighbours(e){let t=[],n=this;return e.forEach(function(e){if(n.numNeighbours>=0){let i=n.tree.nearest(n.plotPoints[e],n.numNeighbours+1);for(let r=0;r<i.length;r++)(!n.mouseOverExcludeSeed||n.mouseOverExcludeSeed&&e!==i[r][0].i)&&t.push(i[r][0].i)}}),t}neighbourhoodSelectIndexes(e){this.mouseOverIndexes=[],this.propertyOverIndexes=e;let t=this.getPropertyIndexNeighbours(e);t.length>0&&ReScatter.dynamicSelectionModel.putDynamicSelection(this.elementId,t,7807522,this.dynamicSelectionId,this.plotPropReader.props)}selectOnProperty(){if(0===this.propertyOverIndexes.length)return;let e=this.getPropertyIndexNeighbours(this.propertyOverIndexes),t=ReScatter.selectionModel.getNewLabel(this.selectionOutId);ReScatter.selectionModel.putSelection(t,this.elementId,e,7807522,"Seed: "+this.plotPropReader.getSymbol(this.propertyOverIndexes[0])+(this.mouseOverExcludeSeed?" (excluded) ":" ")+e.length+" points.",this.selectionOutId)}get zoom(){return this.resizeZoom*this.zoomFactor}static get SelectionEnum(){return{NONE:0,MOUSEOVER:1,PROPOVER:2}}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Ze,"brushModeEnum",new ne({CIRCLE:"Circle",RECTANGLE:"Rectangle",FREEHAND:"Freehand"})),A.impl(Ze,[],{loadPlotData(e,t,n){this.plotPoints=new Array(e.length),this.allPointSprites=new Array(e.length);let i=new Array(e.length);this.annotationPoints={},this.plotPropReader=new Xe(t,n);let r=function(e,t){return void 0===e||void 0===t?1e3:Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)};this.renderer.backgroundColor=this.plotPropReader.getBackgroundColor();let o=[],a=this;!function t(n){let s;for(s=n;s<e.length;s++){let t={x:e[s][0],y:-e[s][1],id:a.plotPropReader.getId(s),sym:a.plotPropReader.getSymbol(s),properties:a.plotPropReader.props,index:s};i[s]={x:e[s][0],y:-e[s][1],i:s},o.push(a.plotPropReader.getColor(s)),a.plotPoints[s]=t;let n=a.plotPropReader.getGroup(s);if(n&&(-1===a.annotations.indexOf(n)&&(a.annotations.push(n),a.annotationsColor.push(o[s]),a.annotationPoints[n]=[]),a.annotationPoints[n].push(t)),s%1e3==999)break}s<e.length-1?(ReScatter.controlEventModel.putControlEventModel("loadingProgress",{id:a.id,total:e.length,loaded:s+1}),setTimeout(t,10,s+1)):(a.tree=new Je.kdTree(i,r,["x","y","i"]),setTimeout(a.displayPlotData.bind(a,o),10))}(0)},onResize(){this.plotWindowSize=this.plotElement.clientWidth;let e=this.zoom;this.resizeZoom=this.plotWindowSize/this.originalSize;let t=this.zoom/e,n=this.plotRoot.position;n.x=t*n.x,n.y=t*n.y,this.plotRoot.position=n,this.plotRoot.scale=new PIXI.Point(this.zoom,this.zoom),this.renderer.resize(this.plotWindowSize,this.plotWindowSize),this.zoomActiveOverlays(this),this.render()}}),Ce.impl(Ze,[],{processSelectionEvent(e){let t;if("dyna"!==e.type)if(t=this.selectionIn[e.id],"create"!==e.op)try{switch(e.op){case"delete":this.__deletePointGroup(e.sel.label);break;case"color":if(t.propMap.color.propAssign!==qe.propAssign.POINT){let t=this.selectionViews[e.sel.label];t.setColor(e.sel.color),t.visible&&this.render()}break;case"hide":let n=this.selectionViews[e.sel.label];n&&(n.visible=!1,this.render());break;case"show":let i=this.selectionViews[e.sel.label];i&&(this.dynamicRoot.visible=!1,this.selectionsRoot.visible=!0,i.visible=!0,i.zoom(this.zoom),this.render());break;case"update":if(this.selectionOutId===e.sel.selectionId){this.__deletePointGroup(e.sel.label);let n=jQuery.extend({},e);n.op="create",this.addSelectionToContainer(this.selectionsRoot,this.selectionViews,n,t)}break;default:console.log("Unmatched context operation "+e)}}catch(e){console.log("Error processing context op "+e)}finally{this.processingDone()}else this.addSelectionToContainer(this.selectionsRoot,this.selectionViews,e,t);else void 0!==(t=this.dynamicSelectionIn[e.id])?this.processDynamicSelection(e,t):this.processingDone()}}),Ae.impl(Ze,[],{onControlEvent(e){switch(e.eventName){case"brushMode":this.brushType=e.event.brushType;break;case"editOp":this.editOp=e.event.editOp;break;case"editMode":if(this.editMode="NEW","EXISTING"===e.event.editMode&&this.selectionOutId===e.event.selectionId){let t=this.selectionViews[e.event.editTarget];t&&(t.visible=!0,this.editMode="EXISTING")}break;case"numNeighbours":if(e.event.selector===this.dynamicSelectionId&&(this.numNeighbours=e.event.number,this.selectOver!==Ze.SelectionEnum.NONE&&this.contextMenuLinked))switch(this.selectOver){case Ze.SelectionEnum.MOUSEOVER:this.mouseOverDynamicSelection(this.mouseOverSeedIndex);break;case Ze.SelectionEnum.PROPOVER:this.neighbourhoodSelectIndexes(this.propertyOverIndexes)}break;case"plotContextMenuClosed":e.event.selector===this.dynamicSelectionId&&this.id===e.event.value.formId&&(this.contextMenuLinked=!1);break;case"mouseOverActive":e.event.selector===this.dynamicSelectionId&&(this.selectOver=e.event.active,this.mouseOverExcludeSeed=e.event.noSeed,this.captureKeys(this.selectOver!==Ze.SelectionEnum.NONE));break;case"kdePlotActive":if(e.event.selector===this.dynamicSelectionId){let t=e.event.value;if(t.active){this.scatterPoints.setKdeOn(t.sigma,t.contours),this.colorSet||(this.lutFilter=new ReScatter.view.LUTFilter(this.plotPropReader.getBackgroundColor()),this.colorSet=[this.lutFilter]),this.basePlotContainer.filters=this.colorSet;let e="Grey"==t.color?"gray":t.color,n=this;this.lutFilter.setLut(e,function(){n.basePlotContainer.filters=n.colorSet,n.render()}),this.render}else this.scatterPoints.setKdeOff(),this.basePlotContainer.filters=void 0,this.render()}break;case"kdePlotChanged":if(e.event.selector===this.dynamicSelectionId){let t=e.event.value;if(t.active){this.scatterPoints.updateKde(t.sigma,t.contours);let e="Grey"==t.color?"gray":t.color,n=this;this.lutFilter.setLut(e,function(){n.basePlotContainer.filters=n.colorSet,n.render()}),this.render}}break;case"propertySelect":e.event.selector===this.dynamicSelectionId&&e.event.targetPlotId===this.id&&this.neighbourhoodSelectIndexes(e.event.indexes);break;case"savePropertySelect":e.event.selector===this.dynamicSelectionId&&e.event.targetPlotId===this.id&&this.selectOnProperty();break;case"changePointMode":this.currentConfig=e.event.pointMode,this.selectionIn=this.switchableSelections.getSelectionMapping(this.currentConfig),this.dynamicSelectionIn=this.switchableSelections.getDynamicSelectionMapping(this.currentConfig);break;default:return}}}),K.impl(Ze,[],{getNumberofCanvases:()=>1,getCanvasNameAtIndex(e){return this.id},getCanvasAtIndex(e){return this.renderer.view}});let $e=new _e,et=null;class tt{constructor(){if(et)return et;this.currentPlot=void 0,this.inInitialize=!1,this.controlGroups=new Map,this.controlGroups.set(tt.selectionState.ALL,["seedPropId","seedPropValueId","savePropSelectionId","excludeSeedId","NumNeighboursId","neighboursSectionId","brushModeId"]),this.controlGroups.set(tt.selectionState.DRAW,["brushModeId"]),this.controlGroups.set(tt.selectionState.MOUSEOVER,["excludeSeedId","NumNeighboursId","neighboursSectionId"]),this.controlGroups.set(tt.selectionState.PROPERTY,["seedPropId","seedPropValueId","savePropSelectionId","excludeSeedId","NumNeighboursId","neighboursSectionId"]);let e=(new W).getLutNameGroups(),t=Object.keys(e);this.lutNames=["Grey"],t.forEach(function(t,n,i){this.lutNames.push({id:" "+t+"' disabled '",value:t}),e[t].forEach(function(e,t,n){this.lutNames.push(e)},this)},this);let n=this;return this.plotContextMenu=webix.ui({view:"window",container:ReScatter.CONTROL_ID.PLOTMENU,hidden:!0,move:!0,zindex:999,sizeToContent:!0,id:"plotContextMenuUI",head:{view:"toolbar",margin:-4,height:25,cols:[{view:"label",label:"Settings"},{view:"icon",icon:"times-circle",css:"alter",on:{onItemClick:function(e,t){n.hideMe()}}}]},body:{id:"plotProperties",view:"form",autoheight:!0,width:350,type:"clean",complexData:!0,elements:[{view:"text",label:"Plot",name:"plotId",readonly:!0},{view:"text",name:"staticSelectionLabel",readonly:!0,hidden:!0},{view:"text",name:"dynamicSelectionLabel",readonly:!0,hidden:!0},{view:"text",name:"canvasSelectorLabel",readonly:!0,hidden:!0},{view:"template",template:"Selection",type:"section",height:25},{rows:[{view:"radio",label:"Method:",name:"activeSelection",value:0,height:25,optionHeight:12,options:[{id:ReScatter.control.PixijsPlotController.SelectionEnum.NONE,value:"Draw"},{id:ReScatter.control.PixijsPlotController.SelectionEnum.MOUSEOVER,value:"Mouse"},{id:ReScatter.control.PixijsPlotController.SelectionEnum.PROPOVER,value:"Property"}],on:{onChange:function(e,t){n.changeSelectionControlState(e),n.changeActiveSelection(this,e,t)}}},{view:"select",id:"brushModeId",label:"Brush mode",inputWidth:250,labelWidth:100,value:"Circle",yCount:"3",autoheight:!0,readonly:!0,options:re(Ze.brushModeEnum),on:{onChange:function(e,t){ReScatter.controlEventModel.putControlEventModel("brushMode",{brushType:e})}}},{view:"select",id:"seedPropId",label:"Prop",inputWidth:250,labelWidth:70,inputHeight:30,readonly:!0,options:[],on:{onChange:function(e,t){let n=this.getFormView().elements.staticSelectionLabel.getValue();document.body.style.cursor="wait",setTimeout(function(){let t=ReScatter.dataModel.getUniqueSelectionPropValues(n,e);t=t.map(function(e){return e.toString()}),$$("seedPropSuggest").getList().clearAll(),$$("seedPropSuggest").getList().parse(t.sort()),document.body.style.cursor="auto"},0)}}},{view:"text",id:"seedPropValueId",label:"Value",inputWidth:250,labelWidth:70,inputHeight:30,suggest:{id:"seedPropSuggest",keyPressTimeout:50,filter:function(e,t){return void 0!==e.value&&(e.value.toString().length<=1?0===e.value.toString().toLowerCase().indexOf(t.toLowerCase()):t.length>0&&0===e.value.toString().toLowerCase().indexOf(t.toLowerCase()))},on:{onValueSuggest:function(e){n.doPropertySelection()}},data:[]},on:{onKeyPress:function(e,t){e==="\r".charCodeAt(0)&&n.doPropertySelection()}}},{view:"button",id:"savePropSelectionId",label:"Save prop selection",align:"center",height:25,width:175,on:{onItemClick:function(e,t){let n=this.getFormView().elements.dynamicSelectionLabel.getValue();ReScatter.controlEventModel.putControlEventModel("savePropertySelect",{selector:n,targetPlotId:$$("plotProperties").elements.plotId.getValue()})}}},{view:"template",template:"Nearest Neighbours",type:"section",id:"neighboursSectionId",height:25},{cols:[{view:"checkbox",label:"Exclude seed",labelPosition:"top",id:"excludeSeedId",width:140,name:"mouseInteractionNoSeed",value:!0,height:35,gravity:3,on:{onItemClick:function(){let e=$$("plotProperties").elements.dynamicSelectionLabel.getValue();ReScatter.controlEventModel.putControlEventModel("mouseOverActive",{active:parseInt(this.getFormView().elements.activeSelection.getValue()),noSeed:this.getFormView().elements.mouseInteractionNoSeed.getValue(),selector:e})}}},{view:"slider",id:"NumNeighboursId",title:"Neighbors: 15",name:"numNeighbours",width:190,height:35,value:15,step:1,min:0,disabled:!1,on:{onSliderDrag:function(){n.neighboursChange(this)},onChange:function(){n.neighboursChange(this)}}}]},{view:"template",template:"Display effect",type:"section",id:"effectsSectionId",height:25},{view:"select",id:"pointDisplayId",name:"pointDisplayMode",label:"Point color",labelWidth:100,readonly:!0,options:["Default"],on:{onChange:function(e,t){this.getFormView().elements.staticSelectionLabel.getValue();ReScatter.controlEventModel.putControlEventModel("changePointMode",{pointMode:e})}}}]},{view:"template",template:"Density plot",type:"section",height:25},{cols:[{view:"checkbox",label:"Active",name:"kdePlotActivate",id:"kdePlotActivateId",value:!1,on:{onItemClick:function(){let e=this.getFormView().elements.dynamicSelectionLabel.getValue(),t=this.getFormView().elements.kdekernelSigma.getValue(),n=this.getFormView().elements.kdekernelContours.getValue(),i=this.getFormView().elements.kdePlotColor.getValue();ReScatter.controlEventModel.putControlEventModel("kdePlotActive",{selector:e,value:{active:this.getValue(),sigma:t,contours:n,color:i}})}}},{view:"select",name:"kdePlotColor",id:"lutColorId",label:"Color",disabled:!0,inputWidth:175,labelWidth:70,readonly:!0,options:[],on:{onChange:function(e,t){et.kdeChange(this)}}}],height:25},{view:"slider",title:"Sigma: 12",height:35,name:"kdekernelSigma",value:12,min:1,max:80,step:1,on:{onChange:function(){n.kdeChange(this,"Sigma")},onSliderDrag:function(){n.kdeChange(this,"Sigma")}}},{view:"counter",label:"Contours",height:35,name:"kdekernelContours",value:32,min:5,max:63,step:1,on:{onChange:function(){n.kdeChange(this)}}},{view:"template",template:"Plot to image",type:"section",height:25},{cols:[{view:"button",id:"savePlot",label:"Current",height:25,on:{onItemClick:function(e,t){let n=this.getFormView().elements.canvasSelectorLabel.getValue(),i=this.getFormView().elements.plotId.getValue();ReScatter.utils.SnapshotSaver.saveCanvasToPng(n,i+".png")}}},{view:"button",id:"saveAllPlots",label:"All",height:25,on:{onItemClick:function(e,t){Pe.snapshotAll()}}}]}],on:{onValues:function(){this.elements.numNeighbours.define("max",this.getValues().maxNeighbours),this.elements.numNeighbours.define("title","Neighbours: "+this.elements.numNeighbours.getValue())},onHide:function(){this.hideMe()}}}}),$e.addTooltipToWebixControl(this.plotContextMenu,"IMEPlotContextMenu","top-right"),et=this}__setDisplayEffects(e){$$("effectsSectionId").show(),$$("pointDisplayId").show(),$$("pointDisplayId").define("options",Array.from(e)),$$("pointDisplayId").refresh()}__setDisplayEffectVisibility(e){e.length<=1&&($$("effectsSectionId").hide(),$$("pointDisplayId").hide())}kdeChange(e,t){if(void 0!==t&&e.define("title",t+": "+e.getValue()),e.refresh(),!e.getFormView().elements.kdePlotActivate.getValue())return;let n=e.getFormView().elements.dynamicSelectionLabel.getValue(),i=e.getFormView().elements.kdekernelSigma.getValue(),r=e.getFormView().elements.kdekernelContours.getValue(),o=e.getFormView().elements.kdePlotColor.getValue();this.inInitialize||ReScatter.controlEventModel.putControlEventModel("kdePlotChanged",{selector:n,value:{active:!0,sigma:i,contours:r,color:o}})}neighboursChange(e){let t=e.getFormView().elements.dynamicSelectionLabel.getValue();e.define("title","Neighbours: "+e.getValue()),e.refresh(),this.inInitialize||ReScatter.controlEventModel.putControlEventModel("numNeighbours",{number:e.getValue(),selector:t})}changeActiveSelection(e,t,n){if(this.inInitialize)return;let i=parseInt(t),r=e.getFormView().elements.dynamicSelectionLabel.getValue();ReScatter.controlEventModel.putControlEventModel("mouseOverActive",{active:i,noSeed:e.getFormView().elements.mouseInteractionNoSeed.getValue(),selector:r})}changeSelectionControlState(e){let t="string"==typeof e?parseInt(e):e;this.controlGroups.get(tt.selectionState.ALL).forEach(function(e){$$(e).hide()}),this.controlGroups.get(t).forEach(function(e){$$(e).show()})}hideMe(){if(this.currentPlot){let e=$$("plotProperties");ReScatter.controlEventModel.putControlEventModel("plotContextMenuClosed",{selector:e.elements.dynamicSelectionLabel.getValue(),value:{formId:this.currentPlot.id}})}$$("plotContextMenuUI").hide()}doPropertySelection(){let e=$$("plotProperties").elements.staticSelectionLabel.getValue(),t=$$("plotProperties").elements.dynamicSelectionLabel.getValue(),n=$$("seedPropId").getValue(),i=$$("seedPropValueId").getValue(),r=ReScatter.dataModel.getSelectionIndexes(e,n,i,!0);ReScatter.controlEventModel.putControlEventModel("propertySelect",{indexes:r,selector:t,targetPlotId:$$("plotProperties").elements.plotId.getValue()})}static get selectionState(){return{ALL:Ze.SelectionEnum.NONE-1,DRAW:Ze.SelectionEnum.NONE,MOUSEOVER:Ze.SelectionEnum.MOUSEOVER,PROPERTY:Ze.SelectionEnum.PROPOVER}}}Ae.impl(tt,[],{onControlEvent(e){switch(e.eventName){case"plotContextMenu":try{this.inInitialize=!0,this.currentPlot=e.event.plot,this.__setDisplayEffects(this.currentPlot.selectionConfigs),this.plotContextMenu.show(),$$("plotProperties").setValues({dynamicSelectionLabel:e.event.plot.dynamicSelectionId,staticSelectionLabel:e.event.plot.selectionOutId,canvasSelectorLabel:e.event.plot.elementId,plotId:e.event.plot.id,activeSelection:e.event.plot.selectOver,mouseInteractionNoSeed:e.event.plot.mouseOverExcludeSeed,numNeighbours:e.event.plot.numNeighbours,maxNeighbours:Math.ceil(Math.sqrt(e.event.plot.plotPoints.length)),kdekernelSigma:e.event.kde.sigma,kdekernelContours:e.event.kde.contours,kdePlotColor:e.event.kde.color},!0),$$("plotProperties").callEvent("onValues",[]),$$("kdePlotActivateId").setValue(e.event.kde.activate);let t=ReScatter.dataModel.getSelectionPropKeys(e.event.plot.selectionOutId),n=[];t.forEach(function(e,t,i){n.push({id:e,value:e})});let i=$$("seedPropId").isVisible();$$("seedPropId").show(),$$("seedPropId").define("options",t.sort()),$$("seedPropId").setValue(ReScatter.dataModel.getSelectionPrimaryProp(e.event.plot.selectionOutId)),$$("seedPropId").refresh(),i||$$("seedPropId").hide(),i=$$("lutColorId").isVisible(),$$("lutColorId").show(),$$("lutColorId").define("options",this.lutNames),$$("lutColorId").refresh(),$$("lutColorId").setValue(e.event.kde.color),$$("lutColorId").enable(),i||$$("lutColorId").hide(),this.__setDisplayEffectVisibility(this.currentPlot.selectionConfigs),this.plotContextMenu.setPosition(e.event.coords.x,e.event.coords.y)}catch(e){console.log("Error displaying plot context menu: "+e)}finally{this.inInitialize=!1}break;case"numNeighbours":$$("plotProperties").getValues().dynamicSelectionLabel===e.event.selector&&$$("plotProperties").setValues({numNeighbours:e.event.number},!0);break;case"hidePlotContextMenu":this.hideMe();break;default:return}}});let nt=null;class it{constructor(){if(nt)return nt;this.id="loadPredefinedSelectionsId",this.lastLoaded="";let e=this;return this.predefSelectionsDef={id:e.id,view:"datatable",columns:[{id:"title",header:"Name",width:250,template:"<p>#title#<p>"},{id:"description",hidden:!0,header:"Description",minWidth:120,template:"<p>#description#<p>"},{id:"targetId",hidden:!0,header:"Type",minWidth:60,template:"<p>#targetId#</p>"}],header:!1,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:25,rowHeight:25,select:"row",scrollX:!1,multiselect:!1,on:{onResize:webix.once(function(){this.myAdjustRowHeight(["title"],!0),this.render()}),onSelectChange:function(){let t=this.getSelectedItem();e.loadPredefinedSelections(t)}}},this.formId=ReScatter.controlWidgetLayout.addTabView(this.predefSelectionsDef,"Predefined selections",!1),nt=this}renewSelections(e){$$(this.formId).clearAll(),e&&$$(this.formId).parse(e)}getLastLoaded(e){return this.lastLoaded}getPreloadControlDef(){return this.predefSelectionsDef}clearLastLoaded(){this.lastLoaded=""}loadPredefinedSelections(e){if(void 0===e)return;ReScatter.selectionTable.clearAll();let t=e.preselect,n=[{path:t,type:"json"}],i=this;ReScatter.dataModel.dataCache.loadFiles(n,function(){i.addSelections(e.id,e.targetId,t)}),ReScatter.selectionDataWidget.expand()}addSelections(e,t,n){let i=ReScatter.dataModel.dataCache.getFromCache(n);ReScatter.selectionTable.render(),this.lastLoaded=e;for(let e=0,n=i.length;e<n;e++)$("#"+ReScatter.CONTROL_ID.LOADINGPROMPT).text("Loading selection:  "+i[e].description),ReScatter.selectionModel.putSelection(i[e].selection,"Predefined",i[e].dataPoints,parseInt(i[e].color.replace("#","0x")),i[e].description,t,void 0,!0);$("#loading").css("display","none")}hidePrivateColumns(){["description","targetId"].forEach(function(e,t,n){$$(this.id).hideColumn(e)})}getId(){return this.id}}let rt=null;const ot=n(29);class at{constructor(e){return rt||(this.layoutData=e,this.ids=[],this.__updateIds(),this.pubsubid="DYNAMICCONTENT_"+Date.now(),rt=this)}getNextId(){return this.ids.length>0?this.ids.slice(-1)[0]+10:10}addLayout(e){if(-1!==this.ids.indexOf(e.id))throw new Error("Plot data plot ids must be unique");this.layoutData.push(e),this.__updateIds(),ot.publish(this.pubsubid,{layouts:this})}removeLayout(e){this.layoutData=this.layoutData.filter(function(t){return t.id!==e}),this.__updateIds()}cloneLayout(e){let t=JSON.parse(JSON.stringify(e));e.selectionConfigs&&(t.selectionConfigs=Array.from(e.selectionConfigs)),e.recalculation&&(t.recalculation=e.recalculation);for(let l=0;l<e.plots.length;l++){let c=e.plots[l],u=t.plots[l];if(u.layoutTarget!==ReScatter.control.LayoutController.LayoutTarget.SPACER){for(var n=Object.keys(c.format),i=0;i<n.length;i++){let e=n[i];"function"==typeof c.format[e]&&(u.format[e]=c.format[e])}if(u.selections||(u.selections={}),c.selections.selectionIn){u.selections.selectionIn={};for(var r=Object.keys(c.selections.selectionIn),o=0;o<r.length;o++){let e=r[o];u.selections.selectionIn[e]=c.selections.selectionIn[e]}}if(c.selections.dynamicSelectionIn){u.selections.dynamicSelectionIn={};for(var a=Object.keys(c.selections.dynamicSelectionIn),s=0;s<a.length;s++){let e=a[s];u.selections.dynamicSelectionIn[e]=c.selections.dynamicSelectionIn[e]}}c.selections.switchableSelections&&(u.selections.switchableSelections=c.selections.switchableSelections)}}if(e.choropleths)for(let n=0;n<e.choropleths.length;n++){let i=e.choropleths[n],r=t.choropleths[n];for(var l=Object.keys(i.selectionIn),c=0;c<l.length;c++){let e=l[c];r.selectionIn[e]=i.selectionIn[e]}for(var u=Object.keys(i.dynamicSelectionIn),h=0;h<u.length;h++){let e=u[h];r.dynamicSelectionIn[e]=i.dynamicSelectionIn[e]}}return t}addDerivedLayout(e,t,n,i,r,o,a,s){let l=this.layoutData.filter(function(t){return t.id===e});if(1!==l.length)throw new Error("No plot found to clone");let c=this.cloneLayout(l[0]);c.id=this.getNextId(),c.title=t,c.description=n,Object.keys(i).forEach(function(e){let t=c.plots.find(function(t){return t.id===e});t.data.points=i[e],t.data.props=r[e]});let u=[];for(var h=Object.keys(o),d=0;d<h.length;d++){let e=h[d],t={id:e,filePath:o[e]};u.push(t)}c.dataMaps=u;let p=this;ReScatter.dataModel.getPredefinedSelectionsSubSelection(a,s,function(e){e||p.addLayout(c),c.predefinedSelections=e,p.addLayout(c)})}__updateIds(){let e=[];this.layoutData.forEach(function(t){if(e.indexOf(t.id)>-1)throw new Error("Plot data plot ids must be unique");if("number"!=typeof t.id)throw new Error("Plot ids must be numeric");e.push(t.id)}),e.sort(function(e,t){return e-t}),this.ids=e}getLayoutConfig(){return this.layoutData}}var st=f.define([],{beforeContentChange:[],afterContentChange:[],resize:[]});var lt=f.define(["menuName","symbol","selectionList","selectionDescription"],{getMenuName:[],getPropertySymbol:[],getSupportedSelectionIds:[],exportSelection:["selectionList","selectionDescription"]});var ct=f.define(["operationGuid","dataCache","recalcConfig","dataMap","selectionIndexes","selectionId"],{getRecalculationData:["operationGuid","dataCache","recalcConfig","dataMap","selectionIndexes","selectionId"],getDataMap:[]});const ut=n(29);class ht{constructor(){st.hasImpl(new.target)||alert("LayoutTableWidgetBase child: "+new.target.name+" must implement the LayoutWidgetProtocol"),this.layouts=new at,this.layoutData=this.layouts.getLayoutConfig();let e=this;ut.subscribe(this.layouts.pubsubid,(t,n)=>{e._contentChanged(t,n)})}_contentChanged(e,t){this.beforeContentChange(),this.layoutData=t.layouts.getLayoutConfig(),this.afterContentChange()}loadLayout(e){ReScatter.viewController.loadLayout(e)}}class dt extends ht{constructor(){function e(e){let t="";if(void 0!==e)for(let n=0,i=e.length;n<i;n++)t+=e[n].id,n<i-1&&(t+=",<br>");else t="None";return t}super(),this.__id="selectPlotsId";let t=this;this.tableData=this.parseDataFromLayouts(this.layoutData),this.contentTableDef={id:this.id,view:"datatable",columns:[{id:"title",header:"Name",width:250,template:"<p style='word-wrap: break-word'>#title#<p>"},{id:"description",hidden:!0,header:"Description",template:"<p style='word_wrap: break-word'>#description#<p>"},{id:"plots",hidden:!0,header:"Plots",template:function(t){return"<p style='word-wrap: break-word'>"+e(t.plots)+"</p>"}},{id:"ontology",hidden:!0,header:"Ontology",template:function(t){return"<p style='word-wrap: break-word'>"+e(t.ontologies)+"</p>"}},{id:"choropleth",hidden:!0,header:"Choropleth",template:function(t){return"<p style='word-wrap: break-word'>"+e(t.choropleths)+"</p>"}}],autoheight:!0,header:!1,resizeColumn:!0,fixedRowHeight:!1,rowLineHeight:25,rowHeight:25,select:"row",multiselect:!1,scrollX:!1,on:{onResize:webix.once(function(){this.myAdjustRowHeight(["title"],!0),this.render()})},data:this.tableData},this.contentTableId=ReScatter.controlWidgetLayout.addTabView(this.contentTableDef,"Data sets",!1),this.contentTable=$$(this.contentTableId),this.selectChangeEvent=this.contentTable.attachEvent("onSelectChange",function(){t.doLoadLayout.bind(t)()}),this.sortingCol="id",this.sortByCol(this.sortingCol)}get id(){return this.__id}doLoadLayout(){let e,t=this.contentTable.getSelectedId();var n=!0,i=!1,r=void 0;try{for(var o,a=this.layoutData[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){let n=o.value;n.id===t.id&&(e=n)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}super.loadLayout(e)}parseDataFromLayouts(e){let t=[];var n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){let e=o.value,n={};n.id=e.id,n.title=e.title,n.description=e.description,n.plots=JSON.parse(JSON.stringify(e.plots)),e.choropleths&&(n.choropleths=JSON.parse(JSON.stringify(e.choropleths))),n.ontologies&&(n.ontologies=JSON.parse(JSON.stringify(e.ontologies))),t.push(n)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return t}hideColumns(e){e.forEach(function(e){this.contentTable.hideColumn(e)},this)}sortByCol(e){this.contentTable.sort(e),this.sortingCol=e}}st.impl(dt,[],{beforeContentChange(){this.contentTable.detachEvent(this.selectChangeEvent),this.contentTable.clearAll()},afterContentChange(){this.tableData=this.parseDataFromLayouts(this.layoutData),this.contentTable.parse(this.layoutData),this.sortByCol(this.sortingCol);let e=this;this.selectChangeEvent=this.contentTable.attachEvent("onSelectChange",function(){e.doLoadLayout.bind(e)()})},resize(){}});let pt=null;class ft{constructor(e){if(pt)return pt;this.enabled=!1,this.containerId=ReScatter.CONTROL_ID.TUTORIAL,this.loadedVideos={},this.titles=[],e.forEach((e,t)=>{this.loadedVideos[String(t)]=e.location,this.titles.push({id:t,value:e.title})});let t=this;return this.tutorialsControl=webix.ui({view:"window",container:t.containerId,hidden:!0,move:!0,css:"tutorialWindow",sizeToContent:!0,id:"tutorialVideosFormWindow",head:{view:"toolbar",margin:-4,cols:[{view:"label",label:"Tutorial videos"},{view:"icon",icon:"times-circle",css:"alter",on:{onItemClick:function(e,n){t.changedTutorialVisibility()}}}]},body:{id:"tutorialVideosForm",view:"form",height:516,width:850,type:"clean",complexData:!0,elements:[{view:"video",id:"tutorialVideoPlayer",hidden:!0,src:[]},{view:"iframe",id:"youtubeembedding",hidden:!1,src:t.loadedVideos[1],width:854,height:480,on:{onBeforeLoad:function(){$$("youtubeembedding").getIframe().setAttribute("allowfullscreen","allowfullscreen")}}},{view:"select",id:"tutorialVideosList",label:"Select tutorial video:",labelWidth:250,value:1,options:t.titles,on:{onChange:function(){let e=t.loadedVideos[this.getValue()];if(e.startsWith("https://www.youtube.com/")||e.startsWith("https://www.youtube-nocookie.com/"))$$("tutorialVideoPlayer").hide(),$$("youtubeembedding").show(),$$("youtubeembedding").load(e);else{$$("tutorialVideoPlayer").show(),$$("youtubeembedding").hide();let t=$$("tutorialVideoPlayer").getVideo();if($$("tutorialVideoPlayer").getNode().getElementsByTagName("source")[0].getAttribute("src")===e)return;t.pause(),$$("tutorialVideoPlayer").getNode().getElementsByTagName("source")[0].setAttribute("src",e),$$("tutorialVideoPlayer").getNode().getElementsByTagName("source")[0].setAttribute("type","video/mp4"),t.play()}}}}]},on:{onShow:function(){let e=$$("tutorialVideoPlayer").getVideo();e.hasAttribute("preload")||e.setAttribute("preload","auto");let t=$$("youtubeembedding").getIframe().getAttribute("src");$$("youtubeembedding").load(t)},onHide:function(){$$("tutorialVideoPlayer").getVideo().pause()}}}),pt}enableTutorial(){this.tutorialsControl.show(),this.enabled=!0,this.updateCheckBox()}disableTutorial(){this.tutorialsControl.hide(),this.enabled=!1,this.updateCheckBox()}changedTutorialVisibility(){this.enabled?this.disableTutorial():this.enableTutorial()}updateCheckBox(){let e=document.querySelector("#"+ReScatter.CONTROL_ID.TUTORIALCHECKBOX);this.enabled?e.nextSibling.data="Hide tutorial":e.nextSibling.data="Show tutorial"}destroy(){}}let gt=null;class At{constructor(e,t){return gt||(this.siteConfig=e,this.controlsEnabled=t,this.pluginWidgets=[],gt=this)}defineControls(){this.widgetsEnabled=this.controlsEnabled.includes("ReScatter.CONTROL_ID.WIDGETS");if(this.widgetsEnabled&&(ReScatter.controlWidgetLayout=new Ue,ReScatter.preselectionController=new it,ReScatter.layoutTableWidget=new dt,ReScatter.selectionDataWidget=new ze,ReScatter.selectionEditWidget=new Ge,ReScatter.selectionUploadWidget=new Qe,ReScatter.controlWidgetLayout.switchTabViewTo(ReScatter.layoutTableWidget.id),ReScatter.selectionTable=ReScatter.selectionDataWidget.selectionTable),this.controlsEnabled.includes("ReScatter.CONTROL_ID.TOOLTIPCHECKBOX")){let e=ReScatter.selectionTable.getParentView();ReScatter.control.toolTipController.addTooltipToWebixControl(e,"IMESelections","right","body"),ReScatter.control.toolTipController.addTooltipToWebixControl(e,"IMESelectionEditing","right","body");let t=ReScatter.controlWidgetLayout.getMultiViewParent();ReScatter.control.toolTipController.addTooltipToWebixControl(t,"IMEDataSets","right","body"),ReScatter.control.toolTipController.setupAllToolTips(),ReScatter.control.toolTipController.disableToolTips()}this.controlsEnabled.includes("ReScatter.CONTROL_ID.PLOTMENU")&&(ReScatter.plotContextMenu=new tt),this.controlsEnabled.includes("ReScatter.CONTROL_ID.TUTORIAL")&&(ReScatter.tutorialControl=new ft(this.siteConfig.Tutorials))}setLayoutWidgets(e){let t=e.Widgets;var n=!0,i=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){let t=o.value,n=t.plugin,i=t.contentId,r=t.title;ReScatter.controlWidgetLayout.addLayoutTabView(i,r,!0);let a=ReScatter.config.PluginFactory.createWidgetType(n,t,e);Pe.addComponent(a),this.pluginWidgets.push(a)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}clearLayoutWidgets(){this.pluginWidgets=[],ReScatter.controlWidgetLayout.removeLayoutTabs()}resize(){var e=!0,t=!1,n=void 0;try{for(var i,r=this.pluginWidgets[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){i.value.resize()}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}}let mt=null;class vt{constructor(){return mt||(this.pointGroup={},mt=this)}makeProgressString(){let e="Loaded: ",t=0,n=0;return Object.getOwnPropertyNames(this.totals).forEach(i=>{e+=i+": "+Math.round(100*this.totals[i].loaded/this.totals[i].total)+"% <br/>",t+=this.totals[i].total,n+=this.totals[i].loaded}),e+=" Loaded: "+n+" of "+t}loadingComplete(){this.totals={}}showPrompt(){$("#"+ReScatter.CONTROL_ID.LOADINGOVERLAY).css("display","inline")}hidePrompt(){$("#"+ReScatter.CONTROL_ID.LOADINGOVERLAY).css("display","none")}}Ae.impl(vt,[],{onControlEvent(e){switch(e.eventName){case"showProgress":console.log("Show progress"),this.showPrompt(),setTimeout(()=>{},10);break;case"hideProgress":console.log("Hide progress"),setTimeout(()=>{},10),this.hidePrompt();break;case"startLoading":this.showPrompt(),$("#"+ReScatter.CONTROL_ID.LOADINGPROMPT).text("Loading:  "+e.event.info),this.totals={};break;case"loadingProgress":this.totals[e.event.id]={total:e.event.total,loaded:e.event.loaded},$("#"+ReScatter.CONTROL_ID.LOADINGPROMPT).html(this.makeProgressString()),setTimeout(()=>{},10);break;case"selectionsProgress":$("#"+ReScatter.CONTROL_ID.LOADINGPROMPT).html(e.event.selectionState),setTimeout(()=>{},10);break;default:return}}});const bt=n(160),yt=/^[\.|\.\.|/][\w/\.]*$/,wt=RegExp(yt.source+"|"+/^https?:\/\/[\S]+$/.source),St={id:bt.string().minLength(1).required(),filePath:bt.string().minLength(1).required()},Et=[bt.object(),bt.string(),bt.func().length(1),bt.number()],_t={color:Et,id:Et,symbol:Et,shape:Et,size:Et,group:Et,primary:Et,background:Et},Rt={preprocessPlugin:bt.string().required(),basemapSelections:bt.object().pattern([/\w+/,[...Object.values(p.axis)]])},xt={inputData:bt.string().required(),targetPlotId:bt.string().required(),parameters:bt.object().keys({calcAxis:bt.number().required().valid(...Object.values(p.axis)),algorithmParams:bt.object().pattern([/^[\w/\.]+$/,bt.alternatives(bt.number().required(),bt.bool().required())])})},Ct={baseDataMaps:bt.array().includes(St).required(),dataAnalysis:bt.object().keys({dataPreprocess:Rt,analysisPlugin:bt.string().required(),analyses:bt.object().pattern([/^[\w/\.]+$/,xt])})},It={data:bt.string().required(),selectionAxis:bt.object().pattern([/\w+/,[...Object.values(p.axis)]]),calcAxis:bt.number().required().valid(...Object.values(p.axis)),parameters:bt.any()},Tt={data:bt.string().required(),selectionAxis:bt.object().pattern([/\w+/,[...Object.values(p.axis)]])},Pt={propAssign:bt.number().valid(...Object.values(qe.propAssign)).optional(),mapOp:bt.number().valid(...Object.values(qe.mapOp)).optional(),mapFn:bt.func().optional()},Ot={dataMap:bt.string().required(),propMap:bt.object().keys({color:Pt,size:Pt,group:[Pt,{}],effects:bt.array().includes(["O","X"]).optional()}).required()},kt={propFilter:bt.object().keys({mapFn:bt.func().length(2)}).required()},Mt=bt.alternatives(Ot,kt),Lt={points:bt.string().match(yt),props:bt.string().match(yt)},Bt={selectionOut:bt.string(),dynamicSelectionOut:bt.string(),switchableSelections:bt.object().type(G),selectionIn:bt.object().pattern([/^[\w/\.]+$/,Mt]),dynamicSelectionIn:bt.object().pattern([/^[\w/\.]+$/,Mt]),selectionDefaults:{numNeighbours:bt.number().integer().min(0),selectOver:bt.number().valid(...Object.values(Ze.SelectionEnum)).required(),mouseOverExcludeSeed:bt.bool()}},Dt={id:bt.string().minLength(1),layoutTarget:bt.number().valid(...Object.values(Ne.LayoutTarget)).required(),data:Lt,format:_t,selections:Bt,recalculation:It},Nt={id:bt.string().minLength(1),plugin:bt.string().minLength(1).optional(),type:bt.number().valid(...Object.values(Le.LoaderType)).optional(),svgTemplate:/^.*<svgid>.*$/,thumbnailTemplate:/^.*<svgid>.*$/,svgList:bt.array().minLength(0).includes(/^[\w/\.]+$/),region_ids:/^[\w/\.]+$/,preselect:bt.array().minLength(0).includes(/^[\w/\.]+$/),props:/^[\w/\.]+$/,dynamicSelectionOut:bt.string().minLength(1),recalculation:Tt,switchableSelections:bt.object().type(G),selectionIn:bt.object().pattern([/^[\w/\.]+$/,Mt]),dynamicSelectionIn:bt.object().pattern([/^[\w/\.]+$/,Mt]),popupAttributeList:bt.array().minLength(1).includes(/^.+$/)},Ut={id:bt.string().minLength(1),ontology_file:yt,dynamicSelectionOut:bt.string().minLength(1),openId:bt.array().includes(bt.number(),bt.string())},Vt=bt.array().includes({preselect:bt.string().match(yt).required(),id:bt.string().minLength(1).required(),title:bt.string().minLength(1).required(),description:bt.string().minLength(1).required(),targetId:bt.string().minLength(1).required()}),jt={id:bt.number().min(0).integer().required(),title:bt.string().minLength(1).required(),ontology:bt.string().minLength(1),description:bt.string().minLength(1).required(),dataMaps:bt.array().includes(St).required(),recalculation:Ct,selectionConfigs:bt.array().minLength(1).includes(/^.+$/),plots:bt.array().includes(Dt).required(),choropleths:bt.array().length(1).includes(Nt),ontologies:bt.array(Ut),predefinedSelections:bt.array(Vt)},Ft={title:bt.string().minLength(1),location:wt},zt={SiteTitle:bt.string().minLength(1).required(),Layouts:bt.array().minLength(1).includes(jt).required(),Tutorials:bt.array().includes(Ft).optional()};class Gt{constructor(e){this.unvalidatedSiteConfig=e,this.schema=zt,this.validatedConfig}__validateSiteConfig(){let e=bt.validate(this.unvalidatedSiteConfig,this.schema,{allowUnknown:!0,warnUnknown:!1});if(e.error||e.warnings){let t=e.error?e.error.length:0,n=e.warnings?e.warnings.length:0,i="Errors: "+t+"\n\n "+JSON.stringify(e.error).replace("/},{/g","},\\n\\n{")+"\n\nWarnings: "+n+"\n\n "+JSON.stringify(e.warnings).replace("/},{/g","},\\n\\n{");window.alert(i)}else this.validatedConfig=e.value}get siteConfig(){return this.validatedConfig||(this.validatedConfig=this.unvalidatedSiteConfig),this.validatedConfig}}let Qt=null;class Yt{constructor(e,t){return Qt||(Qt=this,this.controlsEnabled=t,this.__init(e),Qt)}__init(e){this.plotRenderers=[],this.allRenderers={},this.ontologyTree=void 0;let t=new Gt(e);this.siteConfig=t.siteConfig,this.layoutCollection=new at(this.siteConfig.Layouts),this.layoutController=new Ne(this.controlsEnabled),ReScatter.layoutManager=this.layoutController,this.widgetController=new At(this.siteConfig,this.controlsEnabled),this.progressController=new vt,this.dataModel=new p,this.controlEventModel=ReScatter.controlEventModel,this.siteTitle=this.siteConfig.SiteTitle,this.title="",this.renderPlotIndexes=[],this.widgetController.defineControls(),this.selectionConfig=void 0,this.startupCallback=void 0,this.setupSliders(this),ReScatter.dataModel=this.dataModel,this.siteConfig.Widgets&&this.widgetController.setLayoutWidgets(this.siteConfig),$(window).unload(()=>{this.unload()})}setupSliders(){if(this.controlsEnabled.includes("ReScatter.CONTROL_ID.LEFTSPLITTER")){$("#"+ReScatter.CONTROL_ID.LEFTSPLITTER).prev().resizable({handleSelector:"#"+ReScatter.CONTROL_ID.LEFTSPLITTER,resizeHeight:!1,resizeWidth:!0,resizeWidthFrom:"right",onDrag:(e,t,n)=>{ReScatter.controlWidgetLayout.resize(),this.contentResize(e)},onDragEnd:(e,t,n)=>{ReScatter.controlWidgetLayout.resize(),this.contentResize(e)}})}if(this.controlsEnabled.includes("ReScatter.CONTROL_ID.RIGHTSPLITTER")){$("#"+ReScatter.CONTROL_ID.RIGHTSPLITTER).next().resizable({handleSelector:"#"+ReScatter.CONTROL_ID.RIGHTSPLITTER,resizeHeight:!1,resizeWidth:!0,resizeWidthFrom:"left",onDrag:(e,t,n)=>{this.contentResize(e)},onDragEnd:(e,t,n)=>{this.contentResize(e)}})}}contentResize(e){ReScatter.viewController.plotRenderers.forEach(function(t){t.onResize(e)}),ReScatter.choroplethControl&&ReScatter.choroplethControl.onPlethResize(e),this.widgetController.resize()}loadLayout(e,t){this.unload(),this.startupCallback=t,this.controlEventModel.addObserver(this),this.controlEventModel.addObserver(this.progressController),this.plotRenderers=[],this.numPlotsToLoad=0,this.numChoroplethsToLoad=0,this.title=e.title,this.controlEventModel.putControlEventModel("startLoading",{info:this.title}),this.layoutDef=e,this.layoutController.setLayout(e,this.controlsEnabled),ReScatter.data.DataMapper.setDataMaps(e.dataMaps),this.selectionConfig=new ReScatter.config.SelectionConfig(e),this.dataModel.loadLayoutDefData(e,(e,t,n,i)=>{this.loadRenderers(e,t,n,i)})}loadLayoutByIndex(e,t){let n=this.layoutCollection.getLayoutConfig();e>=0&&e<n.length&&this.loadLayout(n[e],t)}loadRenderers(e,t,n,i){this.pointData=this.dataModel.dataCache.getCachedList(e),this.propData=this.dataModel.dataCache.getCachedList(t),this.renderPlotIndexes=n,this.ontologyData=this.dataModel.dataCache.getCachedList(i),this.numChoroplethsToLoad=this.layoutController.getNumberOfChoroplethsToLoad(),this.numPlotsToLoad=this.layoutController.getTotalPlots(),setTimeout(function(){$("#main-block").resize()},0),this.ontologyData.length>0&&(this.ontology=this.ontologyData[0]);for(let e=0,t=this.layoutDef.plots.length;e<t;e++)setTimeout(e=>this.createRenderer(e),10,e)}createRenderer(e){let t=this.layoutDef.plots[e];if(this.layoutController.isSpaceLayout(t))return;let n=this.renderPlotIndexes[e];if(-1===n)return;let i=this.pointData[n],r=this.propData[n],o=this.layoutController.getLayoutElementId(t),a=void 0;a=t.plugin?ReScatter.config.PluginFactory.createPlotType(t.plugin,o,t,this.layoutDef.selectionConfigs):new Ze(o,t,this.layoutDef.selectionConfigs),Pe.addComponent(a),this.plotRenderers.push(a);let s=i.points;a.loadPlotData(s,r.voxel_props,t.format),this.dataModel.putDataProps(t,r.voxel_props)}unload(){for(var e=Object.keys(this.allRenderers),t=0;t<e.length;t++){let n=e[t];this.allRenderers[n].destroy()}this.allRenderers={},this.ontologyTree&&(this.ontologyTree.destroy(),this.ontologyTree=void 0),this.renderPlotIndexes=[],this.controlEventModel.removeAllObservers(),this.ontologyTree&&(this.ontologyTree.destroy(),this.ontologyTree=void 0),this.ontology=void 0,this.startupCallback=void 0}loadOntologyData(){if(this.ontologyTree=void 0,!this.ontology)return;this.ontologyTree=new ReScatter.widget.OntologyTree;let e=this.ontology.msg[0];this.ontologyTree.loadOntologyData(ReScatter.layoutManager.getOntology(),e)}setupSelections(){let e=ReScatter.layoutManager.getPredefinedSelections();ReScatter.preselectionController.renewSelections(e),this.loadOntologyData(),ReScatter.selectionTable.clearAll(),ReScatter.selectionModel.clear(),ReScatter.selectionModel.addObserver(ReScatter.selectionDataWidget),ReScatter.dynamicSelectionModel=new ReScatter.events.DynamicSelection;let t,n,i=ReScatter.layoutManager.getPlots().concat(ReScatter.layoutManager.getChoropleths());for(t=0,n=i.length;t<n;t++){let e=i[t];void 0!==e.id&&(ReScatter.selectionModel.addObserver(this.allRenderers[e.id]),this.controlEventModel.addObserver(this.allRenderers[e.id]),ReScatter.dynamicSelectionModel.addObserver(this.allRenderers[e.id]))}this.controlEventModel.addObserver(ReScatter.plotContextMenu);let r=this.selectionConfig.getStaticSelectionsAsIdValueArray();ReScatter.selectionUploadWidget.updateOptionsFromSelections(r),ReScatter.controlWidgetLayout.collapseSelectionEdit(),this.progressController.hidePrompt(),this.ontologyTree?ReScatter.controlWidgetLayout.switchTabViewTo(this.ontologyTree.getId()):e&&ReScatter.controlWidgetLayout.switchTabViewTo(ReScatter.preselectionController.getId()),$(window).trigger("resize"),$("#title").text(this.siteTitle),this.startupCallback&&this.startupCallback()}}Ae.impl(Yt,[],{onControlEvent(e){switch(e.eventName){case"rendererLoadComplete":"plot"!==e.event.type&&"choropleth"!==e.event.type||(this.allRenderers[e.event.renderer.id]=e.event.renderer),Object.keys(this.allRenderers).length===this.numPlotsToLoad+this.numChoroplethsToLoad&&(this.progressController.loadingComplete(),this.setupSelections());break;default:return}}});let Wt=null;class Ht{constructor(e,t){return Wt||(e||alert("Set up a siteConfig before starting the SiteInstance"),ReScatter.debugOn=Boolean(t),E.registerChoroplethType("ChoroplethSVGView",ReScatter.view.ChoroplethSVGView),e.ChoroplethPlugins&&Object.entries(e.ChoroplethPlugins).forEach(e=>{E.registerChoroplethType(e[0],e[1])}),E.registerPlotType("PixijsPlotController",ReScatter.control.PixijsPlotController),e.PlotPlugins&&Object.entries(e.PlotPlugins).forEach(e=>{E.registerPlotType(e[0],e[1])}),E.registerWidgetType("LayoutTableWidget",ReScatter.widget.LayoutTableWidget),e.WidgetPlugins&&Object.entries(e.WidgetPlugins).forEach(e=>{E.registerWidgetType(e[0],e[1])}),this.controlsEnabled=ReScatter.utils.control_ids_to_strings(),this.siteConfig=e,this.__addRowHeightFuncToWebix(),ReScatter.viewController=new ReScatter.control.ViewController(this.siteConfig,this.controlsEnabled),this.startupSelection=new we,this.startupSelection.performStartupAction(),ReScatter.dimres_url&&E.registerDataJobType(w.getAlgorithmName(),ReScatter.jobs.TsnePlugin),Wt=this,this)}__addRowHeightFuncToWebix(){webix.extend(webix.ui.datatable,{myAdjustRowHeight:function(e,t,n){function i(t,n){for(var i,o=[t.config.rowHeight],a=0;a<e.length;a++)i=t.getColumnConfig(e[a]),r.style.width=i.width+"px",r.innerHTML=t.getText(n.id,i.id),o.push(r.scrollHeight);n.$height=Math.max.apply(null,o)}"string"==typeof e&&(e=[e]);var r=webix.html.create("DIV",{class:"webix_table_cell webix_measure_size webix_cell"},"");(r.style.cssText="height:1px; visibility:hidden; position:absolute; top:0px; left:0px; overflow:hidden;",this.$view.appendChild(r),n)?i(this,this.getItem(n)):this.data.each(function(e){i(this,e)},this);r=webix.html.remove(r),t||this.refresh()}})}}let Kt=new _e;var qt=n(12);let Xt=null;class Jt{constructor(){if(Xt)return Xt;this.cache={},Xt=this}__makePromise(e,t,n){this.cache.hasOwnProperty(t)||e.push(new Promise((e,i)=>{let r=new XMLHttpRequest;r.timeout=1e4,r.open("GET",t,!0),t.endsWith(".gz")?r.responseType="arraybuffer":r.responseType=n;let o=this;r.onload=function(){if(t.endsWith(".gz")){let e=new Uint8Array(this.response);o.cache[t]="json"===n?{data:JSON.parse(Object(qt.inflate)(e,{to:"string"}))}:{data:Object(qt.inflate)(e)}}else o.cache[t]={data:this.response};e()},r.onerror=function(){console.log("Error retrieving: "+t+" status: "+r.statusText+" response: "+r.responseText),i({status:r.statusText,response:r.responseText})},r.send()}))}loadFiles(e,t,n){let i=[],r=[];e.forEach(function(e){r.push(e.path),this.__makePromise(i,e.path,e.type)},this),i.length>0?Promise.all(i).then(function(){t()}).catch(function(e){n&&n(e)}):t()}asyncLoadFiles(e){var t,n,i;return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=function(e){n.push(e.path),this.__makePromise(t,e.path,e.type)},t=[],n=[],e.forEach(i,this),!(t.length>0)){r.next=8;break}return r.next=7,regeneratorRuntime.awrap(Promise.all(t));case 7:return r.abrupt("return",r.sent);case 8:return r.abrupt("return");case 9:case"end":return r.stop()}},null,this)}isInCache(e){return this.cache.hasOwnProperty(e)}getFromCache(e){return this.cache[e].data}insertInCache(e,t,n){if(!(void 0!==n&&n)&&this.isInCache(t))throw new Error("Trying to overwrite cache without explicit force");this.cache[t]={data:e}}getCachedList(e){let t=[];for(let n=0,i=e.length;n<i;n++)t.push(this.cache[e[n]].data);return t}}function Zt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class $t extends ve{constructor(){super("update"),Zt(this,"use strict",void 0),Zt(this,"use strict",void 0),this.selections={},this.orderedLabels=[],this.labelCount=0,this.visibleSelection=void 0,this.editingLabel=void 0,this.editingSelection=void 0,this.selPriorToEdit=void 0,this.putOperation=$t.editModeEnum.enum.ADDPOINTS}putSelection(e,t,n,i,r,o,a){let s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(void 0!==this.selections[e]&&(e=this.getNewLabel(e)),void 0===this.editingSelection)return i=void 0!==i?i:7807522,this.selections[e]={label:e,originator:t,dataPoints:n,color:i,description:r,selectionId:o,sourceProps:a,background:s},this.orderedLabels.push(e),this.notify({type:"perm",op:"create",sel:this.selections[e],id:o}),s||this.showSelection(e),e;o===this.editingSelection&&this.__editExisting(e,n)}unionSelections(e,t){this.combineSelections(e,t,"Union")}intersectSelections(e,t){this.combineSelections(e,t,"Intersect")}subtractSelections(e,t){this.combineSelections(e,t,"Subtract")}combineSelections(e,t,n){let i,r,o,a,s=t+":",l="";return e.forEach(function(e,t){let c=this.selections[e];if(void 0===i&&(i=c.color),void 0===r&&(r=c.selectionId),void 0===o&&(o=c.sourceProps),r===c.selectionId){if(s+=" "+e,0===t)a=new Set(c.dataPoints);else switch(n){case"Intersect":a=new Set([...a].filter(e=>c.dataPoints.includes(e)));break;case"Union":a=new Set([...a,...c.dataPoints]);break;case"Subtract":a=new Set([...a].filter(e=>!c.dataPoints.includes(e)))}l+=e+"/"}},this),l=l.slice(0,-1),this.putSelection(l,t,[...a],i,s,r,o)}__editExisting(e,t){let n=this.selections[this.editingLabel];switch(this.putOperation){case $t.editModeEnum.enum.ADDPOINTS:n.dataPoints=n.dataPoints.concat(t),n.dataPoints.sort();break;case $t.editModeEnum.enum.REMOVEPOINTS:n.dataPoints=n.dataPoints.filter(function(e){return-1===t.indexOf(e)});break;default:return}this.notify({type:"perm",op:"update",sel:n,id:n.selectionId}),this.showSelection(n.label)}setPutOperation(e){this.putOperation=e}setEditingSelection(e){this.showSelection(e);let t=this.selections[e];void 0!==t&&(this.selPriorToEdit=jQuery.extend({},t,!0),this.editingLabel=e,this.editingSelection=t.selectionId)}saveEditingSelection(){this.editingSelection=void 0,this.editingLabel=void 0,this.selPriorToEdit=void 0}cancelEditingSelection(){if(void 0!==this.editingLabel){let e=this.selPriorToEdit.label;this.selections[e]=this.selPriorToEdit,this.selPriorToEdit=void 0,this.editingLabel=void 0,this.editingSelection=void 0,this.notify({type:"perm",op:"update",sel:this.selections[e],id:this.selections[e].selectionId}),this.showSelection(e)}}addPoints(e,t){let n=this.selections[e];void 0!==n&&this.deleteSelection(e);let i=[];n.dataPoints.forEach(function(e){i[e]=1}),t.forEach(function(e){i[e]=1});let r=[];i.forEach(function(e){void 0!==e&&r.push(e)}),this.putSelection(e,n.originator,r,n.color,n.description,n.id)}removePoints(e,t){let n=this.selections[e];if(void 0===n)return;this.deleteSelection(e);let i=[];n.dataPoints.forEach(function(e){i[e]=1}),t.forEach(function(e){1===i[e]&&(i[e]=void 0)});let r=[];i.forEach(function(e){void 0!==e&&r.push(e)}),this.putSelection(e,n.originator,r,n.color,n.description,n.id)}getSelection(e){return this.selections[e]}deleteSelection(e){let t=this.orderedLabels.indexOf(e);if(t>=0){let n=this.selections[e];delete this.selections[e],this.orderedLabels.splice(t,1),this.visibleSelection===e&&(this.visibleSelection=void 0,this.notify({type:"perm",op:"hide",sel:n,id:n.selectionId})),this.notify({type:"perm",op:"delete",sel:n,id:n.selectionId})}}showSelection(e){let t;this.visibleSelection&&e!==this.visibleSelection&&(t=this.selections[this.visibleSelection],this.notify({type:"perm",op:"hide",sel:t,id:t.selectionId})),this.visibleSelection=e,t=this.selections[this.visibleSelection],this.notify({type:"perm",op:"show",sel:t,id:t.selectionId})}deleteLastSelection(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.orderedLabels.length;t>0&&(this.deleteSelection(this.orderedLabels[t-1]),e&&this.orderedLabels.length>0&&this.showSelection(this.orderedLabels[this.orderedLabels.length-1]))}hideVisibleSelection(){if(this.visibleSelection){let e=this.selections[this.visibleSelection];if(this.visibleSelection=void 0,void 0===e)return;this.notify({op:"hide",sel:e,id:e.selectionId})}}setColor(e,t){if(!this.selections.hasOwnProperty(e))return;let n=this.selections[e];n.color=t,this.notify({type:"perm",op:"color",sel:n,id:n.selectionId})}getNewLabel(e){let t=e+"_"+this.labelCount;return this.labelCount+=1,t}deleteAllSelections(){for(;Object.keys(this.selections).length>0;)this.deleteLastSelection(!1)}clear(){this.deleteAllSelections(),this.removeAllObservers()}}Zt($t,"editModeEnum",new ne({ADDPOINTS:"Add points",REMOVEPOINTS:"Remove points"}));class en extends Ie{constructor(){super(1),$("div.c select option").css("color","black"),$("li.cr.string .c").css("color","black");let e=[{id:"acronym",sort:"string",header:["Search:",{content:"textFilter",compare:function(e,t,n){return-1!==n.acronym.toLowerCase().indexOf(t.toLowerCase())||-1!==n.name.toLowerCase().indexOf(t.toLowerCase())},placeholder:"Enter name/acronym"}],template:function(e,t,n,i){let r=ReScatter.utils.style_from_hextriplet(e.color_hex_triplet),o=t.treetable(e,t);return o=(o=o.replace("class='webix_tree_close'","class='webix_tree_close' "+r)).replace("class='webix_tree_open'","class='webix_tree_open' "+r),(o+=t.treecheckbox(e,t,n,i))+"<span><b>"+e.acronym+"</b> "+e.name+"</span>"},width:350},{id:"name",hidden:!0}];this.id="atlasTableId";let t={id:this.id,view:"treetable",select:"row",css:"ontology_style",scrollX:!1,threeState:!0,columns:e,fixedRowHeight:!1,rowHeight:30,autoConfig:!0,resizeColumn:!0};this.atlasId=ReScatter.controlWidgetLayout.addTabView(t,"Ontology",!0),this.atlasTable=$$(this.atlasId),this.atlasTable.attachEvent("onItemCheck",this.atlasItemsChecked.bind(this)),webix.event(window,"resize",()=>{this.adjust()})}destroy(){this.atlasTable.clearAll(),ReScatter.controlWidgetLayout.removeTabView(this.atlasId)}loadOntologyData(e,t){this.ontologyData=t,this.selectionConfig=e,this.dynamicSelectionId=e.dynamicSelectionOut,this.atlasTable.clearAll(),(webix.DataDriver.myjson=webix.copy(webix.DataDriver.json)).child=function(e){return e.children};try{if(this.atlasTable.parse(t,"myjson"),e.hasOwnProperty("openId")){let t=this;e.openId.forEach(function(e){t.getPathToId(e).forEach(function(e){t.atlasTable.open(e)})})}}catch(e){console.log("Failed to parse or open ontology - check ontology file and configuration")}finally{this.atlasTable.render()}}getPathToId(e){let t=this.atlasTable.getFirstId(),n=[],i=e;for(n.splice(0,0,i);i!==t;)i=this.atlasTable.getParentId(i),n.splice(0,0,i);return n}adjust(){this.atlasTable.adjust()}atlasItemsChecked(e){let t=this.atlasTable.getChecked();this.outputSelection(t)}atlasItemCheck(e,t,n){this.atlasTable.getItem(e),this.atlasTable.getChecked()}outputSelection(e){ReScatter.dynamicSelectionModel.putTransitiveSelection("OntologyTable",e,7807522,this.dynamicSelectionId)}getId(){return this.id}}Ce.impl(en,[],{processSelectionEvent(e){this.processingDone()}}),n.d(t,"controlEventModel",function(){return tn}),n.d(t,"selectionModel",function(){return nn}),n.d(t,"cursors",function(){return rn}),n.d(t,"initialize",function(){return on}),n.d(t,"jobs",function(){return i}),n.d(t,"config",function(){return r}),n.d(t,"view",function(){return o}),n.d(t,"utils",function(){return a}),n.d(t,"events",function(){return s}),n.d(t,"control",function(){return c}),n.d(t,"data",function(){return u}),n.d(t,"widget",function(){return h}),n.d(t,"protocols",function(){return l}),n.d(t,"CONTROL_ID",function(){return ie});const tn=new be,nn=new $t,rn=n(169);function on(){he()}rn.keys().map(rn)}])});
//# sourceMappingURL=rescatter.js.map